{"version":3,"file":"TripExplorer-8dd411ef.js","sources":["../../src/plugins/imove-trip-explorer/TimeSlider.vue","../../src/plugins/imove-trip-explorer/SelectorPanel.vue","../../src/plugins/imove-trip-explorer/LinkLayer.tsx","../../src/plugins/imove-trip-explorer/TripExplorer.vue"],"sourcesContent":["<template lang=\"pug\">\n.time-slider-main-content\n\n  b-slider(\n    v-model=\"sliderValue\"\n    :max=\"stops.length - 1\"\n    :tooltip=\"false\"\n  )\n      b-slider-tick(v-for=\"stop,i in stops\" :key=\"i\" :value=\"i\")\n\n\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\n\nexport default defineComponent({\n  name: 'TimeSliderLinksGl',\n  props: {\n    useRange: Boolean,\n    stops: { type: Array, required: true },\n    dropdownValue: String,\n  },\n  data() {\n    return {\n      sliderValue: 0 as any,\n    }\n  },\n  watch: {\n    // dropdownValue(value) {\n    //   this.sliderValue = value\n    // },\n\n    useRange(useIt: boolean) {\n      if (useIt) {\n        this.sliderValue = [this.stops[0], this.stops[this.stops.length - 1]]\n      } else {\n        this.sliderValue = [this.stops[0]]\n      }\n      console.log('changed to: ' + this.sliderValue)\n    },\n    sliderValue(result: any) {\n      this.$emit('change', result)\n    },\n  },\n  mounted() {},\n})\n</script>\n\n<style scoped>\n.time-slider-main-content {\n  padding: 0rem 0rem 0rem 0.25rem;\n  margin: 0 0.2rem;\n}\n</style>\n","<template lang=\"pug\">\n.config-panel\n\n  //- time-of-day slider\n  .panel-item.expand(v-if=\"vizDetails.useSlider && activeColumn\")\n    p: b {{ activeColumn }}\n\n    time-slider.time-slider(\n      :useRange='false'\n      :stops=\"getColumns()\"\n      :dropdownValue=\"activeColumn\"\n      @change='handleTimeSliderChanged')\n\n\n  //- Column picker  -- if no slider\n  .panel-item(v-if=\"!vizDetails.useSlider\")\n    p: b {{ $t('selectColumn') }}\n\n    .dropdown.is-up.full-width(:class=\"{'is-active': isButtonActive}\")\n      .dropdown-trigger\n        button.full-width.is-warning.button(:class=\"{'is-loading': !activeColumn}\"\n          aria-haspopup=\"true\" aria-controls=\"dropdown-menu-column-selector\"\n          @click=\"handleClickDropdown\"\n        )\n          b {{ buttonTitle }}\n          span.icon.is-small: i.fas.fa-angle-down(aria-hidden=\"true\")\n\n      #dropdown-menu-column-selector.dropdown-menu(role=\"menu\" :style=\"{'max-height':'24rem', 'overflow-y': 'auto', 'border': '1px solid #ccc'}\")\n        .dropdown-content\n          a.dropdown-item(v-for=\"column in getColumns()\"\n            @click=\"handleSelectColumn(column)\") {{ column }}\n\n</template>\n\n<script lang=\"ts\">\nconst i18n = {\n  messages: {\n    en: {\n      selectColumn: 'Data:',\n      loading: 'Loading...',\n      bandwidths: 'Widths: 1 pixel =:',\n      timeOfDay: '',\n      colors: 'Colors',\n    },\n    de: {\n      selectColumn: 'Datenmengen:',\n      loading: 'Laden...',\n      bandwidths: 'Linienbreiten: 1 pixel =:',\n      timeOfDay: '',\n      colors: 'Farben',\n    },\n  },\n}\n\nimport { defineComponent } from 'vue'\nimport type { PropType } from 'vue'\n\nimport { debounce } from 'debounce'\n\nimport globalStore from '@/store'\nimport TimeSlider from './TimeSlider.vue'\nimport { ColorScheme, DataTable, DataType, LookupDataset } from '@/Globals'\n\nexport default defineComponent({\n  name: 'SelectorPanel',\n  i18n,\n  components: { TimeSlider },\n  props: {\n    csvData: { type: Object as PropType<LookupDataset>, required: true },\n    scaleWidth: { type: Number, required: true },\n    showDiffs: { type: Boolean, required: true },\n    vizDetails: { type: Object as PropType<{ useSlider: boolean }>, required: true },\n  },\n  data() {\n    return {\n      isButtonActive: false,\n      isColorButtonActive: false,\n      scaleWidthValue: '',\n      debounceScale: {} as any, // (vm: any) => debounce(vm.gotNewScale, 500),\n      handleTimeSliderChanged: {} as any,\n    }\n  },\n  computed: {\n    activeColumn(): string {\n      return this.csvData.activeColumn\n    },\n    buttonTitle(): string {\n      if (!this.activeColumn) return '' + this.$i18n.t('loading')\n      return this.activeColumn\n    },\n  },\n  watch: {\n    scaleWidth() {\n      this.scaleWidthValue = '' + this.scaleWidth\n    },\n    scaleWidthValue() {\n      // if (this.scaleWidth === parseFloat(this.scaleWidthValue)) return\n\n      if (isNaN(parseFloat(this.scaleWidthValue))) {\n        return\n      }\n      this.debounceScale()\n    },\n  },\n  methods: {\n    getColumns() {\n      // TODO: drop first column always: it's the link-id...\n      const columns = Object.values(this.csvData.dataTable)\n        .slice(1)\n        .filter(f => f.name && f.type !== DataType.LOOKUP)\n        .map(f => f.name)\n      return columns\n    },\n    gotNewScale() {\n      // if (this.scaleWidth !== parseFloat(this.scaleWidthValue)) {\n      //   this.scaleWidthValue = '' + this.scaleWidth\n      // }\n      this.$emit('scale', parseFloat(this.scaleWidthValue))\n    },\n\n    changeTimeSlider(value: any) {\n      if (value.length && value.length === 1) value = value[0]\n\n      this.$emit('slider', { dataset: this.csvData, column: this.getColumns()[value] })\n    },\n\n    handleClickDropdown() {\n      this.isButtonActive = !this.isButtonActive\n    },\n\n    handleColorRamp(colors: string) {\n      console.log(colors)\n      this.isColorButtonActive = false\n      this.$emit('colors', colors)\n    },\n\n    clearDropdown() {\n      console.log('boop')\n      this.isButtonActive = false\n    },\n\n    async handleSelectColumn(column: string) {\n      console.log('panel: selected', column)\n      this.isButtonActive = false\n      this.$emit('column', { dataset: this.csvData, column: column })\n    },\n  },\n  mounted() {\n    this.debounceScale = debounce(this.gotNewScale, 500)\n    this.handleTimeSliderChanged = debounce(this.changeTimeSlider, 250)\n    this.scaleWidthValue = '' + this.scaleWidth\n  },\n})\n</script>\n\n<style scoped lang=\"scss\">\n@import '@/styles.scss';\n\n.config-panel {\n  display: flex;\n  flex-direction: row;\n}\n\n.full-width {\n  display: block;\n  width: 100%;\n}\n\n.panel-item {\n  padding-right: 1rem;\n}\n\n.last-item {\n  padding-right: 0;\n}\n\np {\n  font-size: 0.9rem;\n}\n\n.color-button,\n.swap-color {\n  width: 8rem;\n  height: 32px;\n}\n\n.color-button:hover {\n  cursor: pointer;\n  box-shadow: 0px 0px 3px 3px rgba(128, 128, 128, 0.3);\n}\n\nbutton:hover {\n  box-shadow: 0px 0px 3px 3px rgba(128, 128, 128, 0.3);\n}\n\ninput {\n  border: none;\n  background-color: var(--bgCream2);\n  color: var(--bgDark);\n}\n\n.dropdown {\n  overflow: visible;\n  // width: 175px;\n}\n\n#dropdown-menu-color-selector {\n  background-color: var(--bgBold);\n\n  p {\n    color: #888;\n  }\n}\n\n.expand {\n  flex: 1;\n}\n\n.time-slider {\n  width: 100%;\n}\n\n@media only screen and (max-width: 768px) {\n  .config-panel {\n    flex-direction: column;\n  }\n}\n</style>\n","import React, { useState, useMemo, useEffect } from 'react'\nimport DeckGL from '@deck.gl/react'\nimport { COORDINATE_SYSTEM } from '@deck.gl/core'\n\nimport { OFFSET_DIRECTION } from '@/layers/LineOffsetLayer'\nimport PathOffsetLayer from '@/layers/PathOffsetLayer'\n\nimport { StaticMap } from 'react-map-gl'\nimport { format } from 'mathjs'\n\nimport {\n  MAPBOX_TOKEN,\n  REACT_VIEW_HANDLES,\n  DataTableColumn,\n  LookupDataset,\n  DataType,\n} from '@/Globals'\nimport globalStore from '@/store'\n\nexport default function Component({\n  viewId = 0,\n  links = { source: new Float32Array(), dest: new Float32Array() },\n  colorRampType = -1, // -1 undefined, 0 categorical, 1 diffs, 2 sequential\n  build = {} as LookupDataset,\n  base = {} as LookupDataset,\n  widths = {} as LookupDataset,\n  widthsBase = {} as LookupDataset,\n  newColors = new Uint8Array(),\n  newWidths = new Float32Array(),\n  dark = false,\n  projection = '',\n  scaleWidth = 1,\n  mapIsIndependent = false,\n  click = {} as any,\n  paths = [] as any,\n}) {\n  // ------- draw frame begins here -----------------------------\n\n  const widthDivisor = scaleWidth ? 1 / scaleWidth : 0\n\n  const [viewState, setViewState] = useState(globalStore.state.viewState)\n\n  const buildColumn = build.dataTable[build.activeColumn]\n  const baseColumn = base.dataTable[base.activeColumn]\n  const widthColumn = widths.dataTable[widths.activeColumn]\n\n  const isCategorical = colorRampType === 0 || buildColumn?.type == DataType.STRING\n\n  // register setViewState in global view updater so we can respond to external map motion\n  REACT_VIEW_HANDLES[viewId] = (view: any) => {\n    if (view) {\n      setViewState(view)\n    } else {\n      setViewState(globalStore.state.viewState)\n    }\n  }\n\n  function handleClick(event: any) {\n    console.log('click!', event)\n    if (event.coordinate) {\n      console.log(event.coordinate)\n      click({ coordinate: event.coordinate })\n    }\n  }\n\n  function handleViewState(view: any) {\n    setViewState(view)\n    view.center = [view.longitude, view.latitude]\n\n    if (!mapIsIndependent) globalStore.commit('setMapCamera', view)\n  }\n\n  function precise(x: number) {\n    return format(x, { lowerExp: -6, upperExp: 6, precision: 5 })\n  }\n\n  function buildTooltipHtml(\n    columnBuild: DataTableColumn,\n    columnBase: DataTableColumn,\n    geoOffset: number\n  ) {\n    try {\n      if (!columnBuild) return null\n\n      const index = build.csvRowFromLinkRow[geoOffset]\n      let value = columnBuild.values[index]\n\n      if (isCategorical) {\n        if (!Number.isFinite(value)) return null\n        return `<b>${columnBuild.name}</b><p>${precise(value)}</p>`\n      }\n\n      let html = null\n\n      if (Number.isFinite(value)) html = `<b>${columnBuild.name}</b><p>Value: ${precise(value)}</p>`\n\n      const baseIndex = base?.csvRowFromLinkRow[geoOffset]\n      if (baseIndex) {\n        let baseValue = base ? base.dataTable[columnBase.name].values[baseIndex] : null\n        let diff = value - baseValue\n        if (Number.isFinite(baseValue)) {\n          html += `<p>Base: ${precise(baseValue)}</p>`\n          html += `<p>+/- Base: ${precise(diff)}</p>`\n        }\n      }\n\n      return html\n    } catch (e) {\n      return null\n    }\n  }\n\n  function getTooltip({ object, index }: { object: any; index: number }) {\n    // tooltip will show values for color settings and for width settings.\n    // if there is base data, it will also show values and diff vs. base for both color and width.\n\n    try {\n      // tooltip color values ------------\n      let tooltip = buildTooltipHtml(buildColumn, baseColumn, index)\n\n      // tooltip widths------------\n      if (widthColumn && widthColumn.name !== buildColumn.name) {\n        const widthTip = buildTooltipHtml(\n          widthColumn,\n          widthsBase.dataTable[widthsBase.activeColumn],\n          index\n        )\n        if (widthTip) tooltip = tooltip ? tooltip + widthTip : widthTip\n      }\n\n      if (!tooltip) return null\n\n      return {\n        html: tooltip,\n        style: { color: dark ? '#ccc' : '#223', backgroundColor: dark ? '#2a3c4f' : 'white' },\n      }\n    } catch (e) {\n      console.warn(e)\n      return null\n    }\n  }\n\n  // Atlantis is pre-converted now in the RoadNetworkLoader to lng/lat\n  // projection == 'Atlantis' ? COORDINATE_SYSTEM.METER_OFFSETS : COORDINATE_SYSTEM.DEFAULT\n  const coordinateSystem = COORDINATE_SYSTEM.DEFAULT\n\n  //@ts-ignore\n  const layer = new PathOffsetLayer({\n    id: 'pathLayer',\n    data: paths,\n    getPath: (d: any) => d.path,\n    getColor: [0, 200, 128],\n    getWidth: 3,\n    widthUnits: 'pixels',\n    widthScale: 1, // widthDivisor,\n    widthMinPixels: 0.5,\n    widthMaxPixels: 50,\n    pickable: true,\n    coordinateSystem,\n    opacity: 0.35,\n    autoHighlight: true,\n    highlightColor: [255, 0, 224],\n    offsetDirection: OFFSET_DIRECTION.LEFT,\n    // updateTriggers: {\n    //   getPath: [links.source],\n    //   getTargetPosition: [links.dest],\n    //   getColor: [newColors, dark],\n    //   getWidth: [newWidths],\n    // },\n    transitions: {\n      getColor: 250,\n      getWidth: 250,\n      getPath: 0,\n      widthScale: 250,\n    },\n    parameters: {\n      depthTest: false,\n    },\n  })\n\n  const showBackgroundMap = true // projection && projection !== 'Atlantis'\n\n  return (\n    /*\n    //@ts-ignore */\n    <DeckGL\n      layers={[layer]}\n      viewState={viewState}\n      controller={true}\n      pickingRadius={5}\n      getTooltip={getTooltip}\n      getCursor={({ isDragging, isHovering }: any) =>\n        isDragging ? 'grabbing' : isHovering ? 'pointer' : 'grab'\n      }\n      onClick={handleClick}\n      onViewStateChange={(e: any) => handleViewState(e.viewState)}\n    >\n      {showBackgroundMap && (\n        /*\n        // @ts-ignore */\n        <StaticMap mapStyle={globalStore.getters.mapStyle} mapboxApiAccessToken={MAPBOX_TOKEN} />\n      )}\n    </DeckGL>\n  )\n}\n","<template lang=\"pug\">\n.link-volume-plot(:class=\"{'hide-thumbnail': !thumbnail}\"\n        :style='{\"background\": urlThumbnail}'\n        oncontextmenu=\"return false\")\n\n  .details-panel\n    h3.center RELIABILITY EXPLORER\n    p.center\n      br\n      | {{ numTrips ? '&nbsp;' : 'Select an intersection.' }}\n\n    .statistics\n      h3 Trips\n      h4(v-if=\"numTrips\") {{numTrips}} trip{{ numTrips == 1 ? '' : 's'}} found\n      h4(v-else) &nbsp;\n\n      br\n      p Day of Week\n      b-button.is-small(@click=\"toggleDay(0)\" :type=\"dayOfWeek[0]\") Mo\n      b-button.is-small(@click=\"toggleDay(1)\" :type=\"dayOfWeek[1]\") Tu\n      b-button.is-small(@click=\"toggleDay(2)\" :type=\"dayOfWeek[2]\") We\n      b-button.is-small(@click=\"toggleDay(3)\" :type=\"dayOfWeek[3]\") Th\n      b-button.is-small(@click=\"toggleDay(4)\" :type=\"dayOfWeek[4]\") Fr\n      b-button.is-small(@click=\"toggleDay(5)\" :type=\"dayOfWeek[5]\") Sa\n      b-button.is-small(@click=\"toggleDay(6)\" :type=\"dayOfWeek[6]\") Su\n      br\n      br\n      p Vehicle Types\n      b-button.is-small(@click=\"toggleVehicle(0)\" :type=\"vehType[0]\") All\n      b-button.is-small(@click=\"toggleVehicle(1)\" :type=\"vehType[1]\") Cars\n      b-button.is-small(@click=\"toggleVehicle(2)\" :type=\"vehType[2]\") HCV\n\n      br\n      br\n\n    .reliability\n      h3 Reliability\n      p Speed by time of day\n      br\n      p: b Average speed: {{ Math.round(10* avgSpeed) / 10 }}\n\n      vue-plotly.myplot(v-if=\"speedData.length\"\n        :data=\"speedData\"\n        :layout=\"layout\"\n        :options=\"options\"\n        id=\"speed-plot\"\n      )\n\n  .plot-container(:id=\"`container-${linkLayerId}`\")\n    link-layer.map-area(\n        :viewId=\"linkLayerId\"\n        :links=\"geojsonData\"\n        :colorRampType=\"colorRampType\"\n        :build=\"csvData\"\n        :base=\"csvBase\"\n        :widths=\"csvWidth\"\n        :widthsBase=\"csvWidthBase\"\n        :dark=\"isDarkMode\"\n        :newColors=\"colorArray\"\n        :newWidths=\"widthArray\"\n        :scaleWidth=\"scaleWidth\"\n        :projection=\"vizDetails.projection\"\n        :mapIsIndependent=\"vizDetails.mapIsIndependent\"\n        :click=\"handleClick\"\n        :paths=\"selectedPaths\"\n    )\n\n    zoom-buttons.zoom-buttons(v-if=\"!thumbnail\")\n    //- drawing-tool(v-if=\"!thumbnail\")\n\n    .bottom-panel(v-if=\"!thumbnail\")\n      .status-message(v-if=\"myState.statusMessage\")\n        p {{ myState.statusMessage }}\n\n      .panel-items(v-show=\"csvWidth.activeColumn\")\n\n        //- slider/dropdown for selecting column\n        .panel-item.config-section\n          selector-panel(\n            :vizDetails=\"vizDetails\"\n            :csvData=\"csvWidth\"\n            :scaleWidth=\"scaleWidth\"\n            :showDiffs=\"vizDetails.showDifferences\"\n            @column=\"handleNewDataColumn\"\n            @slider=\"handleNewDataColumn\"\n          )\n\n        //- DIFF checkbox\n        .panel-item.diff-section(v-if=\"vizDetails.datasets.csvBase\")\n          toggle-button.toggle(:width=\"40\" :value=\"vizDetails.showDifferences\" :sync=\"true\" :labels=\"false\"\n            :color=\"{checked: '#4b7cc4', unchecked: '#222'}\"\n            @change=\"toggleShowDiffs\")\n          p: b {{ $t('showDiffs') }}\n\n        //- FilterPanel.filter-panel(v-if=\"vizDetails.useSlider\"\n        //-   :props=\"csvWidth\"\n        //-   @activeColumns=\"handleNewFilter\"\n        //- )\n\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport type { PropType } from 'vue'\nimport { ToggleButton } from 'vue-js-toggle-button'\nimport { rgb } from 'd3-color'\nimport { scaleThreshold, scaleOrdinal } from 'd3-scale'\nimport { shallowEqualObjects } from 'shallow-equal'\nimport readBlob from 'read-blob'\nimport YAML from 'yaml'\n\nimport globalStore from '@/store'\nimport {\n  MAP_STYLES_OFFLINE,\n  DataTableColumn,\n  DataTable,\n  DataType,\n  LookupDataset,\n  UI_FONT,\n  BG_COLOR_DASHBOARD,\n} from '@/Globals'\n// import FilterPanel from './BadFilterPanel.vue'\nimport SelectorPanel from './SelectorPanel.vue'\nimport LinkLayer from './LinkLayer'\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\nimport DrawingTool from '@/components/DrawingTool/DrawingTool.vue'\nimport VizConfigurator from '@/components/viz-configurator/VizConfigurator.vue'\nimport VuePlotly from '@/components/VuePlotly.vue'\nimport ZoomButtons from '@/components/ZoomButtons.vue'\nimport LegendStore from '@/js/LegendStore'\nimport Coords from '@/js/Coords'\nimport { arrayBufferToBase64 } from '@/js/util'\n\nimport {\n  ColorScheme,\n  FileSystem,\n  FileSystemConfig,\n  VisualizationPlugin,\n  Status,\n  REACT_VIEW_HANDLES,\n} from '@/Globals'\n\nimport { LineColorDefinition } from '@/components/viz-configurator/LineColors.vue'\nimport { LineWidthDefinition } from '@/components/viz-configurator/LineWidths.vue'\nimport { DatasetDefinition } from '@/components/viz-configurator/AddDatasets.vue'\nimport DashboardDataManager from '@/js/DashboardDataManager'\n\nconst LOOKUP_COLUMN = '_LINK_OFFSET_'\n\nconst MyComponent = defineComponent({\n  name: 'NetworkLinksPlugin',\n  components: {\n    SelectorPanel,\n    DrawingTool,\n    LinkLayer,\n    ToggleButton,\n    VizConfigurator,\n    VuePlotly,\n    ZoomButtons,\n  },\n  props: {\n    root: { type: String, required: true },\n    subfolder: { type: String, required: true },\n    yamlConfig: String,\n    config: Object as any,\n    thumbnail: Boolean,\n    datamanager: { type: Object as PropType<DashboardDataManager> },\n  },\n  data() {\n    return {\n      selectedPaths: [] as any[],\n      numTrips: 0,\n      avgSpeed: 0,\n      dayOfWeek: ['is-warning', 'is-warning', 'is-warning', 'is-warning', 'is-warning', '', ''],\n      vehType: ['is-success', '', ''],\n      currentCoord: [] as number[],\n      radius: 0.0002,\n      speedData: [] as any[],\n      globalState: globalStore.state,\n      layout: {\n        paper_bgcolor: BG_COLOR_DASHBOARD.dark,\n        plot_bgcolor: BG_COLOR_DASHBOARD.dark,\n        font: { family: UI_FONT, color: '#cccccc' },\n        height: 300,\n        margin: { t: 8, b: 0, l: 0, r: 0, pad: 2 },\n        xaxis: {\n          automargin: true,\n          autorange: true,\n          title: { text: 'Hour', standoff: 12 },\n          animate: true,\n        },\n        yaxis: {\n          automargin: true,\n          autorange: true,\n          title: { text: 'Speed', standoff: 16 },\n          animate: true,\n        },\n        legend: false,\n        // {\n        //   orientation: 'h',\n        //   x: 1,\n        //   y: 1,\n        // },\n      },\n      options: {\n        displaylogo: false,\n        responsive: true,\n        modeBarButtonsToRemove: [\n          'pan2d',\n          'zoom2d',\n          'select2d',\n          'lasso2d',\n          'zoomIn2d',\n          'zoomOut2d',\n          'autoScale2d',\n          'hoverClosestCartesian',\n          'hoverCompareCartesian',\n          'resetScale2d',\n          'toggleSpikelines',\n          'resetViewMapbox',\n        ],\n        toImageButtonOptions: {\n          format: 'png', // one of png, svg, jpeg, webp\n          filename: 'scatter-plot',\n          width: null,\n          height: null,\n        },\n      },\n\n      standaloneYAMLconfig: {\n        title: '',\n        description: '',\n        csvFile: '',\n        csvBase: '',\n        datasets: {} as { [id: string]: string },\n        useSlider: false,\n        showDifferences: false,\n        shpFile: '',\n        dbfFile: '',\n        network: '',\n        geojsonFile: '',\n        projection: '',\n        center: null as any,\n        zoom: 0,\n        widthFactor: null as any,\n        thumbnail: '',\n        sum: false,\n        nodes: '', // SFCTA nodes shapefile\n        links: [] as string[], // SFCTA links DBF files\n        mapIsIndependent: false,\n        display: {\n          color: {} as any,\n          width: {} as any,\n        },\n      },\n\n      YAMLrequirementsLinks: {\n        // csvFile: '',\n        // network: '',\n        // projection: '',\n      },\n\n      // this contains the display settings for this view; it is the View Model.\n      // use changeConfiguration to modify this for now (todo: move to state model)\n      vizDetails: {\n        title: '',\n        description: '',\n        csvFile: '',\n        csvBase: '',\n        datasets: {} as { [id: string]: string },\n        useSlider: false,\n        showDifferences: false,\n        server: '',\n        shpFile: '',\n        dbfFile: '',\n        network: '',\n        geojsonFile: '',\n        projection: '',\n        center: null as any,\n        zoom: 0,\n        widthFactor: null as any,\n        thumbnail: '',\n        sum: false,\n        nodes: '', // SFCTA nodes shapefile\n        links: [] as string[], // SFCTA links DBF files\n        mapIsIndependent: false,\n        display: {\n          color: {} as any,\n          width: {} as any,\n        },\n      },\n\n      currentUIFilterDefinitions: {} as any,\n      datasets: {} as { [id: string]: DataTable },\n      isButtonActiveColumn: false,\n      linkLayerId: `linklayer-${Math.floor(1e12 * Math.random())}` as any,\n      scaleWidth: 0,\n      numLinks: 0,\n      showTimeRange: false,\n      legendStore: new LegendStore(),\n      geojsonData: {\n        source: new Float32Array(),\n        dest: new Float32Array(),\n        linkIds: [] as any[],\n        projection: '',\n      },\n      fixedColors: ['#4e79a7'],\n      myState: {\n        statusMessage: '',\n        subfolder: '',\n        yamlConfig: '',\n        thumbnail: false,\n      },\n\n      csvData: {\n        datasetKey: '',\n        activeColumn: '',\n        dataTable: {},\n        csvRowFromLinkRow: [],\n      } as LookupDataset,\n\n      csvBase: {\n        datasetKey: '',\n        activeColumn: '',\n        dataTable: {},\n        csvRowFromLinkRow: [],\n      } as LookupDataset,\n\n      csvWidth: {\n        datasetKey: '',\n        activeColumn: '',\n        dataTable: {},\n        csvRowFromLinkRow: [],\n      } as LookupDataset,\n\n      csvWidthBase: {\n        datasetKey: '',\n        activeColumn: '',\n        dataTable: {},\n        csvRowFromLinkRow: [],\n      } as LookupDataset,\n\n      // private linkOffsetLookup: { [id: string]: number } = {}\n      isDarkMode: this.$store.state.colorScheme === ColorScheme.DarkMode,\n      isDataLoaded: false,\n      thumbnailUrl: \"url('assets/thumbnail.jpg') no-repeat;\",\n\n      currentWidthDefinition: { columnName: '' } as LineWidthDefinition,\n\n      // DataManager might be passed in from the dashboard; or we might be\n      // in single-view mode, in which case we need to create one for ourselves\n      myDataManager: this.datamanager || new DashboardDataManager(this.root, this.subfolder),\n\n      resizer: undefined as ResizeObserver | undefined,\n      dataLoaderWorkers: [] as Worker[],\n      csvRowLookupFromLinkRow: {} as { [datasetId: string]: number[] },\n\n      colorArray: new Uint8Array(),\n      widthArray: new Float32Array(),\n    }\n  },\n  computed: {\n    fileApi(): HTTPFileSystem {\n      return new HTTPFileSystem(this.fileSystem, globalStore)\n    },\n\n    fileSystem(): FileSystemConfig {\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\n        (a: FileSystemConfig) => a.slug === this.root\n      )\n      if (svnProject.length === 0) {\n        console.log('no such project')\n        throw Error\n      }\n      return svnProject[0]\n    },\n\n    urlThumbnail(): string {\n      return this.thumbnailUrl\n    },\n\n    colorRampType(): any {\n      const rampType = this.vizDetails.display.color?.colorRamp?.style\n      if (rampType === undefined) return -1\n      return rampType\n    },\n\n    buttonTitle(): string {\n      return this.csvData.activeColumn || 'Loading...'\n    },\n  },\n  watch: {\n    '$store.state.viewState'() {\n      if (this.vizDetails.mapIsIndependent) return\n\n      if (!REACT_VIEW_HANDLES[this.linkLayerId]) return\n      REACT_VIEW_HANDLES[this.linkLayerId]()\n    },\n\n    '$store.state.colorScheme'() {\n      setTimeout(\n        () => (this.isDarkMode = this.$store.state.colorScheme === ColorScheme.DarkMode),\n        100\n      )\n    },\n\n    'vizDetails.showDifferences'() {\n      this.generateWidthArray()\n      this.generateColorArray()\n    },\n  },\n  methods: {\n    toggleDay(i: number) {\n      this.dayOfWeek[i] = this.dayOfWeek[i] ? '' : 'is-warning'\n      this.dayOfWeek = [...this.dayOfWeek]\n    },\n\n    toggleVehicle(i: number) {\n      // radio buttons - only one selection\n      this.vehType = ['', '', '']\n      this.vehType[i] = 'is-success'\n    },\n\n    setDataIsLoaded() {\n      this.isDataLoaded = true\n    },\n\n    async getVizDetails() {\n      const filename = this.myState.yamlConfig\n\n      const emptyState = {\n        showDifferences: false,\n        datasets: {} as any,\n        display: { color: {} as any, width: {} as any },\n      }\n\n      // are we in a dashboard?\n      if (this.config) {\n        this.vizDetails = Object.assign({}, emptyState, this.config)\n        return\n      }\n\n      // was a YAML file was passed in?\n      if (filename?.endsWith('yaml') || filename?.endsWith('yml')) {\n        await this.loadStandaloneYamlConfig()\n      }\n\n      const t = this.vizDetails.title ? this.vizDetails.title : filename || 'Trip Explorer'\n      this.$emit('title', t)\n    },\n\n    async loadStandaloneYamlConfig() {\n      try {\n        const filename =\n          this.myState.yamlConfig.indexOf('/') > -1\n            ? this.myState.yamlConfig\n            : this.myState.subfolder + '/' + this.myState.yamlConfig\n\n        const text = await this.fileApi.getFileText(filename)\n        this.standaloneYAMLconfig = Object.assign({}, YAML.parse(text))\n        this.setVizDetails()\n      } catch (err) {\n        console.error('failed', '' + err)\n      }\n    },\n\n    async validateYAML() {\n      const hasYaml = new RegExp('.*(yml|yaml)$').test(this.myState.yamlConfig)\n\n      let configuration: any\n\n      if (hasYaml) {\n        console.log('has yaml')\n        configuration = this.standaloneYAMLconfig\n      } else {\n        console.log('no yaml')\n        configuration = this.config\n      }\n\n      for (const key in this.YAMLrequirementsLinks) {\n        if (key in configuration === false) {\n          this.$emit('error', {\n            type: Status.ERROR,\n            msg: `YAML file missing required key: ${key}`,\n            desc: 'Check this.YAMLrequirementsLinks for required keys',\n          })\n        }\n      }\n\n      if (configuration.zoom < 5 || configuration.zoom > 20) {\n        this.$emit('error', {\n          type: Status.WARNING,\n          msg: `Zoom is out of the recommended range `,\n          desc: 'Zoom levels should be between 5 and 20. ',\n        })\n      }\n\n      const hasGeoJson = !configuration.network && configuration.geojsonFile\n      if (hasGeoJson) {\n        this.$emit('error', {\n          type: Status.WARNING,\n          msg: `YAML field geojsonFile deprecated`,\n          desc: 'Use YAML field network instad. ',\n        })\n      }\n\n      if (!configuration.display) {\n        this.$emit('error', {\n          type: Status.WARNING,\n          msg: `Display properties not set`,\n          desc: 'Standard values are used',\n        })\n      }\n    },\n\n    setVizDetails() {\n      this.vizDetails = Object.assign({}, this.vizDetails, this.standaloneYAMLconfig)\n    },\n\n    async buildThumbnail() {\n      if (this.thumbnail && this.vizDetails.thumbnail) {\n        try {\n          const blob = await this.fileApi.getFileBlob(\n            this.myState.subfolder + '/' + this.vizDetails.thumbnail\n          )\n          const buffer = await readBlob.arraybuffer(blob)\n          const base64 = arrayBufferToBase64(buffer)\n          if (base64)\n            this.thumbnailUrl = `center / cover no-repeat url(data:image/png;base64,${base64})`\n        } catch (e) {\n          console.error(e)\n        }\n      }\n    },\n\n    toggleShowDiffs() {\n      this.vizDetails.showDifferences = !this.vizDetails.showDifferences\n    },\n\n    /**\n     * changeConfiguration: is the main entry point for changing the viz model.\n     * anything that wants to change colors, widths, data, anthing like that\n     * should all pass through this function so the underlying data model\n     * is modified properly.\n     */\n    changeConfiguration(props: {\n      color?: LineColorDefinition\n      width?: LineWidthDefinition\n      dataset?: DatasetDefinition\n    }) {\n      // console.log(props)\n\n      if (props['color']) {\n        // if (JSON.stringify(props.color) === JSON.stringify(this.vizDetails.display.color)) return\n        this.vizDetails = Object.assign({}, this.vizDetails)\n        this.vizDetails.display.color = props.color\n        this.handleNewColor(props.color)\n      }\n      if (props['width']) {\n        // if (JSON.stringify(props.width) === JSON.stringify(this.vizDetails.display.width)) return\n        this.vizDetails = Object.assign({}, this.vizDetails)\n        this.vizDetails.display.width = props.width\n        this.handleNewWidth(props.width)\n      }\n      if (props['dataset']) {\n        // vizdetails just had the string name, whereas props.dataset contains\n        // a fully-build DatasetDefinition, so let's just handle that\n        this.handleNewDataset(props.dataset)\n      }\n    },\n\n    async handleClick(event: any) {\n      console.log('GOT YOU:', event)\n      if (event.coordinate) {\n        await this.clickedCoordinate(event.coordinate)\n        await this.runStatisticsForCoord(event.coordinate)\n      }\n    },\n\n    async runStatisticsForCoord(coord: number[]) {\n      this.currentCoord = coord\n      console.log('number of PATHS:', this.selectedPaths)\n      const lonLo = coord[0] - this.radius\n      const lonHi = coord[0] + this.radius\n      const latLo = coord[1] - this.radius\n      const latHi = coord[1] + this.radius\n\n      const data = { time: [], speeds: [] } as any\n\n      for (const selectedPath of this.selectedPaths) {\n        const path = selectedPath.path\n        console.log('  number of POINTS:', path.length)\n\n        let lastSelectedPointIndex = 0\n        for (let i = 0; i < path.length; i++) {\n          const p = path[i]\n          if (p[0] >= lonLo && p[0] <= lonHi && p[1] >= latLo && p[1] <= latHi) {\n            lastSelectedPointIndex = i\n          }\n        }\n        console.log('  i:', lastSelectedPointIndex)\n\n        // might be at end of array, don't panic\n        try {\n          const speed = selectedPath.speeds[lastSelectedPointIndex]\n          const startTime = parseInt(selectedPath.startTime.substring(0, 2))\n          if (speed == 0) continue\n\n          data.time.push(startTime)\n          data.speeds.push(speed)\n        } catch (e) {\n          console.warn('bad index')\n          // ignore for now\n        }\n\n        // calc average\n        const sum = data.speeds.reduce((a: number, b: number) => a + b)\n        const avgSpeed = sum / data.speeds.length\n        this.avgSpeed = avgSpeed\n      }\n      console.log(data)\n\n      this.speedData = [\n        {\n          x: data.time,\n          y: data.speeds,\n          name: 'Speed by Hour',\n          mode: 'markers',\n          type: 'scatter',\n          textinfo: 'label+percent',\n          textposition: 'inside',\n          automargin: true,\n          showlegend: false,\n          marker: { size: 3, color: '#ff4' },\n        },\n      ]\n    },\n\n    async clickedCoordinate(coord: number[]) {\n      const [lon, lat] = coord\n      console.log({ lon, lat })\n\n      const server = this.vizDetails.server\n\n      // GET TRIP LIST\n      const url = `${server}/location?lon=${lon}&lat=${lat}&radius=0.0002`\n      console.log(url)\n      const trips = await fetch(url, { headers: { 'Access-Control-Allow-Origin': '*' } }).then(\n        response => response.json()\n      )\n      // console.log({ trips })\n\n      if (!trips.length) {\n        this.selectedPaths = []\n        this.numTrips = 0\n        return\n      }\n\n      // BUILD PATHS\n      const selectedPaths = [] as any[]\n\n      // GET FULL PATHS FOR SELECTED TRIPS\n      this.numTrips = trips.length\n\n      // only fetch 800 at a time due to URL length limits\n      const chunk = 807\n\n      let i = 0\n      while (i < this.numTrips) {\n        console.log('loading', i)\n        const tripIDs = trips\n          .slice(i, i + chunk)\n          .map((trip: any) => trip.TripID)\n          .join(',')\n        const pathUrl = `${server}/path?trip=${tripIDs}`\n        console.log('path length:', pathUrl.length)\n        const paths = await fetch(pathUrl).then(response => response.json())\n\n        for (const trip of paths) {\n          const snappedPath = trip.Path1\n          const coords = snappedPath\n            .split(',')\n            .map((point: string) => point.split(' ').map(p => parseFloat(p)))\n\n          const speeds = trip.Speed_path.split(',').map((speed: any) => parseFloat(speed))\n\n          selectedPaths.push({ path: coords, speeds, startTime: trip.start_time })\n        }\n        this.selectedPaths = [...selectedPaths]\n        await this.$nextTick()\n        i += chunk\n      }\n    },\n\n    handleNewFilter(columns: number[]) {\n      this.csvData = Object.assign({}, this.csvData, { activeColumn: columns[0] })\n      this.csvWidth = Object.assign({}, this.csvWidth, { activeColumn: columns[0] })\n\n      // // this.timeFilterColumns = columns\n      // // give animation 150ms to run\n      // setTimeout(() => {\n      //   if (columns.length) {\n      //     this.csvData = Object.assign({}, this.csvData, { activeColumn: columns[0] })\n      //     this.csvWidth = Object.assign({}, this.csvWidth, { activeColumn: columns[0] })\n      //   }\n      // }, 150)\n    },\n\n    handleNewWidth(width: LineWidthDefinition) {\n      // if definition hasn't changed, do nothing\n      if (shallowEqualObjects(width, this.currentWidthDefinition)) {\n        return\n      }\n\n      const { columnName, dataset, scaleFactor } = width\n\n      // if dataset is set to None, just set scale to 0 and we're done\n      if (!dataset) {\n        this.scaleWidth = 0\n        return\n      }\n\n      // change scaling factor without recalculating anything:\n      if (scaleFactor !== undefined) this.scaleWidth = scaleFactor\n\n      // if everything else is the same, don't recalculate anything\n      let recalculate = true\n\n      if (!columnName) recalculate = false\n\n      if (\n        width.columnName === this.currentWidthDefinition.columnName &&\n        width.dataset === this.currentWidthDefinition.dataset\n      ) {\n        recalculate = false\n      }\n\n      // save settings\n      this.currentWidthDefinition = width\n\n      // this part takes longer to calculate. only do it if we have to\n      if (!recalculate) return\n\n      const selectedDataset = dataset ? this.datasets[dataset] : this.csvWidth.dataTable\n      if (!selectedDataset) return\n\n      if (this.csvWidth.dataTable !== selectedDataset) {\n        this.csvWidth.dataTable = selectedDataset\n        this.csvWidth.activeColumn = columnName || ''\n        // this.csvWidthBase.dataTable = selectedDataset\n        this.csvWidthBase.activeColumn = columnName || ''\n      }\n\n      const dataColumn = selectedDataset[columnName || '']\n      if (!dataColumn) {\n        const msg = `Width: column \"${columnName}\" not found in dataset \"${this.csvData.datasetKey}\"`\n        console.error(msg)\n        this.$emit('error', {\n          type: Status.ERROR,\n          msg,\n        })\n        return\n      }\n\n      // Tell Vue we have new data\n      this.csvWidth = {\n        datasetKey: dataset || this.csvWidth.datasetKey,\n        dataTable: selectedDataset,\n        activeColumn: columnName || '',\n        csvRowFromLinkRow: dataset ? this.csvRowLookupFromLinkRow[dataset] : [],\n      }\n      this.generateWidthArray()\n    },\n\n    handleNewColor(color: LineColorDefinition) {\n      this.fixedColors = color.fixedColors\n\n      const columnName = color.columnName\n      if (!columnName) {\n        this.generateColorArray()\n        return\n      }\n\n      const datasetKey = color.dataset\n      const selectedDataset = this.datasets[datasetKey]\n      if (!selectedDataset) return\n\n      if (this.csvData.dataTable !== selectedDataset) {\n        this.csvData = {\n          datasetKey,\n          dataTable: selectedDataset,\n          activeColumn: '',\n          csvRowFromLinkRow: this.csvRowLookupFromLinkRow[datasetKey],\n        }\n      }\n\n      const column = this.csvData.dataTable[columnName]\n      if (!column) {\n        const msg = `Color: Column \"${columnName}\" not found in dataset \"${this.csvData.datasetKey}\"`\n        console.error(msg)\n        this.$emit('error', {\n          type: Status.ERROR,\n          msg,\n        })\n        return\n      }\n\n      this.csvData.activeColumn = column.name\n      this.csvBase.activeColumn = column.name\n\n      this.isButtonActiveColumn = false\n      this.generateColorArray()\n    },\n\n    setMapCenterFromVizDetails() {\n      if (typeof this.vizDetails.center == 'string') {\n        this.vizDetails.center = this.vizDetails.center.split(',').map(Number)\n      }\n\n      if (!this.vizDetails.zoom) {\n        this.vizDetails.zoom = 9\n      }\n\n      this.$store.commit('setMapCamera', {\n        longitude: this.vizDetails.center[0],\n        latitude: this.vizDetails.center[1],\n        bearing: 0,\n        pitch: 0,\n        zoom: this.vizDetails.zoom,\n        jump: false,\n      })\n\n      const view = {\n        longitude: this.vizDetails.center[0],\n        latitude: this.vizDetails.center[1],\n        bearing: 0,\n        pitch: 0,\n        zoom: this.vizDetails.zoom || 10, // use 10 default if we don't have a zoom\n        jump: false, // move the map no matter what\n      }\n\n      // bounce our map\n      if (REACT_VIEW_HANDLES[this.linkLayerId]) {\n        REACT_VIEW_HANDLES[this.linkLayerId](view)\n      }\n    },\n\n    async setMapCenter() {\n      if (this.vizDetails.center) return this.setMapCenterFromVizDetails()\n\n      const data = this.geojsonData\n\n      if (!data.source.length) return\n\n      let samples = 0\n      let longitude = 0\n      let latitude = 0\n\n      // figure out the center\n      if (this.geojsonData.projection !== 'Atlantis') {\n        const numLinks = data.source.length / 2\n        const gap = numLinks < 4096 ? 2 : 1024\n        for (let i = 0; i < numLinks; i += gap) {\n          longitude += data.source[i * 2]\n          latitude += data.source[i * 2 + 1]\n          samples++\n        }\n        longitude = longitude / samples\n        latitude = latitude / samples\n      }\n      console.log('center', longitude, latitude)\n\n      this.$store.commit('setMapCamera', {\n        longitude,\n        latitude,\n        bearing: 0,\n        pitch: 0,\n        zoom: 8,\n        jump: false,\n      })\n    },\n\n    setupLogoMover() {\n      this.resizer = new ResizeObserver(this.moveLogo)\n      const deckmap = document.getElementById(`container-${this.linkLayerId}`) as HTMLElement\n      this.resizer.observe(deckmap)\n    },\n\n    moveLogo() {\n      const deckmap = document.getElementById(`container-${this.linkLayerId}`) as HTMLElement\n      const logo = deckmap?.querySelector('.mapboxgl-ctrl-bottom-left') as HTMLElement\n      if (logo) {\n        const right = deckmap.clientWidth > 640 ? '280px' : '36px'\n        logo.style.right = right\n      }\n    },\n\n    async updateStatus(message: string) {\n      this.myState.statusMessage = message\n    },\n\n    async loadNetwork(): Promise<any> {\n      if (!this.myDataManager) throw Error('links: no datamanager')\n\n      this.myState.statusMessage = 'Loading network...'\n\n      const filename = this.vizDetails.network || this.vizDetails.geojsonFile\n      try {\n        const network = await this.myDataManager.getRoadNetwork(\n          filename,\n          this.myState.subfolder,\n          this.vizDetails,\n          this.updateStatus\n        )\n\n        this.numLinks = network.linkIds.length\n        this.geojsonData = network as any\n\n        // Handle Atlantis: no long/lat coordinates\n        if (network.projection) {\n          this.vizDetails.projection = '' + network.projection\n          // this.$store.commit('setMapStyles', MAP_STYLES_OFFLINE)\n        }\n\n        this.setMapCenter() // this could be off main thread\n\n        this.myState.statusMessage = ''\n\n        this.moveLogo()\n\n        this.$emit('isLoaded', true)\n\n        // then load CSVs in background\n        this.loadCSVFiles()\n      } catch (e) {\n        this.myState.statusMessage = '' + e\n        const title = this.vizDetails.title || 'Network map'\n        this.$emit('error', `${title}: ` + e)\n        this.$emit('isLoaded')\n      }\n    },\n\n    handleNewDataset(props: DatasetDefinition) {\n      console.log('NEW dataset', props)\n      const { key, dataTable, filename } = props\n\n      // We need a lookup so we can find the CSV row that matches each link row.\n      // A normal hashmap lookup is too slow, so we'll create an array containing\n      // the lookup on load (now); then it should be O(1) fast from that point forward.\n\n      // For now we assume the 1st CSV column always has the link ID\n      const columnNames = Object.keys(dataTable)\n      const assumedLinkIdIsFirstColumn = columnNames[0]\n      const linkIdColumn = dataTable[assumedLinkIdIsFirstColumn]\n\n      let tempMapLinkIdToCsvRow = {} as any\n      for (let csvRow = 0; csvRow < linkIdColumn.values.length; csvRow++) {\n        tempMapLinkIdToCsvRow[linkIdColumn.values[csvRow]] = csvRow\n      }\n\n      // Create a LOOKUP array which links this CSV data to the network links\n      // loop through all network links, we need the CSV row for each link.\n      const getCsvRowNumberFromLinkRowNumber: number[] = []\n      for (let linkRow = 0; linkRow < this.geojsonData.linkIds.length; linkRow++) {\n        const linkId = this.geojsonData.linkIds[linkRow]\n        const csvRow = tempMapLinkIdToCsvRow[linkId]\n        if (csvRow !== undefined) getCsvRowNumberFromLinkRowNumber[linkRow] = csvRow\n      }\n\n      // Save the lookup with the dataset.\n      this.csvRowLookupFromLinkRow[key] = getCsvRowNumberFromLinkRowNumber\n      tempMapLinkIdToCsvRow = {} // probably unnecessary but we def want this to be GC'ed\n\n      // all done!\n      if (filename) this.vizDetails.datasets[key] = filename\n      this.datasets = Object.assign({ ...this.datasets }, { [key]: dataTable })\n      this.handleDatasetisLoaded(key)\n    },\n\n    generateWidthArray() {\n      const numLinks = this.geojsonData.linkIds.length\n      const widths = new Float32Array(numLinks)\n\n      const widthValues = this.csvWidth?.dataTable[this.csvWidth.activeColumn]?.values\n      const baseValues = this.csvBase?.dataTable[this.csvBase.activeColumn]?.values\n\n      const width = (i: number) => {\n        const csvRow = this.csvWidth.csvRowFromLinkRow[i]\n        const value = widthValues[csvRow]\n\n        if (this.vizDetails.showDifferences) {\n          const baseRow = this.csvBase.csvRowFromLinkRow[i]\n          const baseValue = baseValues[baseRow]\n          const diff = Math.abs(value - baseValue)\n          return diff\n        } else {\n          return value\n        }\n      }\n\n      for (let i = 0; i < numLinks; i++) {\n        widths[i] = width(i)\n      }\n      this.widthArray = widths\n    },\n\n    generateColorArray() {\n      // deck.gl colors must be in rgb[] or rgba[] format\n      const colorsAsRGB: any = this.fixedColors.map(hexcolor => {\n        const c = rgb(hexcolor)\n        return [c.r, c.g, c.b, 255]\n      })\n\n      // Build breakpoints between 0.0 - 1.0 to match the number of color swatches\n      // e.g. If there are five colors, then we need 4 breakpoints: 0.2, 0.4, 0.6, 0.8.\n      // An exponent reduces visual dominance of very large values at the high end of the scale\n      const exponent = 4.0\n      const domain = new Array(this.fixedColors.length - 1)\n        .fill(0)\n        .map((v, i) => Math.pow((1 / this.fixedColors.length) * (i + 1), exponent))\n\n      // *scaleOrdinal* is the d3 function that maps categorical variables to colors.\n      // *scaleThreshold* is the d3 function that maps numerical values from [0.0,1.0) to the color buckets\n      // *range* is the list of colors;\n      // *domain* is the list of breakpoints in the 0-1.0 continuum; it is auto-created from data for categorical.\n      // *colorRampType* is 0 if a categorical color ramp is chosen\n      const buildData = this.csvData.dataTable\n      const baseData = this.csvBase.dataTable\n      const activeColumn = this.csvData.activeColumn\n\n      const buildColumn: DataTableColumn = buildData[activeColumn] || { values: [] }\n      const baseColumn: DataTableColumn = baseData[activeColumn] || { values: [] }\n\n      const isCategorical = this.colorRampType === 0 || buildColumn.type == DataType.STRING\n      const setColorBasedOnValue: any = isCategorical\n        ? scaleOrdinal().range(colorsAsRGB)\n        : scaleThreshold().range(colorsAsRGB).domain(domain)\n\n      const numLinks = this.geojsonData.linkIds.length\n      const colors = new Uint8Array(4 * numLinks)\n\n      const colorPaleGrey = globalStore.state.isDarkMode ? [80, 80, 80, 96] : [212, 212, 212, 40]\n      const colorInvisible = [0, 0, 0, 0]\n\n      const color = (i: number) => {\n        // if (!buildData[this.csvData.activeColumn]) return colorPaleGrey\n\n        const csvRow = this.csvData.csvRowFromLinkRow[i]\n        let value = buildData[this.csvData.activeColumn]?.values[csvRow]\n\n        if (this.fixedColors.length === 1) return colorsAsRGB[0]\n        if (!value && !this.vizDetails.showDifferences) return colorInvisible\n        if (isCategorical) return setColorBasedOnValue(value)\n\n        if (this.vizDetails.showDifferences) {\n          const baseRow = this.csvBase.csvRowFromLinkRow[i]\n          const baseValue = baseData[activeColumn].values[baseRow]\n          const diff = value - baseValue\n\n          if (diff === 0) return colorPaleGrey // setColorBasedOnValue(0.5)\n\n          // red vs. blue\n          if (this.isDarkMode) {\n            return diff > 0 ? [255, 64, 64, 255] : [64, 96, 255, 255] // red vs. blue\n          } else {\n            return diff > 0 ? [255, 0, 0, 255] : [32, 64, 255, 255] // red vs. blue\n          }\n        } else {\n          // don't use log scale if numbers are below 1.0\n          let ratio = value / (buildColumn.max || 1.0)\n          // if (ratio < 0.0001) return colorPaleGrey\n          return setColorBasedOnValue(ratio)\n        }\n      }\n\n      for (let i = 0; i < numLinks; i++) {\n        colors.set(color(i), i * 4)\n      }\n\n      this.colorArray = colors\n    },\n\n    loadCSVFiles() {\n      this.myState.statusMessage = 'Loading datasets...'\n\n      // Old yaml format listed csvFile and csvBase explicitly.\n      // Merge those into vizDetails.datasets if they exist.\n      if (!this.vizDetails.datasets) this.vizDetails.datasets = {}\n      if (this.vizDetails.csvFile) this.vizDetails.datasets.csvFile = this.vizDetails.csvFile\n      if (this.vizDetails.csvBase) this.vizDetails.datasets.csvBase = this.vizDetails.csvBase\n\n      // Load files on workers, in parallel and off the main thread\n      // this will call finishedLoadingCSV() for each when it's done loading & parsing\n      const datasetsToLoad = Object.entries(this.vizDetails.datasets)\n\n      if (datasetsToLoad.length) {\n        for (const [key, filename] of datasetsToLoad) {\n          this.loadOneCSVFile(key, filename)\n        }\n      } else {\n        this.showSimpleNetworkWithNoDatasets()\n      }\n    },\n\n    showSimpleNetworkWithNoDatasets() {\n      // no datasets; we are just showing the bare network\n      this.csvData = {\n        datasetKey: '',\n        dataTable: {\n          [LOOKUP_COLUMN]: {\n            name: LOOKUP_COLUMN,\n            type: DataType.LOOKUP,\n            values: [],\n          },\n        },\n        activeColumn: LOOKUP_COLUMN,\n        csvRowFromLinkRow: [],\n      }\n\n      // there is no range(maxValue) in Javascript! :-(\n      const length = this.geojsonData.source.length / 2 // half because this contains x/y coordinates\n      const lookup = [...Array(length).keys()]\n      this.csvData.dataTable[LOOKUP_COLUMN].values = lookup\n\n      this.myState.statusMessage = ''\n      this.setDataIsLoaded()\n\n      const color: LineColorDefinition = {\n        fixedColors: this.fixedColors,\n        dataset: '',\n        columnName: '',\n        normalize: '',\n      }\n      this.changeConfiguration({ color })\n    },\n\n    handleDatasetisLoaded(datasetId: string) {\n      const datasetKeys = Object.keys(this.datasets)\n\n      if (datasetId === 'csvBase' || datasetId === 'base') {\n        // is base dataset:\n        this.csvBase = {\n          datasetKey: datasetId,\n          dataTable: this.datasets[datasetId],\n          csvRowFromLinkRow: this.csvRowLookupFromLinkRow[datasetId],\n          activeColumn: '',\n        }\n        this.csvWidthBase = {\n          datasetKey: datasetId,\n          dataTable: this.datasets[datasetId],\n          csvRowFromLinkRow: this.csvRowLookupFromLinkRow[datasetId],\n          activeColumn: '',\n        }\n      } else if (this.csvData.activeColumn === '') {\n        // is first non-base dataset:\n        // set a default view, if user didn't pass anything in\n        if (!this.vizDetails.display.color && !this.vizDetails.display.width) {\n          const firstColumnName = Object.values(this.datasets[datasetId])[0].name\n          this.csvData = {\n            datasetKey: datasetId,\n            dataTable: this.datasets[datasetId],\n            csvRowFromLinkRow: this.csvRowLookupFromLinkRow[datasetId],\n            activeColumn: firstColumnName,\n          }\n        }\n      }\n\n      // last dataset\n      if (datasetKeys.length === Object.keys(this.vizDetails.datasets).length) {\n        this.setDataIsLoaded()\n        this.myState.statusMessage = ''\n        console.log({ DATASETS: this.datasets })\n      }\n    },\n\n    async loadOneCSVFile(key: string, filename: string) {\n      try {\n        const dataset = await this.myDataManager.getDataset({ dataset: filename })\n        const dataTable = dataset.allRows\n\n        console.log('loaded', key)\n        this.myState.statusMessage = 'Analyzing...'\n\n        // remove columns without names; we can't use them\n        const cleanTable: DataTable = {}\n        for (const key of Object.keys(dataTable)) {\n          if (key) cleanTable[key] = dataTable[key]\n        }\n\n        this.datasets = Object.assign({ ...this.datasets }, { [key]: cleanTable })\n        this.handleNewDataset({ key, dataTable: cleanTable })\n      } catch (e) {\n        this.$emit('error', 'Could not load ' + filename)\n        this.$emit('isLoaded')\n      }\n    },\n\n    handleNewDataColumn(value: { dataset: LookupDataset; column: string }) {\n      const { dataset, column } = value\n\n      // selector is attached to a dataset. Both color and width could be\n      // impacted, if they are attached to that dataset.\n\n      const config: any = {}\n\n      // WIDTHS\n      if (dataset.datasetKey === this.csvWidth.datasetKey) {\n        const width: LineWidthDefinition = { ...this.vizDetails.display.width }\n        width.columnName = column\n        config.width = width\n      }\n\n      // COLORS\n      if (dataset.datasetKey === this.csvData.datasetKey) {\n        const color: LineColorDefinition = { ...this.vizDetails.display.color }\n        color.columnName = column\n        config.color = color\n      }\n\n      this.changeConfiguration(config)\n    },\n  },\n  async mounted() {\n    this.$store.commit('setFullScreen', !this.thumbnail)\n\n    this.myState.thumbnail = this.thumbnail\n    this.myState.yamlConfig = this.yamlConfig ?? ''\n    this.myState.subfolder = this.subfolder\n\n    await this.getVizDetails()\n\n    this.setupLogoMover()\n    console.log('ok')\n  },\n\n  beforeDestroy() {\n    // MUST delete the React view handle to prevent gigantic memory leak!\n    delete REACT_VIEW_HANDLES[this.linkLayerId]\n\n    try {\n      for (const worker of this.dataLoaderWorkers) worker.terminate()\n    } catch (e) {}\n\n    this.$store.commit('setFullScreen', false)\n  },\n})\n\nexport default MyComponent\n</script>\n\n<style scoped lang=\"scss\">\n@import '@/styles.scss';\n\n.link-volume-plot {\n  min-height: $thumbnailHeight;\n  display: flex;\n  flex-direction: row-reverse;\n  height: 100%;\n}\n\n.link-volume-plot.hide-thumbnail {\n  background: var(--bgMapPanel);\n}\n\n.plot-container {\n  display: grid;\n  grid-template-columns: auto 1fr;\n  grid-template-rows: 1fr auto auto;\n  pointer-events: auto;\n  flex: 1;\n  position: relative;\n}\n\n.map-area {\n  pointer-events: auto;\n}\n\n.details-panel {\n  width: 22rem;\n  // background-color: #373641;\n  background: linear-gradient(35deg, #034a71, #2c5241);\n  background: linear-gradient(35deg, #2c5241, #034a71);\n  padding: 0.5rem 1rem;\n  color: #eee;\n  // border-left: 1px solid #557;\n  display: flex;\n  flex-direction: column;\n}\n.top-panel {\n  pointer-events: auto;\n  grid-column: 1 / 2;\n  grid-row: 1 / 2;\n  background-color: var(--bgPanel);\n  margin: 0 auto auto 0;\n  padding: 0.5rem 1.5rem 1rem 1.5rem;\n  z-index: 5;\n  box-shadow: 0px 2px 10px #22222244;\n}\n\n.bottom-panel {\n  grid-column: 1 / 3;\n  grid-row: 2 / 3;\n  display: flex;\n  flex-direction: column;\n  font-size: 0.8rem;\n  pointer-events: auto;\n  margin: auto 0.5rem 2px 7px;\n  filter: drop-shadow(0px 2px 4px #22222233);\n}\n\n.status-message {\n  margin: 0 0 0.5rem 0;\n  padding: 0.5rem 0.5rem;\n  color: var(--textFancy);\n  background-color: var(--bgPanel);\n  font-size: 1.2rem;\n  line-height: 1.5rem;\n}\n\n.right-side {\n  z-index: 1;\n  display: flex;\n  flex-direction: row;\n  margin: 0 0 auto 0;\n}\n\n.panel-items {\n  display: flex;\n  flex-direction: column;\n  padding: 0.5rem 0.5rem;\n  margin-bottom: 5px;\n  width: 16rem;\n  background-color: var(--bgPanel);\n  border-radius: 3px;\n  overflow: visible;\n  // overflow-x: hidden;\n}\n\nh3 {\n  line-height: 1.7rem;\n  margin-top: 1rem;\n}\n\ninput {\n  border: none;\n  background-color: var(--bgCream2);\n  color: var(--bgDark);\n}\n\n.toggle {\n  margin: 0.25rem 0.5rem 0.25rem 0;\n}\n\n#dropdown-menu-color-selector {\n  background-color: var(--bgBold);\n\n  p {\n    color: #888;\n  }\n}\n\n.panel-item {\n  margin-top: 0rem;\n}\n\n.config-section {\n  flex: 1;\n}\n\n.diff-section {\n  display: flex;\n  flex-direction: row;\n  margin-top: 0.7rem;\n\n  p {\n    margin: auto 0;\n  }\n}\n\n.filter-panel {\n  height: 6rem;\n  background-color: var(--bgPanel);\n  margin: 0rem auto 5px 0px;\n  border-radius: 3px;\n  // width: 100%;\n}\n\n.statistics {\n  flex: 1;\n}\n\n.reliability {\n  flex: 1;\n  margin-bottom: 1rem;\n}\n\n.myplot {\n  margin-top: 0.5rem;\n}\n</style>\n"],"names":["_sfc_main$1","defineComponent","useIt","result","i18n","_sfc_main","TimeSlider","f","DataType","value","colors","column","debounce","Component","viewId","links","colorRampType","build","base","widths","widthsBase","newColors","newWidths","dark","projection","scaleWidth","mapIsIndependent","click","paths","viewState","setViewState","useState","globalStore","buildColumn","baseColumn","widthColumn","isCategorical","REACT_VIEW_HANDLES","view","handleClick","event","handleViewState","precise","x","format","buildTooltipHtml","columnBuild","columnBase","geoOffset","index","html","baseIndex","baseValue","diff","getTooltip","object","tooltip","widthTip","e","coordinateSystem","COORDINATE_SYSTEM","layer","PathOffsetLayer","d","OFFSET_DIRECTION","React","DeckGL","isDragging","isHovering","StaticMap","MAPBOX_TOKEN","LOOKUP_COLUMN","MyComponent","SelectorPanel","DrawingTool","LinkLayer","ToggleButton","VizConfigurator","VuePlotly","ZoomButtons","BG_COLOR_DASHBOARD","UI_FONT","LegendStore","ColorScheme","DashboardDataManager","HTTPFileSystem","svnProject","a","rampType","_b","_a","i","filename","emptyState","t","text","YAML","err","hasYaml","configuration","key","Status","blob","buffer","readBlob","base64","arrayBufferToBase64","props","coord","lonLo","lonHi","latLo","latHi","data","selectedPath","path","lastSelectedPointIndex","p","speed","startTime","avgSpeed","b","lon","lat","server","url","trips","response","selectedPaths","chunk","tripIDs","trip","pathUrl","coords","point","speeds","columns","width","shallowEqualObjects","columnName","dataset","scaleFactor","recalculate","selectedDataset","msg","color","datasetKey","samples","longitude","latitude","numLinks","gap","deckmap","logo","right","message","network","title","dataTable","assumedLinkIdIsFirstColumn","linkIdColumn","tempMapLinkIdToCsvRow","csvRow","getCsvRowNumberFromLinkRowNumber","linkRow","linkId","widthValues","baseValues","_d","_c","baseRow","colorsAsRGB","hexcolor","c","rgb","exponent","domain","v","buildData","baseData","activeColumn","setColorBasedOnValue","scaleOrdinal","scaleThreshold","colorPaleGrey","colorInvisible","ratio","datasetsToLoad","length","lookup","datasetId","datasetKeys","firstColumnName","cleanTable","config","worker"],"mappings":"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"}