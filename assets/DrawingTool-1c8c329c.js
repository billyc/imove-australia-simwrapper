var sn=Object.defineProperty;var on=(o,e,t)=>e in o?sn(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var ne=(o,e,t)=>(on(o,typeof e!="symbol"?e+"":e,t),t);import{b as an,i as Ft,g as Lt,C as ln,m as un,M as hn,d as cn,n as dn}from"./index-2c5e1d98.js";import{a as fn,_ as Tt,p as pn,b as gn,C as re,g as mn,F as yn,M as _e,G as _n,l as It,D as vn}from"./layer-4078ee04.js";import{S as Fe,I as bn,T as wn,C as xn}from"./text-layer-059aaf64.js";import{T as kn,c as Cn,a as Sn,P as An}from"./path-layer-a3827a85.js";const ve=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,Ln={lightSources:{}};function ie(){let{color:o=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return o.map(t=>t*e/255)}function In(o){let{ambientLight:e,pointLights:t=[],directionalLights:l=[]}=o;const s={};return e?s["lighting_uAmbientLight.color"]=ie(e):s["lighting_uAmbientLight.color"]=[0,0,0],t.forEach((n,i)=>{s["lighting_uPointLight[".concat(i,"].color")]=ie(n),s["lighting_uPointLight[".concat(i,"].position")]=n.position,s["lighting_uPointLight[".concat(i,"].attenuation")]=n.attenuation||[1,0,0]}),s.lighting_uPointLightCount=t.length,l.forEach((n,i)=>{s["lighting_uDirectionalLight[".concat(i,"].color")]=ie(n),s["lighting_uDirectionalLight[".concat(i,"].direction")]=n.direction}),s.lighting_uDirectionalLightCount=l.length,s}function Be(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ln;if("lightSources"in o){const{ambientLight:e,pointLights:t,directionalLights:l}=o.lightSources||{};return e||t&&t.length>0||l&&l.length>0?Object.assign({},In({ambientLight:e,pointLights:t,directionalLights:l}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in o){const e={pointLights:[],directionalLights:[]};for(const t of o.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t);break}return Be({lightSources:e})}return{}}const Ne={name:"lights",vs:ve,fs:ve,getUniforms:Be,defines:{MAX_LIGHTS:3}},Me=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,Pn={};function En(o){const{ambient:e=.35,diffuse:t=.6,shininess:l=32,specularColor:s=[30,30,30]}=o;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:l,lighting_uSpecularColor:s.map(n=>n/255)}}function Ue(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pn;if(!("material"in o))return{};const{material:e}=o;return e?En(e):{lighting_uEnabled:!1}}const zn={name:"gouraud-lighting",dependencies:[Ne],vs:Me,defines:{LIGHTING_VERTEX:1},getUniforms:Ue},ri={name:"phong-lighting",dependencies:[Ne],fs:Me,defines:{LIGHTING_FRAGMENT:1},getUniforms:Ue},We={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function je(o,e,t={}){return Tn(o,t)!==e?(Dn(o,t),!0):!1}function Tn(o,e={}){return Math.sign(On(o,e))}function On(o,e={}){const{start:t=0,end:l=o.length}=e,s=e.size||2;let n=0;for(let i=t,r=l-s;i<l;i+=s)n+=(o[i]-o[r])*(o[i+1]+o[r+1]),r=i;return n/2}function Dn(o,e){const{start:t=0,end:l=o.length,size:s=2}=e,n=(l-t)/s,i=Math.floor(n/2);for(let r=0;r<i;++r){const u=t+r*s,f=t+(n-1-r)*s;for(let v=0;v<s;++v){const g=o[u+v];o[u+v]=o[f+v],o[f+v]=g}}}var ce={exports:{}};ce.exports=Yt;ce.exports.default=Yt;function Yt(o,e,t){t=t||2;var l=e&&e.length,s=l?e[0]*t:o.length,n=Ze(o,0,s,t,!0),i=[];if(!n||n.next===n.prev)return i;var r,u,f,v,g,y,c;if(l&&(n=Mn(o,e,n,t)),o.length>80*t){r=f=o[0],u=v=o[1];for(var m=t;m<s;m+=t)g=o[m],y=o[m+1],g<r&&(r=g),y<u&&(u=y),g>f&&(f=g),y>v&&(v=y);c=Math.max(f-r,v-u),c=c!==0?32767/c:0}return Pt(n,i,t,r,u,c,0),i}function Ze(o,e,t,l,s){var n,i;if(s===ue(o,e,t,l)>0)for(n=e;n<t;n+=l)i=be(n,o[n],o[n+1],i);else for(n=t-l;n>=e;n-=l)i=be(n,o[n],o[n+1],i);return i&&Xt(i,i.next)&&(zt(i),i=i.next),i}function yt(o,e){if(!o)return o;e||(e=o);var t=o,l;do if(l=!1,!t.steiner&&(Xt(t,t.next)||st(t.prev,t,t.next)===0)){if(zt(t),t=e=t.prev,t===t.next)break;l=!0}else t=t.next;while(l||t!==e);return e}function Pt(o,e,t,l,s,n,i){if(o){!i&&n&&Gn(o,l,s,n);for(var r=o,u,f;o.prev!==o.next;){if(u=o.prev,f=o.next,n?Fn(o,l,s,n):Rn(o)){e.push(u.i/t|0),e.push(o.i/t|0),e.push(f.i/t|0),zt(o),o=f.next,r=f.next;continue}if(o=f,o===r){i?i===1?(o=Bn(yt(o),e,t),Pt(o,e,t,l,s,n,2)):i===2&&Nn(o,e,t,l,s,n):Pt(yt(o),e,t,l,s,n,1);break}}}}function Rn(o){var e=o.prev,t=o,l=o.next;if(st(e,t,l)>=0)return!1;for(var s=e.x,n=t.x,i=l.x,r=e.y,u=t.y,f=l.y,v=s<n?s<i?s:i:n<i?n:i,g=r<u?r<f?r:f:u<f?u:f,y=s>n?s>i?s:i:n>i?n:i,c=r>u?r>f?r:f:u>f?u:f,m=l.next;m!==e;){if(m.x>=v&&m.x<=y&&m.y>=g&&m.y<=c&&vt(s,r,n,u,i,f,m.x,m.y)&&st(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Fn(o,e,t,l){var s=o.prev,n=o,i=o.next;if(st(s,n,i)>=0)return!1;for(var r=s.x,u=n.x,f=i.x,v=s.y,g=n.y,y=i.y,c=r<u?r<f?r:f:u<f?u:f,m=v<g?v<y?v:y:g<y?g:y,d=r>u?r>f?r:f:u>f?u:f,b=v>g?v>y?v:y:g>y?g:y,p=ae(c,m,e,t,l),x=ae(d,b,e,t,l),k=o.prevZ,S=o.nextZ;k&&k.z>=p&&S&&S.z<=x;){if(k.x>=c&&k.x<=d&&k.y>=m&&k.y<=b&&k!==s&&k!==i&&vt(r,v,u,g,f,y,k.x,k.y)&&st(k.prev,k,k.next)>=0||(k=k.prevZ,S.x>=c&&S.x<=d&&S.y>=m&&S.y<=b&&S!==s&&S!==i&&vt(r,v,u,g,f,y,S.x,S.y)&&st(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;k&&k.z>=p;){if(k.x>=c&&k.x<=d&&k.y>=m&&k.y<=b&&k!==s&&k!==i&&vt(r,v,u,g,f,y,k.x,k.y)&&st(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;S&&S.z<=x;){if(S.x>=c&&S.x<=d&&S.y>=m&&S.y<=b&&S!==s&&S!==i&&vt(r,v,u,g,f,y,S.x,S.y)&&st(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function Bn(o,e,t){var l=o;do{var s=l.prev,n=l.next.next;!Xt(s,n)&&Ge(s,l,l.next,n)&&Et(s,n)&&Et(n,s)&&(e.push(s.i/t|0),e.push(l.i/t|0),e.push(n.i/t|0),zt(l),zt(l.next),l=o=n),l=l.next}while(l!==o);return yt(l)}function Nn(o,e,t,l,s,n){var i=o;do{for(var r=i.next.next;r!==i.prev;){if(i.i!==r.i&&Vn(i,r)){var u=He(i,r);i=yt(i,i.next),u=yt(u,u.next),Pt(i,e,t,l,s,n,0),Pt(u,e,t,l,s,n,0);return}r=r.next}i=i.next}while(i!==o)}function Mn(o,e,t,l){var s=[],n,i,r,u,f;for(n=0,i=e.length;n<i;n++)r=e[n]*l,u=n<i-1?e[n+1]*l:o.length,f=Ze(o,r,u,l,!1),f===f.next&&(f.steiner=!0),s.push(Kn(f));for(s.sort(Un),n=0;n<s.length;n++)t=Wn(s[n],t);return t}function Un(o,e){return o.x-e.x}function Wn(o,e){var t=jn(o,e);if(!t)return e;var l=He(t,o);return yt(l,l.next),yt(t,t.next)}function jn(o,e){var t=e,l=o.x,s=o.y,n=-1/0,i;do{if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){var r=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(r<=l&&r>n&&(n=r,i=t.x<t.next.x?t:t.next,r===l))return i}t=t.next}while(t!==e);if(!i)return null;var u=i,f=i.x,v=i.y,g=1/0,y;t=i;do l>=t.x&&t.x>=f&&l!==t.x&&vt(s<v?l:n,s,f,v,s<v?n:l,s,t.x,t.y)&&(y=Math.abs(s-t.y)/(l-t.x),Et(t,o)&&(y<g||y===g&&(t.x>i.x||t.x===i.x&&Zn(i,t)))&&(i=t,g=y)),t=t.next;while(t!==u);return i}function Zn(o,e){return st(o.prev,o,e.prev)<0&&st(e.next,o,o.next)<0}function Gn(o,e,t,l){var s=o;do s.z===0&&(s.z=ae(s.x,s.y,e,t,l)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==o);s.prevZ.nextZ=null,s.prevZ=null,Hn(s)}function Hn(o){var e,t,l,s,n,i,r,u,f=1;do{for(t=o,o=null,n=null,i=0;t;){for(i++,l=t,r=0,e=0;e<f&&(r++,l=l.nextZ,!!l);e++);for(u=f;r>0||u>0&&l;)r!==0&&(u===0||!l||t.z<=l.z)?(s=t,t=t.nextZ,r--):(s=l,l=l.nextZ,u--),n?n.nextZ=s:o=s,s.prevZ=n,n=s;t=l}n.nextZ=null,f*=2}while(i>1);return o}function ae(o,e,t,l,s){return o=(o-t)*s|0,e=(e-l)*s|0,o=(o|o<<8)&16711935,o=(o|o<<4)&252645135,o=(o|o<<2)&858993459,o=(o|o<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,o|e<<1}function Kn(o){var e=o,t=o;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==o);return t}function vt(o,e,t,l,s,n,i,r){return(s-i)*(e-r)>=(o-i)*(n-r)&&(o-i)*(l-r)>=(t-i)*(e-r)&&(t-i)*(n-r)>=(s-i)*(l-r)}function Vn(o,e){return o.next.i!==e.i&&o.prev.i!==e.i&&!Yn(o,e)&&(Et(o,e)&&Et(e,o)&&Xn(o,e)&&(st(o.prev,o,e.prev)||st(o,e.prev,e))||Xt(o,e)&&st(o.prev,o,o.next)>0&&st(e.prev,e,e.next)>0)}function st(o,e,t){return(e.y-o.y)*(t.x-e.x)-(e.x-o.x)*(t.y-e.y)}function Xt(o,e){return o.x===e.x&&o.y===e.y}function Ge(o,e,t,l){var s=Nt(st(o,e,t)),n=Nt(st(o,e,l)),i=Nt(st(t,l,o)),r=Nt(st(t,l,e));return!!(s!==n&&i!==r||s===0&&Bt(o,t,e)||n===0&&Bt(o,l,e)||i===0&&Bt(t,o,l)||r===0&&Bt(t,e,l))}function Bt(o,e,t){return e.x<=Math.max(o.x,t.x)&&e.x>=Math.min(o.x,t.x)&&e.y<=Math.max(o.y,t.y)&&e.y>=Math.min(o.y,t.y)}function Nt(o){return o>0?1:o<0?-1:0}function Yn(o,e){var t=o;do{if(t.i!==o.i&&t.next.i!==o.i&&t.i!==e.i&&t.next.i!==e.i&&Ge(t,t.next,o,e))return!0;t=t.next}while(t!==o);return!1}function Et(o,e){return st(o.prev,o,o.next)<0?st(o,e,o.next)>=0&&st(o,o.prev,e)>=0:st(o,e,o.prev)<0||st(o,o.next,e)<0}function Xn(o,e){var t=o,l=!1,s=(o.x+e.x)/2,n=(o.y+e.y)/2;do t.y>n!=t.next.y>n&&t.next.y!==t.y&&s<(t.next.x-t.x)*(n-t.y)/(t.next.y-t.y)+t.x&&(l=!l),t=t.next;while(t!==o);return l}function He(o,e){var t=new le(o.i,o.x,o.y),l=new le(e.i,e.x,e.y),s=o.next,n=e.prev;return o.next=e,e.prev=o,t.next=s,s.prev=t,l.next=t,t.prev=l,n.next=l,l.prev=n,l}function be(o,e,t,l){var s=new le(o,e,t);return l?(s.next=l.next,s.prev=l,l.next.prev=s,l.next=s):(s.prev=s,s.next=s),s}function zt(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function le(o,e,t){this.i=o,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Yt.deviation=function(o,e,t,l){var s=e&&e.length,n=s?e[0]*t:o.length,i=Math.abs(ue(o,0,n,t));if(s)for(var r=0,u=e.length;r<u;r++){var f=e[r]*t,v=r<u-1?e[r+1]*t:o.length;i-=Math.abs(ue(o,f,v,t))}var g=0;for(r=0;r<l.length;r+=3){var y=l[r]*t,c=l[r+1]*t,m=l[r+2]*t;g+=Math.abs((o[y]-o[m])*(o[c+1]-o[y+1])-(o[y]-o[c])*(o[m+1]-o[y+1]))}return i===0&&g===0?0:Math.abs((g-i)/i)};function ue(o,e,t,l){for(var s=0,n=e,i=t-l;n<t;n+=l)s+=(o[i]-o[n])*(o[n+1]+o[i+1]),i=n;return s}Yt.flatten=function(o){for(var e=o[0][0].length,t={vertices:[],holes:[],dimensions:e},l=0,s=0;s<o.length;s++){for(var n=0;n<o[s].length;n++)for(var i=0;i<e;i++)t.vertices.push(o[s][n][i]);s>0&&(l+=o[s-1].length,t.holes.push(l))}return t};var Qn=ce.exports;const Jn=an(Qn),Mt=We.CLOCKWISE,we=We.COUNTER_CLOCKWISE,mt={isClosed:!0};function qn(o){if(o=o&&o.positions||o,!Array.isArray(o)&&!ArrayBuffer.isView(o))throw new Error("invalid polygon")}function At(o){return"positions"in o?o.positions:o}function Zt(o){return"holeIndices"in o?o.holeIndices:null}function $n(o){return Array.isArray(o[0])}function tr(o){return o.length>=1&&o[0].length>=2&&Number.isFinite(o[0][0])}function er(o){const e=o[0],t=o[o.length-1];return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function nr(o,e,t,l){for(let s=0;s<e;s++)if(o[t+s]!==o[l-e+s])return!1;return!0}function xe(o,e,t,l,s){let n=e;const i=t.length;for(let r=0;r<i;r++)for(let u=0;u<l;u++)o[n++]=t[r][u]||0;if(!er(t))for(let r=0;r<l;r++)o[n++]=t[0][r]||0;return mt.start=e,mt.end=n,mt.size=l,je(o,s,mt),n}function ke(o,e,t,l,s=0,n,i){n=n||t.length;const r=n-s;if(r<=0)return e;let u=e;for(let f=0;f<r;f++)o[u++]=t[s+f];if(!nr(t,l,s,n))for(let f=0;f<l;f++)o[u++]=t[s+f];return mt.start=e,mt.end=u,mt.size=l,je(o,i,mt),u}function rr(o,e){qn(o);const t=[],l=[];if("positions"in o){const{positions:s,holeIndices:n}=o;if(n){let i=0;for(let r=0;r<=n.length;r++)i=ke(t,i,s,e,n[r-1],n[r],r===0?Mt:we),l.push(i);return l.pop(),{positions:t,holeIndices:l}}o=s}if(!$n(o))return ke(t,0,o,e,0,t.length,Mt),t;if(!tr(o)){let s=0;for(const[n,i]of o.entries())s=xe(t,s,i,e,n===0?Mt:we),l.push(s);return l.pop(),{positions:t,holeIndices:l}}return xe(t,0,o,e,Mt),t}function ir(o,e,t){let l=Zt(o);l&&(l=l.map(n=>n/e));let s=At(o);if(t){const n=s.length;s=s.slice();const i=[];for(let r=0;r<n;r+=e){i[0]=s[r],i[1]=s[r+1];const u=t(i);s[r]=u[0],s[r+1]=u[1]}}return Jn(s,l,e)}class sr extends kn{constructor(e){const{fp64:t,IndexType:l=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:l,size:1}}})}get(e){const{attributes:t}=this;return e==="indices"?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const t=rr(e,this.positionSize);return this.opts.resolution?Cn(At(t),Zt(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Sn(At(t),Zt(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(Ce(e)){let t=0;for(const l of e)t+=this.getGeometrySize(l);return t}return At(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&Ce(e))for(const l of e){const s=this.getGeometrySize(l);t.geometrySize=s,this.updateGeometryAttributes(l,t),t.vertexStart+=s,t.indexStart=this.indexStarts[t.geometryIndex+1]}else this._updateIndices(e,t),this._updatePositions(e,t),this._updateVertexValid(e,t)}_updateIndices(e,{geometryIndex:t,vertexStart:l,indexStart:s}){const{attributes:n,indexStarts:i,typedArrayManager:r}=this;let u=n.indices;if(!u||!e)return;let f=s;const v=ir(e,this.positionSize,this.opts.preproject);u=r.allocate(u,s+v.length,{copy:!0});for(let g=0;g<v.length;g++)u[f++]=v[g]+l;i[t+1]=s+v.length,n.indices=u}_updatePositions(e,{vertexStart:t,geometrySize:l}){const{attributes:{positions:s},positionSize:n}=this;if(!s||!e)return;const i=At(e);for(let r=t,u=0;u<l;r++,u++){const f=i[u*n],v=i[u*n+1],g=n>2?i[u*n+2]:0;s[r*3]=f,s[r*3+1]=v,s[r*3+2]=g}}_updateVertexValid(e,{vertexStart:t,geometrySize:l}){const{positionSize:s}=this,n=this.attributes.vertexValid,i=e&&Zt(e);if(e&&e.edgeTypes?n.set(e.edgeTypes,t):n.fill(1,t,t+l),i)for(let r=0;r<i.length;r++)n[t+i[r]/s-1]=0;n[t+l-1]=0}}function Ce(o){return Array.isArray(o)&&o.length>0&&!Number.isFinite(o[0])}const Ke=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,or=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(Ke,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),ar=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(Ke,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),lr=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Kt=[0,0,0,255],ur={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:o=>o.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Kt},getLineColor:{type:"accessor",value:Kt},material:!0},Ut={enter:(o,e)=>e.length?e.subarray(e.length-o.length):o};class de extends fn{constructor(...e){super(...e),Tt(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?or:ar,fs:lr,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[pn,zn,gn]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:t}=this.context;let{coordinateSystem:l}=this.props;t.isGeospatial&&l===re.DEFAULT&&(l=re.LNGLAT),this.setState({numInstances:0,polygonTesselator:new sr({preproject:l===re.LNGLAT&&t.projectFlat.bind(t),fp64:this.use64bitPositions(),IndexType:!e||mn(e,yn.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const s=this.getAttributeManager(),n=!0;s.remove(["instancePickingColors"]),s.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:Ut,accessor:"getPolygon",update:this.calculatePositions,noAlloc:n,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:n},elevations:{size:1,transition:Ut,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ut,accessor:"getFillColor",defaultValue:Kt,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Ut,accessor:"getLineColor",defaultValue:Kt,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(i,{index:r,target:u})=>this.encodePickingColor(i&&i.__source?i.__source.index:r,u),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:l}=t,{data:s}=this.props;return s[0]&&s[0].__source&&(t.object=s.find(n=>n.__source.index===l)),t}disablePickingIndex(e){const{data:t}=this.props;if(t[0]&&t[0].__source)for(let l=0;l<t.length;l++)t[l].__source.index===e&&this._disablePickingIndex(l);else this._disablePickingIndex(e)}draw({uniforms:e}){const{extruded:t,filled:l,wireframe:s,elevationScale:n}=this.props,{topModel:i,sideModel:r,polygonTesselator:u}=this.state,f={...e,extruded:!!t,elevationScale:n};r&&(r.setInstanceCount(u.instanceCount-1),r.setUniforms(f),s&&(r.setDrawMode(3),r.setUniforms({isWireframe:!0}).draw()),l&&(r.setDrawMode(6),r.setUniforms({isWireframe:!1}).draw())),i&&(i.setVertexCount(u.vertexCount),i.setUniforms(f).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:l,changeFlags:s}=e,n=this.getAttributeManager();if(s.extensionsChanged||t.filled!==l.filled||t.extruded!==l.extruded){var r;(r=this.state.models)===null||r===void 0||r.forEach(u=>u.delete()),this.setState(this._getModels(this.context.gl)),n.invalidateAll()}}updateGeometry({props:e,oldProps:t,changeFlags:l}){if(l.dataChanged||l.updateTriggersChanged&&(l.updateTriggersChanged.all||l.updateTriggersChanged.getPolygon)){const{polygonTesselator:n}=this.state;if(n.instanceCount)return;const i=e.data.attributes||{};n.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:i.getPolygon,buffers:i,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:l.dataChanged}),this.setState({numInstances:n.instanceCount,startIndices:n.vertexStarts}),l.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:t,filled:l,extruded:s}=this.props;let n,i;if(l){const r=this.getShaders("top");r.defines.NON_INSTANCED_MODEL=1,n=new _e(e,{...r,id:"".concat(t,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return s&&(i=new _e(e,{...this.getShaders("side"),id:"".concat(t,"-side"),geometry:new _n({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),i.userData.excludeAttributes={indices:!0}),{models:[i,n].filter(Boolean),topModel:n,sideModel:i}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}Tt(de,"defaultProps",ur);Tt(de,"layerName","SolidPolygonLayer");function hr({data:o,getIndex:e,dataRange:t,replace:l}){const{startRow:s=0,endRow:n=1/0}=t,i=o.length;let r=i,u=i;for(let y=0;y<i;y++){const c=e(o[y]);if(r>y&&c>=s&&(r=y),c>=n){u=y;break}}let f=r;const g=u-r!==l.length?o.slice(u):void 0;for(let y=0;y<l.length;y++)o[f++]=l[y];if(g){for(let y=0;y<g.length;y++)o[f++]=g[y];o.length=f}return{startRow:r,endRow:r+l.length}}function cr(o,e){if(!o)return null;const t="startIndices"in o?o.startIndices[e]:e,l=o.featureIds.value[t];return t!==-1?dr(o,l,t):null}function dr(o,e,t){const l={properties:{...o.properties[e]}};for(const s in o.numericProps)l.properties[s]=o.numericProps[s].value[t];return l}function fr(o,e){const t={points:null,lines:null,polygons:null};for(const l in t){const s=o[l].globalFeatureIds.value;t[l]=new Uint8ClampedArray(s.length*3);const n=[];for(let i=0;i<s.length;i++)e(s[i],n),t[l][i*3+0]=n[0],t[l][i*3+1]=n[1],t[l][i*3+2]=n[2]}return t}const Gt={circle:{type:Fe,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:bn,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:wn,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Ht={type:An,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},he={type:de,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function St({type:o,props:e}){const t={};for(const l in e)t[l]=o.defaultProps[e[l]];return t}function se(o,e){const{transitions:t,updateTriggers:l}=o.props,s={updateTriggers:{},transitions:t&&{getPosition:t.geometry}};for(const n in e){const i=e[n];let r=o.props[n];n.startsWith("get")&&(r=o.getSubLayerAccessor(r),s.updateTriggers[i]=l[n],t&&(s.transitions[i]=t[n])),s[i]=r}return s}function pr(o){if(Array.isArray(o))return o;switch(It.assert(o.type,"GeoJSON does not have type"),o.type){case"Feature":return[o];case"FeatureCollection":return It.assert(Array.isArray(o.features),"GeoJSON does not have features array"),o.features;default:return[{geometry:o}]}}function Se(o,e,t={}){const l={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:s=0,endRow:n=o.length}=t;for(let i=s;i<n;i++){const r=o[i],{geometry:u}=r;if(u)if(u.type==="GeometryCollection"){It.assert(Array.isArray(u.geometries),"GeoJSON does not have geometries array");const{geometries:f}=u;for(let v=0;v<f.length;v++){const g=f[v];Ae(g,l,e,r,i)}}else Ae(u,l,e,r,i)}return l}function Ae(o,e,t,l,s){const{type:n,coordinates:i}=o,{pointFeatures:r,lineFeatures:u,polygonFeatures:f,polygonOutlineFeatures:v}=e;if(!mr(n,i)){It.warn("".concat(n," coordinates are malformed"))();return}switch(n){case"Point":r.push(t({geometry:o},l,s));break;case"MultiPoint":i.forEach(g=>{r.push(t({geometry:{type:"Point",coordinates:g}},l,s))});break;case"LineString":u.push(t({geometry:o},l,s));break;case"MultiLineString":i.forEach(g=>{u.push(t({geometry:{type:"LineString",coordinates:g}},l,s))});break;case"Polygon":f.push(t({geometry:o},l,s)),i.forEach(g=>{v.push(t({geometry:{type:"LineString",coordinates:g}},l,s))});break;case"MultiPolygon":i.forEach(g=>{f.push(t({geometry:{type:"Polygon",coordinates:g}},l,s)),g.forEach(y=>{v.push(t({geometry:{type:"LineString",coordinates:y}},l,s))})});break}}const gr={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function mr(o,e){let t=gr[o];for(It.assert(t,"Unknown GeoJSON type ".concat(o));e&&--t>0;)e=e[0];return e&&Number.isFinite(e[0])}function Ve(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function Wt(o){return o.geometry.coordinates}function yr(o,e){const t=Ve(),{pointFeatures:l,lineFeatures:s,polygonFeatures:n,polygonOutlineFeatures:i}=o;return t.points.data=l,t.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),t.points.getPosition=Wt,t.lines.data=s,t.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),t.lines.getPath=Wt,t.polygons.data=n,t.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),t.polygons.getPolygon=Wt,t.polygonsOutline.data=i,t.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),t.polygonsOutline.getPath=Wt,t}function _r(o,e){const t=Ve(),{points:l,lines:s,polygons:n}=o,i=fr(o,e);return t.points.data={length:l.positions.value.length/l.positions.size,attributes:{...l.attributes,getPosition:l.positions,instancePickingColors:{size:3,value:i.points}},properties:l.properties,numericProps:l.numericProps,featureIds:l.featureIds},t.lines.data={length:s.pathIndices.value.length-1,startIndices:s.pathIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:i.lines}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},t.lines._pathType="open",t.polygons.data={length:n.polygonIndices.value.length-1,startIndices:n.polygonIndices.value,attributes:{...n.attributes,getPolygon:n.positions,pickingColors:{size:3,value:i.polygons}},properties:n.properties,numericProps:n.numericProps,featureIds:n.featureIds},t.polygons._normalize=!1,n.triangles&&(t.polygons.data.attributes.indices=n.triangles.value),t.polygonsOutline.data={length:n.primitivePolygonIndices.value.length-1,startIndices:n.primitivePolygonIndices.value,attributes:{...n.attributes,getPath:n.positions,instancePickingColors:{size:3,value:i.polygons}},properties:n.properties,numericProps:n.numericProps,featureIds:n.featureIds},t.polygonsOutline._pathType="open",t}const vr=["points","linestrings","polygons"],br={...St(Gt.circle),...St(Gt.icon),...St(Gt.text),...St(Ht),...St(he),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:o=>o.properties.icon},getText:{type:"accessor",value:o=>o.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class fe extends xn{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:t}){if(!t.dataChanged)return;const{data:l}=this.props,s=l&&"points"in l&&"polygons"in l&&"lines"in l;this.setState({binary:s}),s?this._updateStateBinary({props:e,changeFlags:t}):this._updateStateJSON({props:e,changeFlags:t})}_updateStateBinary({props:e,changeFlags:t}){const l=_r(e.data,this.encodePickingColor);this.setState({layerProps:l})}_updateStateJSON({props:e,changeFlags:t}){const l=pr(e.data),s=this.getSubLayerRow.bind(this);let n={};const i={};if(Array.isArray(t.dataChanged)){const u=this.state.features;for(const f in u)n[f]=u[f].slice(),i[f]=[];for(const f of t.dataChanged){const v=Se(l,s,f);for(const g in u)i[g].push(hr({data:n[g],getIndex:y=>y.__source.index,dataRange:f,replace:v[g]}))}}else n=Se(l,s);const r=yr(n,i);this.setState({features:n,featuresDiff:i,layerProps:r})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:l,sourceLayer:s}=t;return t.featureType=vr.find(n=>s.id.startsWith("".concat(this.id,"-").concat(n,"-"))),l>=0&&s.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[l]),t}_updateAutoHighlight(e){const t="".concat(this.id,"-points-"),l=e.featureType==="points";for(const s of this.getSubLayers())s.id.startsWith(t)===l&&s.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:t}=this.props,{layerProps:l}=this.state,s="polygons-fill",n=this.shouldRenderSubLayer(s,l.polygons.data)&&this.getSubLayerClass(s,he.type);if(n){const i=se(this,he.props),r=e&&t;return r||delete i.getLineColor,i.updateTriggers.lineColors=r,new n(i,this.getSubLayerProps({id:s,updateTriggers:i.updateTriggers}),l.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:t}=this.props,{layerProps:l}=this.state,s="polygons-stroke",n="linestrings",i=!e&&t&&this.shouldRenderSubLayer(s,l.polygonsOutline.data)&&this.getSubLayerClass(s,Ht.type),r=this.shouldRenderSubLayer(n,l.lines.data)&&this.getSubLayerClass(n,Ht.type);if(i||r){const u=se(this,Ht.props);return[i&&new i(u,this.getSubLayerProps({id:s,updateTriggers:u.updateTriggers}),l.polygonsOutline),r&&new r(u,this.getSubLayerProps({id:n,updateTriggers:u.updateTriggers}),l.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:l}=this.state;let{highlightedObjectIndex:s}=this.props;!l&&Number.isFinite(s)&&(s=t.points.data.findIndex(r=>r.__source.index===s));const n=new Set(e.split("+")),i=[];for(const r of n){const u="points-".concat(r),f=Gt[r],v=f&&this.shouldRenderSubLayer(u,t.points.data)&&this.getSubLayerClass(u,f.type);if(v){const g=se(this,f.props);let y=t.points;if(r==="text"&&l){const{instancePickingColors:c,...m}=y.data.attributes;y={...y,data:{...y.data,attributes:m}}}i.push(new v(g,this.getSubLayerProps({id:u,updateTriggers:g.updateTriggers,highlightedObjectIndex:s}),y))}}return i}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer(),l=this._renderLineLayers(),s=this._renderPointLayers();return[!e&&t,l,s,e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return!t||typeof e!="function"?super.getSubLayerAccessor(e):(l,s)=>{const{data:n,index:i}=s,r=cr(n,i);return e(r,s)}}}Tt(fe,"layerName","GeoJsonLayer");Tt(fe,"defaultProps",br);var Qt={},pe={};pe.geometries={NULL:0,POINT:1,POLYLINE:3,POLYGON:5,MULTIPOINT:8,POINTZ:11,POLYLINEZ:13,POLYGONZ:15,MULTIPOINTZ:18,POINTM:21,POLYLINEM:23,POLYGONM:25,MULTIPOINTM:28,MULTIPATCH:31};var Ye={},wr={C:254,L:1,D:8,N:18,M:18,F:18,B:8},Jt={};Jt.lpad=function(e,t,l){for(;e.length<t;)e=l+e;return e};Jt.rpad=function(e,t,l){for(;e.length<t;)e=e+l;return e};Jt.writeField=function(e,t,l,s){for(var n=0;n<t;n++)e.setUint8(s,l.charCodeAt(n)),s++;return s};var qt={},xr=wr,kr={string:"C",number:"N",boolean:"L",null:"C"};qt.multi=Cr;qt.bytesPer=Ar;qt.obj=Xe;function Cr(o){var e={};o.forEach(t);function t(l){Sr(e,l)}return Xe(e)}function Sr(o,e){for(var t in e){var l=typeof e[t]<"u"&&e[t]!==null;(typeof o[t]>"u"||l)&&(o[t]=e[t])}return o}function Xe(o){var e={},t=[];for(var l in o)e[l]=o[l]===null?"null":typeof o[l];for(var s in e){var n=kr[e[s]];n&&t.push({name:s,type:n,size:xr[n]})}return t}function Ar(o){return o.reduce(function(e,t){return e+t.size},1)}var _t=Jt,Le=qt,Lr=function(e,t){var l=t||Le.multi(e),s=32*l.length+1,n=Le.bytesPer(l),i=new ArrayBuffer(s+32+n*e.length+1),r=new Date,u=new DataView(i);u.setUint8(0,3),u.setUint8(1,r.getFullYear()-1900),u.setUint8(2,r.getMonth()),u.setUint8(3,r.getDate()),u.setUint32(4,e.length,!0);var f=s+32;u.setUint16(8,f,!0),u.setUint16(10,n,!0),u.setInt8(32+s-1,13),l.forEach(function(g,y){g.name.split("").slice(0,8).forEach(function(c,m){u.setInt8(32+y*32+m,c.charCodeAt(0))}),u.setInt8(32+y*32+11,g.type.charCodeAt(0)),u.setInt8(32+y*32+16,g.size),g.type=="N"&&u.setInt8(32+y*32+17,3)});var v=s+32;return e.forEach(function(g,y){u.setUint8(v,32),v++,l.forEach(function(c){var m=g[c.name];switch((m===null||typeof m>"u")&&(m=""),c.type){case"L":u.setUint8(v,m?84:70),v++;break;case"D":v=_t.writeField(u,8,_t.lpad(m.toString(),8," "),v);break;case"N":v=_t.writeField(u,c.size,_t.lpad(m.toString(),c.size," ").substr(0,18),v);break;case"C":v=_t.writeField(u,c.size,_t.rpad(m.toString(),c.size," "),v);break;default:throw new Error("Unknown field type")}})}),u.setUint8(v,26),u};Ye.structure=Lr;var Qe='GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]]',Ot={};Ot.enlarge=function(e,t){return t[0]<e.xmin&&(e.xmin=t[0]),t[0]>e.xmax&&(e.xmax=t[0]),t[1]<e.ymin&&(e.ymin=t[1]),t[1]>e.ymax&&(e.ymax=t[1]),e};Ot.enlargeExtent=function(e,t){return t.xmax>e.xmax&&(e.xmax=t.xmax),t.xmin<e.xmin&&(e.xmin=t.xmin),t.ymax>e.ymax&&(e.ymax=t.ymax),t.ymin<e.ymin&&(e.ymin=t.ymin),e};Ot.blank=function(){return{xmin:Number.MAX_VALUE,ymin:Number.MAX_VALUE,xmax:-Number.MAX_VALUE,ymax:-Number.MAX_VALUE}};var bt={},Ie=Ot;bt.write=function(e,t,l,s){var n=28,i=100,r=0,u=0;e.forEach(function(v,g){l.setInt32(r,g),l.setInt32(r+4,10),l.setInt32(r+8,1,!0),l.setFloat64(r+12,v[0],!0),l.setFloat64(r+20,v[1],!0),s.setInt32(u,i/2),s.setInt32(u+4,10),u+=8,r+=n,i+=n})};bt.extent=function(o){return o.reduce(function(e,t){return Ie.enlarge(e,t)},Ie.blank())};bt.parts=function(e,t){return e.length};bt.shxLength=function(o){return o.length*8};bt.shpLength=function(o){return o.length*28};var wt={},Vt=Ot,Pe=pe;wt.write=function(e,t,l,s,n){var i=0,r=0,u=100;e.forEach(f);function f(v,g){var y=$t(v),c=Je([v],n),m=y.length*16+48+(c-1)*4,d=y.reduce(function(x,k){return Vt.enlarge(x,k)},Vt.blank());s.setInt32(r,u/2),s.setInt32(r+4,m/2),r+=8,u+=m+8,l.setInt32(i,g+1),l.setInt32(i+4,m/2),l.setInt32(i+8,n,!0),l.setFloat64(i+12,d.xmin,!0),l.setFloat64(i+20,d.ymin,!0),l.setFloat64(i+28,d.xmax,!0),l.setFloat64(i+36,d.ymax,!0),l.setInt32(i+44,c,!0),l.setInt32(i+48,y.length,!0),l.setInt32(i+52,0,!0);for(var b=v.reduce(function(x,k){return Array.isArray(k[0][0])?x=x.concat(k):x.push(k),x},[]),p=1;p<c;p++)l.setInt32(i+52+p*4,b.reduce(function(x,k,S){return S<p?x+k.length:x},0),!0);y.forEach(function(k,S){l.setFloat64(i+56+S*16+(c-1)*4,k[0],!0),l.setFloat64(i+56+S*16+(c-1)*4+8,k[1],!0)}),i+=m+8}};wt.shpLength=function(o){return o.length*56+$t(o).length*16};wt.shxLength=function(o){return o.length*8};wt.extent=function(o){return $t(o).reduce(function(e,t){return Vt.enlarge(e,t)},Vt.blank())};function Je(o,e){var t=1;return(e===Pe.geometries.POLYGON||e===Pe.geometries.POLYLINE)&&(t=o.reduce(function(l,s){return l+=s.length,Array.isArray(s[0][0][0])&&(l+=s.reduce(function(n,i){return n+i.length-1},0)),l},0)),t}wt.parts=Je;function $t(o,e){return e===void 0&&(e=[]),typeof o[0][0]=="object"?o.reduce(function(t,l){return t.concat($t(l))},e):o}var Ir=pe,Pr=Ye,Er=Qe,zr=bt,Ee=wt,Tr={1:zr,5:Ee,3:Ee},qe=Or;function Or(o,e,t,l){var s=Ir.geometries[e],n=Tr[s],i=n.parts(t,s),r=100+(i-t.length)*4+n.shpLength(t),u=100+n.shxLength(t),f=new ArrayBuffer(r),v=new DataView(f),g=new ArrayBuffer(u),y=new DataView(g),c=n.extent(t);ze(v,s),ze(y,s),Te(c,v),Te(c,y),n.write(t,c,new DataView(f,100),new DataView(g,100),s),v.setInt32(24,r/2),y.setInt32(24,50+t.length*4);var m=Pr.structure(o);l(null,{shp:v,shx:y,dbf:m,prj:Er})}function ze(o,e){o.setInt32(0,9994),o.setInt32(28,1e3,!0),o.setInt32(32,e,!0)}function Te(o,e){e.setFloat64(36,o.xmin,!0),e.setFloat64(44,o.ymin,!0),e.setFloat64(52,o.xmax,!0),e.setFloat64(60,o.ymax,!0)}var te={};te.point=ge("Point","POINT");te.line=ge("LineString","POLYLINE");te.polygon=ge("Polygon","POLYGON");function ge(o,e){return function(t){var l=t.features.filter(Rr(o));return{geometries:e==="POLYGON"||e==="POLYLINE"?[l.map(Oe)]:l.map(Oe),properties:l.map(Dr),type:e}}}function Oe(o){return o.geometry.coordinates[0]!==void 0&&o.geometry.coordinates[0][0]!==void 0&&o.geometry.coordinates[0][0][0]!==void 0?o.geometry.coordinates[0]:o.geometry.coordinates}function Dr(o){return o.properties}function Rr(o){return function(e){return e.geometry.type===o}}function jt(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var $e={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(o,e){(function(t){o.exports=t()})(function(){return function t(l,s,n){function i(f,v){if(!s[f]){if(!l[f]){var g=typeof jt=="function"&&jt;if(!v&&g)return g(f,!0);if(r)return r(f,!0);var y=new Error("Cannot find module '"+f+"'");throw y.code="MODULE_NOT_FOUND",y}var c=s[f]={exports:{}};l[f][0].call(c.exports,function(m){var d=l[f][1][m];return i(d||m)},c,c.exports,t,l,s,n)}return s[f].exports}for(var r=typeof jt=="function"&&jt,u=0;u<n.length;u++)i(n[u]);return i}({1:[function(t,l,s){var n=t("./utils"),i=t("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(u){for(var f,v,g,y,c,m,d,b=[],p=0,x=u.length,k=x,S=n.getTypeOf(u)!=="string";p<u.length;)k=x-p,g=S?(f=u[p++],v=p<x?u[p++]:0,p<x?u[p++]:0):(f=u.charCodeAt(p++),v=p<x?u.charCodeAt(p++):0,p<x?u.charCodeAt(p++):0),y=f>>2,c=(3&f)<<4|v>>4,m=1<k?(15&v)<<2|g>>6:64,d=2<k?63&g:64,b.push(r.charAt(y)+r.charAt(c)+r.charAt(m)+r.charAt(d));return b.join("")},s.decode=function(u){var f,v,g,y,c,m,d=0,b=0,p="data:";if(u.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var x,k=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===r.charAt(64)&&k--,u.charAt(u.length-2)===r.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=i.uint8array?new Uint8Array(0|k):new Array(0|k);d<u.length;)f=r.indexOf(u.charAt(d++))<<2|(y=r.indexOf(u.charAt(d++)))>>4,v=(15&y)<<4|(c=r.indexOf(u.charAt(d++)))>>2,g=(3&c)<<6|(m=r.indexOf(u.charAt(d++))),x[b++]=f,c!==64&&(x[b++]=v),m!==64&&(x[b++]=g);return x}},{"./support":30,"./utils":32}],2:[function(t,l,s){var n=t("./external"),i=t("./stream/DataWorker"),r=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function f(v,g,y,c,m){this.compressedSize=v,this.uncompressedSize=g,this.crc32=y,this.compression=c,this.compressedContent=m}f.prototype={getContentWorker:function(){var v=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),g=this;return v.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(v,g,y){return v.pipe(new r).pipe(new u("uncompressedSize")).pipe(g.compressWorker(y)).pipe(new u("compressedSize")).withStreamInfo("compression",g)},l.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,l,s){var n=t("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},s.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,l,s){var n=t("./utils"),i=function(){for(var r,u=[],f=0;f<256;f++){r=f;for(var v=0;v<8;v++)r=1&r?3988292384^r>>>1:r>>>1;u[f]=r}return u}();l.exports=function(r,u){return r!==void 0&&r.length?n.getTypeOf(r)!=="string"?function(f,v,g,y){var c=i,m=y+g;f^=-1;for(var d=y;d<m;d++)f=f>>>8^c[255&(f^v[d])];return-1^f}(0|u,r,r.length,0):function(f,v,g,y){var c=i,m=y+g;f^=-1;for(var d=y;d<m;d++)f=f>>>8^c[255&(f^v.charCodeAt(d))];return-1^f}(0|u,r,r.length,0):0}},{"./utils":32}],5:[function(t,l,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(t,l,s){var n=null;n=typeof Promise<"u"?Promise:t("lie"),l.exports={Promise:n}},{lie:37}],7:[function(t,l,s){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=t("pako"),r=t("./utils"),u=t("./stream/GenericWorker"),f=n?"uint8array":"array";function v(g,y){u.call(this,"FlateWorker/"+g),this._pako=null,this._pakoAction=g,this._pakoOptions=y,this.meta={}}s.magic="\b\0",r.inherits(v,u),v.prototype.processChunk=function(g){this.meta=g.meta,this._pako===null&&this._createPako(),this._pako.push(r.transformTo(f,g.data),!1)},v.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var g=this;this._pako.onData=function(y){g.push({data:y,meta:g.meta})}},s.compressWorker=function(g){return new v("Deflate",g)},s.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,l,s){function n(c,m){var d,b="";for(d=0;d<m;d++)b+=String.fromCharCode(255&c),c>>>=8;return b}function i(c,m,d,b,p,x){var k,S,L=c.file,B=c.compression,O=x!==f.utf8encode,W=r.transformTo("string",x(L.name)),T=r.transformTo("string",f.utf8encode(L.name)),H=L.comment,J=r.transformTo("string",x(H)),C=r.transformTo("string",f.utf8encode(H)),D=T.length!==L.name.length,h=C.length!==H.length,F="",$="",U="",tt=L.dir,j=L.date,q={crc32:0,compressedSize:0,uncompressedSize:0};m&&!d||(q.crc32=c.crc32,q.compressedSize=c.compressedSize,q.uncompressedSize=c.uncompressedSize);var E=0;m&&(E|=8),O||!D&&!h||(E|=2048);var P=0,Q=0;tt&&(P|=16),p==="UNIX"?(Q=798,P|=function(K,ot){var ht=K;return K||(ht=ot?16893:33204),(65535&ht)<<16}(L.unixPermissions,tt)):(Q=20,P|=function(K){return 63&(K||0)}(L.dosPermissions)),k=j.getUTCHours(),k<<=6,k|=j.getUTCMinutes(),k<<=5,k|=j.getUTCSeconds()/2,S=j.getUTCFullYear()-1980,S<<=4,S|=j.getUTCMonth()+1,S<<=5,S|=j.getUTCDate(),D&&($=n(1,1)+n(v(W),4)+T,F+="up"+n($.length,2)+$),h&&(U=n(1,1)+n(v(J),4)+C,F+="uc"+n(U.length,2)+U);var V="";return V+=`
\0`,V+=n(E,2),V+=B.magic,V+=n(k,2),V+=n(S,2),V+=n(q.crc32,4),V+=n(q.compressedSize,4),V+=n(q.uncompressedSize,4),V+=n(W.length,2),V+=n(F.length,2),{fileRecord:g.LOCAL_FILE_HEADER+V+W+F,dirRecord:g.CENTRAL_FILE_HEADER+n(Q,2)+V+n(J.length,2)+"\0\0\0\0"+n(P,4)+n(b,4)+W+F+J}}var r=t("../utils"),u=t("../stream/GenericWorker"),f=t("../utf8"),v=t("../crc32"),g=t("../signature");function y(c,m,d,b){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=d,this.encodeFileName=b,this.streamFiles=c,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(y,u),y.prototype.push=function(c){var m=c.meta.percent||0,d=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(c):(this.bytesWritten+=c.data.length,u.prototype.push.call(this,{data:c.data,meta:{currentFile:this.currentFile,percent:d?(m+100*(d-b-1))/d:100}}))},y.prototype.openedSource=function(c){this.currentSourceOffset=this.bytesWritten,this.currentFile=c.file.name;var m=this.streamFiles&&!c.file.dir;if(m){var d=i(c,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(c){this.accumulate=!1;var m=this.streamFiles&&!c.file.dir,d=i(c,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),m)this.push({data:function(b){return g.DATA_DESCRIPTOR+n(b.crc32,4)+n(b.compressedSize,4)+n(b.uncompressedSize,4)}(c),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var c=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var d=this.bytesWritten-c,b=function(p,x,k,S,L){var B=r.transformTo("string",L(S));return g.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(p,2)+n(p,2)+n(x,4)+n(k,4)+n(B.length,2)+B}(this.dirRecords.length,d,c,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(c){this._sources.push(c);var m=this;return c.on("data",function(d){m.processChunk(d)}),c.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),c.on("error",function(d){m.error(d)}),this},y.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(c){var m=this._sources;if(!u.prototype.error.call(this,c))return!1;for(var d=0;d<m.length;d++)try{m[d].error(c)}catch{}return!0},y.prototype.lock=function(){u.prototype.lock.call(this);for(var c=this._sources,m=0;m<c.length;m++)c[m].lock()},l.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,l,s){var n=t("../compressions"),i=t("./ZipFileWorker");s.generateWorker=function(r,u,f){var v=new i(u.streamFiles,f,u.platform,u.encodeFileName),g=0;try{r.forEach(function(y,c){g++;var m=function(x,k){var S=x||k,L=n[S];if(!L)throw new Error(S+" is not a valid compression method !");return L}(c.options.compression,u.compression),d=c.options.compressionOptions||u.compressionOptions||{},b=c.dir,p=c.date;c._compressWorker(m,d).withStreamInfo("file",{name:y,dir:b,date:p,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(v)}),v.entriesCount=g}catch(y){v.error(y)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,l,s){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var i=new n;for(var r in this)typeof this[r]!="function"&&(i[r]=this[r]);return i}}(n.prototype=t("./object")).loadAsync=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.version="3.10.1",n.loadAsync=function(i,r){return new n().loadAsync(i,r)},n.external=t("./external"),l.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,l,s){var n=t("./utils"),i=t("./external"),r=t("./utf8"),u=t("./zipEntries"),f=t("./stream/Crc32Probe"),v=t("./nodejsUtils");function g(y){return new i.Promise(function(c,m){var d=y.decompressed.getContentWorker().pipe(new f);d.on("error",function(b){m(b)}).on("end",function(){d.streamInfo.crc32!==y.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):c()}).resume()})}l.exports=function(y,c){var m=this;return c=n.extend(c||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),v.isNode&&v.isStream(y)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",y,!0,c.optimizedBinaryString,c.base64).then(function(d){var b=new u(c);return b.load(d),b}).then(function(d){var b=[i.Promise.resolve(d)],p=d.files;if(c.checkCRC32)for(var x=0;x<p.length;x++)b.push(g(p[x]));return i.Promise.all(b)}).then(function(d){for(var b=d.shift(),p=b.files,x=0;x<p.length;x++){var k=p[x],S=k.fileNameStr,L=n.resolve(k.fileNameStr);m.file(L,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:c.createFolders}),k.dir||(m.file(L).unsafeOriginalName=S)}return b.zipComment.length&&(m.comment=b.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,l,s){var n=t("../utils"),i=t("../stream/GenericWorker");function r(u,f){i.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(f)}n.inherits(r,i),r.prototype._bindStream=function(u){var f=this;(this._stream=u).pause(),u.on("data",function(v){f.push({data:v,meta:{percent:0}})}).on("error",function(v){f.isPaused?this.generatedError=v:f.error(v)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},r.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},l.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,l,s){var n=t("readable-stream").Readable;function i(r,u,f){n.call(this,u),this._helper=r;var v=this;r.on("data",function(g,y){v.push(g)||v._helper.pause(),f&&f(y)}).on("error",function(g){v.emit("error",g)}).on("end",function(){v.push(null)})}t("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},l.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,l,s){l.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,i);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,i)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var i=new Buffer(n);return i.fill(0),i},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(t,l,s){function n(L,B,O){var W,T=r.getTypeOf(B),H=r.extend(O||{},v);H.date=H.date||new Date,H.compression!==null&&(H.compression=H.compression.toUpperCase()),typeof H.unixPermissions=="string"&&(H.unixPermissions=parseInt(H.unixPermissions,8)),H.unixPermissions&&16384&H.unixPermissions&&(H.dir=!0),H.dosPermissions&&16&H.dosPermissions&&(H.dir=!0),H.dir&&(L=p(L)),H.createFolders&&(W=b(L))&&x.call(this,W,!0);var J=T==="string"&&H.binary===!1&&H.base64===!1;O&&O.binary!==void 0||(H.binary=!J),(B instanceof g&&B.uncompressedSize===0||H.dir||!B||B.length===0)&&(H.base64=!1,H.binary=!0,B="",H.compression="STORE",T="string");var C=null;C=B instanceof g||B instanceof u?B:m.isNode&&m.isStream(B)?new d(L,B):r.prepareContent(L,B,H.binary,H.optimizedBinaryString,H.base64);var D=new y(L,C,H);this.files[L]=D}var i=t("./utf8"),r=t("./utils"),u=t("./stream/GenericWorker"),f=t("./stream/StreamHelper"),v=t("./defaults"),g=t("./compressedObject"),y=t("./zipObject"),c=t("./generate"),m=t("./nodejsUtils"),d=t("./nodejs/NodejsStreamInputAdapter"),b=function(L){L.slice(-1)==="/"&&(L=L.substring(0,L.length-1));var B=L.lastIndexOf("/");return 0<B?L.substring(0,B):""},p=function(L){return L.slice(-1)!=="/"&&(L+="/"),L},x=function(L,B){return B=B!==void 0?B:v.createFolders,L=p(L),this.files[L]||n.call(this,L,null,{dir:!0,createFolders:B}),this.files[L]};function k(L){return Object.prototype.toString.call(L)==="[object RegExp]"}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(L){var B,O,W;for(B in this.files)W=this.files[B],(O=B.slice(this.root.length,B.length))&&B.slice(0,this.root.length)===this.root&&L(O,W)},filter:function(L){var B=[];return this.forEach(function(O,W){L(O,W)&&B.push(W)}),B},file:function(L,B,O){if(arguments.length!==1)return L=this.root+L,n.call(this,L,B,O),this;if(k(L)){var W=L;return this.filter(function(H,J){return!J.dir&&W.test(H)})}var T=this.files[this.root+L];return T&&!T.dir?T:null},folder:function(L){if(!L)return this;if(k(L))return this.filter(function(T,H){return H.dir&&L.test(T)});var B=this.root+L,O=x.call(this,B),W=this.clone();return W.root=O.name,W},remove:function(L){L=this.root+L;var B=this.files[L];if(B||(L.slice(-1)!=="/"&&(L+="/"),B=this.files[L]),B&&!B.dir)delete this.files[L];else for(var O=this.filter(function(T,H){return H.name.slice(0,L.length)===L}),W=0;W<O.length;W++)delete this.files[O[W].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(L){var B,O={};try{if((O=r.extend(L||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=O.type.toLowerCase(),O.compression=O.compression.toUpperCase(),O.type==="binarystring"&&(O.type="string"),!O.type)throw new Error("No output type specified.");r.checkSupport(O.type),O.platform!=="darwin"&&O.platform!=="freebsd"&&O.platform!=="linux"&&O.platform!=="sunos"||(O.platform="UNIX"),O.platform==="win32"&&(O.platform="DOS");var W=O.comment||this.comment||"";B=c.generateWorker(this,O,W)}catch(T){(B=new u("error")).error(T)}return new f(B,O.type||"string",O.mimeType)},generateAsync:function(L,B){return this.generateInternalStream(L).accumulate(B)},generateNodeStream:function(L,B){return(L=L||{}).type||(L.type="nodebuffer"),this.generateInternalStream(L).toNodejsStream(B)}};l.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,l,s){l.exports=t("stream")},{stream:void 0}],17:[function(t,l,s){var n=t("./DataReader");function i(r){n.call(this,r);for(var u=0;u<this.data.length;u++)r[u]=255&r[u]}t("../utils").inherits(i,n),i.prototype.byteAt=function(r){return this.data[this.zero+r]},i.prototype.lastIndexOfSignature=function(r){for(var u=r.charCodeAt(0),f=r.charCodeAt(1),v=r.charCodeAt(2),g=r.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===u&&this.data[y+1]===f&&this.data[y+2]===v&&this.data[y+3]===g)return y-this.zero;return-1},i.prototype.readAndCheckSignature=function(r){var u=r.charCodeAt(0),f=r.charCodeAt(1),v=r.charCodeAt(2),g=r.charCodeAt(3),y=this.readData(4);return u===y[0]&&f===y[1]&&v===y[2]&&g===y[3]},i.prototype.readData=function(r){if(this.checkOffset(r),r===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,u},l.exports=i},{"../utils":32,"./DataReader":18}],18:[function(t,l,s){var n=t("../utils");function i(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(){},readInt:function(r){var u,f=0;for(this.checkOffset(r),u=this.index+r-1;u>=this.index;u--)f=(f<<8)+this.byteAt(u);return this.index+=r,f},readString:function(r){return n.transformTo("string",this.readData(r))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC(1980+(r>>25&127),(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(31&r)<<1))}},l.exports=i},{"../utils":32}],19:[function(t,l,s){var n=t("./Uint8ArrayReader");function i(r){n.call(this,r)}t("../utils").inherits(i,n),i.prototype.readData=function(r){this.checkOffset(r);var u=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,u},l.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,l,s){var n=t("./DataReader");function i(r){n.call(this,r)}t("../utils").inherits(i,n),i.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},i.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},i.prototype.readAndCheckSignature=function(r){return r===this.readData(4)},i.prototype.readData=function(r){this.checkOffset(r);var u=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,u},l.exports=i},{"../utils":32,"./DataReader":18}],21:[function(t,l,s){var n=t("./ArrayReader");function i(r){n.call(this,r)}t("../utils").inherits(i,n),i.prototype.readData=function(r){if(this.checkOffset(r),r===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,u},l.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(t,l,s){var n=t("../utils"),i=t("../support"),r=t("./ArrayReader"),u=t("./StringReader"),f=t("./NodeBufferReader"),v=t("./Uint8ArrayReader");l.exports=function(g){var y=n.getTypeOf(g);return n.checkSupport(y),y!=="string"||i.uint8array?y==="nodebuffer"?new f(g):i.uint8array?new v(n.transformTo("uint8array",g)):new r(n.transformTo("array",g)):new u(g)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,l,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,l,s){var n=t("./GenericWorker"),i=t("../utils");function r(u){n.call(this,"ConvertWorker to "+u),this.destType=u}i.inherits(r,n),r.prototype.processChunk=function(u){this.push({data:i.transformTo(this.destType,u.data),meta:u.meta})},l.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(t,l,s){var n=t("./GenericWorker"),i=t("../crc32");function r(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(r,n),r.prototype.processChunk=function(u){this.streamInfo.crc32=i(u.data,this.streamInfo.crc32||0),this.push(u)},l.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,l,s){var n=t("../utils"),i=t("./GenericWorker");function r(u){i.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}n.inherits(r,i),r.prototype.processChunk=function(u){if(u){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+u.data.length}i.prototype.processChunk.call(this,u)},l.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(t,l,s){var n=t("../utils"),i=t("./GenericWorker");function r(u){i.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(v){f.dataIsReady=!0,f.data=v,f.max=v&&v.length||0,f.type=n.getTypeOf(v),f.isPaused||f._tickAndRepeat()},function(v){f.error(v)})}n.inherits(r,i),r.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,f);break;case"uint8array":u=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":u=this.data.slice(this.index,f)}return this.index=f,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},l.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(t,l,s){function n(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,r){return this._listeners[i].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,r){if(this._listeners[i])for(var u=0;u<this._listeners[i].length;u++)this._listeners[i][u].call(this,r)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var r=this;return i.on("data",function(u){r.processChunk(u)}),i.on("end",function(){r.end()}),i.on("error",function(u){r.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var i=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,r){return this.extraStreamInfo[i]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},l.exports=n},{}],29:[function(t,l,s){var n=t("../utils"),i=t("./ConvertWorker"),r=t("./GenericWorker"),u=t("../base64"),f=t("../support"),v=t("../external"),g=null;if(f.nodestream)try{g=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(m,d){return new v.Promise(function(b,p){var x=[],k=m._internalType,S=m._outputType,L=m._mimeType;m.on("data",function(B,O){x.push(B),d&&d(O)}).on("error",function(B){x=[],p(B)}).on("end",function(){try{var B=function(O,W,T){switch(O){case"blob":return n.newBlob(n.transformTo("arraybuffer",W),T);case"base64":return u.encode(W);default:return n.transformTo(O,W)}}(S,function(O,W){var T,H=0,J=null,C=0;for(T=0;T<W.length;T++)C+=W[T].length;switch(O){case"string":return W.join("");case"array":return Array.prototype.concat.apply([],W);case"uint8array":for(J=new Uint8Array(C),T=0;T<W.length;T++)J.set(W[T],H),H+=W[T].length;return J;case"nodebuffer":return Buffer.concat(W);default:throw new Error("concat : unsupported type '"+O+"'")}}(k,x),L);b(B)}catch(O){p(O)}x=[]}).resume()})}function c(m,d,b){var p=d;switch(d){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=d,this._mimeType=b,n.checkSupport(p),this._worker=m.pipe(new i(p)),m.lock()}catch(x){this._worker=new r("error"),this._worker.error(x)}}c.prototype={accumulate:function(m){return y(this,m)},on:function(m,d){var b=this;return m==="data"?this._worker.on(m,function(p){d.call(b,p.data,p.meta)}):this._worker.on(m,function(){n.delay(d,arguments,b)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new g(this,{objectMode:this._outputType!=="nodebuffer"},m)}},l.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,l,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var n=new ArrayBuffer(0);try{s.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),s.blob=i.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!t("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(t,l,s){for(var n=t("./utils"),i=t("./support"),r=t("./nodejsUtils"),u=t("./stream/GenericWorker"),f=new Array(256),v=0;v<256;v++)f[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;f[254]=f[254]=1;function g(){u.call(this,"utf-8 decode"),this.leftOver=null}function y(){u.call(this,"utf-8 encode")}s.utf8encode=function(c){return i.nodebuffer?r.newBufferFrom(c,"utf-8"):function(m){var d,b,p,x,k,S=m.length,L=0;for(x=0;x<S;x++)(64512&(b=m.charCodeAt(x)))==55296&&x+1<S&&(64512&(p=m.charCodeAt(x+1)))==56320&&(b=65536+(b-55296<<10)+(p-56320),x++),L+=b<128?1:b<2048?2:b<65536?3:4;for(d=i.uint8array?new Uint8Array(L):new Array(L),x=k=0;k<L;x++)(64512&(b=m.charCodeAt(x)))==55296&&x+1<S&&(64512&(p=m.charCodeAt(x+1)))==56320&&(b=65536+(b-55296<<10)+(p-56320),x++),b<128?d[k++]=b:(b<2048?d[k++]=192|b>>>6:(b<65536?d[k++]=224|b>>>12:(d[k++]=240|b>>>18,d[k++]=128|b>>>12&63),d[k++]=128|b>>>6&63),d[k++]=128|63&b);return d}(c)},s.utf8decode=function(c){return i.nodebuffer?n.transformTo("nodebuffer",c).toString("utf-8"):function(m){var d,b,p,x,k=m.length,S=new Array(2*k);for(d=b=0;d<k;)if((p=m[d++])<128)S[b++]=p;else if(4<(x=f[p]))S[b++]=65533,d+=x-1;else{for(p&=x===2?31:x===3?15:7;1<x&&d<k;)p=p<<6|63&m[d++],x--;1<x?S[b++]=65533:p<65536?S[b++]=p:(p-=65536,S[b++]=55296|p>>10&1023,S[b++]=56320|1023&p)}return S.length!==b&&(S.subarray?S=S.subarray(0,b):S.length=b),n.applyFromCharCode(S)}(c=n.transformTo(i.uint8array?"uint8array":"array",c))},n.inherits(g,u),g.prototype.processChunk=function(c){var m=n.transformTo(i.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var d=m;(m=new Uint8Array(d.length+this.leftOver.length)).set(this.leftOver,0),m.set(d,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var b=function(x,k){var S;for((k=k||x.length)>x.length&&(k=x.length),S=k-1;0<=S&&(192&x[S])==128;)S--;return S<0||S===0?k:S+f[x[S]]>k?S:k}(m),p=m;b!==m.length&&(i.uint8array?(p=m.subarray(0,b),this.leftOver=m.subarray(b,m.length)):(p=m.slice(0,b),this.leftOver=m.slice(b,m.length))),this.push({data:s.utf8decode(p),meta:c.meta})},g.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=g,n.inherits(y,u),y.prototype.processChunk=function(c){this.push({data:s.utf8encode(c.data),meta:c.meta})},s.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,l,s){var n=t("./support"),i=t("./base64"),r=t("./nodejsUtils"),u=t("./external");function f(d){return d}function v(d,b){for(var p=0;p<d.length;++p)b[p]=255&d.charCodeAt(p);return b}t("setimmediate"),s.newBlob=function(d,b){s.checkSupport("blob");try{return new Blob([d],{type:b})}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(d),p.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var g={stringifyByChunk:function(d,b,p){var x=[],k=0,S=d.length;if(S<=p)return String.fromCharCode.apply(null,d);for(;k<S;)b==="array"||b==="nodebuffer"?x.push(String.fromCharCode.apply(null,d.slice(k,Math.min(k+p,S)))):x.push(String.fromCharCode.apply(null,d.subarray(k,Math.min(k+p,S)))),k+=p;return x.join("")},stringifyByChar:function(d){for(var b="",p=0;p<d.length;p++)b+=String.fromCharCode(d[p]);return b},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,r.allocBuffer(1)).length===1}catch{return!1}}()}};function y(d){var b=65536,p=s.getTypeOf(d),x=!0;if(p==="uint8array"?x=g.applyCanBeUsed.uint8array:p==="nodebuffer"&&(x=g.applyCanBeUsed.nodebuffer),x)for(;1<b;)try{return g.stringifyByChunk(d,p,b)}catch{b=Math.floor(b/2)}return g.stringifyByChar(d)}function c(d,b){for(var p=0;p<d.length;p++)b[p]=d[p];return b}s.applyFromCharCode=y;var m={};m.string={string:f,array:function(d){return v(d,new Array(d.length))},arraybuffer:function(d){return m.string.uint8array(d).buffer},uint8array:function(d){return v(d,new Uint8Array(d.length))},nodebuffer:function(d){return v(d,r.allocBuffer(d.length))}},m.array={string:y,array:f,arraybuffer:function(d){return new Uint8Array(d).buffer},uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return r.newBufferFrom(d)}},m.arraybuffer={string:function(d){return y(new Uint8Array(d))},array:function(d){return c(new Uint8Array(d),new Array(d.byteLength))},arraybuffer:f,uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return r.newBufferFrom(new Uint8Array(d))}},m.uint8array={string:y,array:function(d){return c(d,new Array(d.length))},arraybuffer:function(d){return d.buffer},uint8array:f,nodebuffer:function(d){return r.newBufferFrom(d)}},m.nodebuffer={string:y,array:function(d){return c(d,new Array(d.length))},arraybuffer:function(d){return m.nodebuffer.uint8array(d).buffer},uint8array:function(d){return c(d,new Uint8Array(d.length))},nodebuffer:f},s.transformTo=function(d,b){if(b=b||"",!d)return b;s.checkSupport(d);var p=s.getTypeOf(b);return m[p][d](b)},s.resolve=function(d){for(var b=d.split("/"),p=[],x=0;x<b.length;x++){var k=b[x];k==="."||k===""&&x!==0&&x!==b.length-1||(k===".."?p.pop():p.push(k))}return p.join("/")},s.getTypeOf=function(d){return typeof d=="string"?"string":Object.prototype.toString.call(d)==="[object Array]"?"array":n.nodebuffer&&r.isBuffer(d)?"nodebuffer":n.uint8array&&d instanceof Uint8Array?"uint8array":n.arraybuffer&&d instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(d){if(!n[d.toLowerCase()])throw new Error(d+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(d){var b,p,x="";for(p=0;p<(d||"").length;p++)x+="\\x"+((b=d.charCodeAt(p))<16?"0":"")+b.toString(16).toUpperCase();return x},s.delay=function(d,b,p){setImmediate(function(){d.apply(p||null,b||[])})},s.inherits=function(d,b){function p(){}p.prototype=b.prototype,d.prototype=new p},s.extend=function(){var d,b,p={};for(d=0;d<arguments.length;d++)for(b in arguments[d])Object.prototype.hasOwnProperty.call(arguments[d],b)&&p[b]===void 0&&(p[b]=arguments[d][b]);return p},s.prepareContent=function(d,b,p,x,k){return u.Promise.resolve(b).then(function(S){return n.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1)&&typeof FileReader<"u"?new u.Promise(function(L,B){var O=new FileReader;O.onload=function(W){L(W.target.result)},O.onerror=function(W){B(W.target.error)},O.readAsArrayBuffer(S)}):S}).then(function(S){var L=s.getTypeOf(S);return L?(L==="arraybuffer"?S=s.transformTo("uint8array",S):L==="string"&&(k?S=i.decode(S):p&&x!==!0&&(S=function(B){return v(B,n.uint8array?new Uint8Array(B.length):new Array(B.length))}(S))),S):u.Promise.reject(new Error("Can't read the data of '"+d+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,l,s){var n=t("./reader/readerFor"),i=t("./utils"),r=t("./signature"),u=t("./zipEntry"),f=t("./support");function v(g){this.files=[],this.loadOptions=g}v.prototype={checkSignature:function(g){if(!this.reader.readAndCheckSignature(g)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(y)+", expected "+i.pretty(g)+")")}},isSignature:function(g,y){var c=this.reader.index;this.reader.setIndex(g);var m=this.reader.readString(4)===y;return this.reader.setIndex(c),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var g=this.reader.readData(this.zipCommentLength),y=f.uint8array?"uint8array":"array",c=i.transformTo(y,g);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var g,y,c,m=this.zip64EndOfCentralSize-44;0<m;)g=this.reader.readInt(2),y=this.reader.readInt(4),c=this.reader.readData(y),this.zip64ExtensibleData[g]={id:g,length:y,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var g,y;for(g=0;g<this.files.length;g++)y=this.files[g],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var g;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(g=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(g);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var g=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(g<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(g);var y=g;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(g=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(g),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var c=this.centralDirOffset+this.centralDirSize;this.zip64&&(c+=20,c+=12+this.zip64EndOfCentralSize);var m=y-c;if(0<m)this.isSignature(y,r.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(g){this.reader=n(g)},load:function(g){this.prepareReader(g),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},l.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,l,s){var n=t("./reader/readerFor"),i=t("./utils"),r=t("./compressedObject"),u=t("./crc32"),f=t("./utf8"),v=t("./compressions"),g=t("./support");function y(c,m){this.options=c,this.loadOptions=m}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(c){var m,d;if(c.skip(22),this.fileNameLength=c.readInt(2),d=c.readInt(2),this.fileName=c.readData(this.fileNameLength),c.skip(d),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(b){for(var p in v)if(Object.prototype.hasOwnProperty.call(v,p)&&v[p].magic===b)return v[p];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,m,c.readData(this.compressedSize))},readCentralPart:function(c){this.versionMadeBy=c.readInt(2),c.skip(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4);var m=c.readInt(2);if(this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");c.skip(m),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var c=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),c==0&&(this.dosPermissions=63&this.externalFileAttributes),c==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var c=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=c.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=c.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=c.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=c.readInt(4))}},readExtraFields:function(c){var m,d,b,p=c.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});c.index+4<p;)m=c.readInt(2),d=c.readInt(2),b=c.readData(d),this.extraFields[m]={id:m,length:d,value:b};c.setIndex(p)},handleUTF8:function(){var c=g.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var d=i.transformTo(c,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(d)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var p=i.transformTo(c,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var c=this.extraFields[28789];if(c){var m=n(c.value);return m.readInt(1)!==1||u(this.fileName)!==m.readInt(4)?null:f.utf8decode(m.readData(c.length-5))}return null},findExtraFieldUnicodeComment:function(){var c=this.extraFields[25461];if(c){var m=n(c.value);return m.readInt(1)!==1||u(this.fileComment)!==m.readInt(4)?null:f.utf8decode(m.readData(c.length-5))}return null}},l.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,l,s){function n(m,d,b){this.name=m,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=d,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var i=t("./stream/StreamHelper"),r=t("./stream/DataWorker"),u=t("./utf8"),f=t("./compressedObject"),v=t("./stream/GenericWorker");n.prototype={internalStream:function(m){var d=null,b="string";try{if(!m)throw new Error("No output type specified.");var p=(b=m.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),d=this._decompressWorker();var x=!this._dataBinary;x&&!p&&(d=d.pipe(new u.Utf8EncodeWorker)),!x&&p&&(d=d.pipe(new u.Utf8DecodeWorker))}catch(k){(d=new v("error")).error(k)}return new i(d,b,"")},async:function(m,d){return this.internalStream(m).accumulate(d)},nodeStream:function(m,d){return this.internalStream(m||"nodebuffer").toNodejsStream(d)},_compressWorker:function(m,d){if(this._data instanceof f&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new u.Utf8EncodeWorker)),f.createWorkerFrom(b,m,d)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof v?this._data:new r(this._data)}};for(var g=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<g.length;c++)n.prototype[g[c]]=y;l.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,l,s){(function(n){var i,r,u=n.MutationObserver||n.WebKitMutationObserver;if(u){var f=0,v=new u(m),g=n.document.createTextNode("");v.observe(g,{characterData:!0}),i=function(){g.data=f=++f%2}}else if(n.setImmediate||n.MessageChannel===void 0)i="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var d=n.document.createElement("script");d.onreadystatechange=function(){m(),d.onreadystatechange=null,d.parentNode.removeChild(d),d=null},n.document.documentElement.appendChild(d)}:function(){setTimeout(m,0)};else{var y=new n.MessageChannel;y.port1.onmessage=m,i=function(){y.port2.postMessage(0)}}var c=[];function m(){var d,b;r=!0;for(var p=c.length;p;){for(b=c,c=[],d=-1;++d<p;)b[d]();p=c.length}r=!1}l.exports=function(d){c.push(d)!==1||r||i()}}).call(this,typeof Ft<"u"?Ft:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,l,s){var n=t("immediate");function i(){}var r={},u=["REJECTED"],f=["FULFILLED"],v=["PENDING"];function g(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,p!==i&&d(this,p)}function y(p,x,k){this.promise=p,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function c(p,x,k){n(function(){var S;try{S=x(k)}catch(L){return r.reject(p,L)}S===p?r.reject(p,new TypeError("Cannot resolve promise with itself")):r.resolve(p,S)})}function m(p){var x=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof x=="function")return function(){x.apply(p,arguments)}}function d(p,x){var k=!1;function S(O){k||(k=!0,r.reject(p,O))}function L(O){k||(k=!0,r.resolve(p,O))}var B=b(function(){x(L,S)});B.status==="error"&&S(B.value)}function b(p,x){var k={};try{k.value=p(x),k.status="success"}catch(S){k.status="error",k.value=S}return k}(l.exports=g).prototype.finally=function(p){if(typeof p!="function")return this;var x=this.constructor;return this.then(function(k){return x.resolve(p()).then(function(){return k})},function(k){return x.resolve(p()).then(function(){throw k})})},g.prototype.catch=function(p){return this.then(null,p)},g.prototype.then=function(p,x){if(typeof p!="function"&&this.state===f||typeof x!="function"&&this.state===u)return this;var k=new this.constructor(i);return this.state!==v?c(k,this.state===f?p:x,this.outcome):this.queue.push(new y(k,p,x)),k},y.prototype.callFulfilled=function(p){r.resolve(this.promise,p)},y.prototype.otherCallFulfilled=function(p){c(this.promise,this.onFulfilled,p)},y.prototype.callRejected=function(p){r.reject(this.promise,p)},y.prototype.otherCallRejected=function(p){c(this.promise,this.onRejected,p)},r.resolve=function(p,x){var k=b(m,x);if(k.status==="error")return r.reject(p,k.value);var S=k.value;if(S)d(p,S);else{p.state=f,p.outcome=x;for(var L=-1,B=p.queue.length;++L<B;)p.queue[L].callFulfilled(x)}return p},r.reject=function(p,x){p.state=u,p.outcome=x;for(var k=-1,S=p.queue.length;++k<S;)p.queue[k].callRejected(x);return p},g.resolve=function(p){return p instanceof this?p:r.resolve(new this(i),p)},g.reject=function(p){var x=new this(i);return r.reject(x,p)},g.all=function(p){var x=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=p.length,S=!1;if(!k)return this.resolve([]);for(var L=new Array(k),B=0,O=-1,W=new this(i);++O<k;)T(p[O],O);return W;function T(H,J){x.resolve(H).then(function(C){L[J]=C,++B!==k||S||(S=!0,r.resolve(W,L))},function(C){S||(S=!0,r.reject(W,C))})}},g.race=function(p){var x=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=p.length,S=!1;if(!k)return this.resolve([]);for(var L=-1,B=new this(i);++L<k;)O=p[L],x.resolve(O).then(function(W){S||(S=!0,r.resolve(B,W))},function(W){S||(S=!0,r.reject(B,W))});var O;return B}},{immediate:36}],38:[function(t,l,s){var n={};(0,t("./lib/utils/common").assign)(n,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),l.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,l,s){var n=t("./zlib/deflate"),i=t("./utils/common"),r=t("./utils/strings"),u=t("./zlib/messages"),f=t("./zlib/zstream"),v=Object.prototype.toString,g=0,y=-1,c=0,m=8;function d(p){if(!(this instanceof d))return new d(p);this.options=i.assign({level:y,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},p||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var k=n.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(k!==g)throw new Error(u[k]);if(x.header&&n.deflateSetHeader(this.strm,x.header),x.dictionary){var S;if(S=typeof x.dictionary=="string"?r.string2buf(x.dictionary):v.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(k=n.deflateSetDictionary(this.strm,S))!==g)throw new Error(u[k]);this._dict_set=!0}}function b(p,x){var k=new d(x);if(k.push(p,!0),k.err)throw k.msg||u[k.err];return k.result}d.prototype.push=function(p,x){var k,S,L=this.strm,B=this.options.chunkSize;if(this.ended)return!1;S=x===~~x?x:x===!0?4:0,typeof p=="string"?L.input=r.string2buf(p):v.call(p)==="[object ArrayBuffer]"?L.input=new Uint8Array(p):L.input=p,L.next_in=0,L.avail_in=L.input.length;do{if(L.avail_out===0&&(L.output=new i.Buf8(B),L.next_out=0,L.avail_out=B),(k=n.deflate(L,S))!==1&&k!==g)return this.onEnd(k),!(this.ended=!0);L.avail_out!==0&&(L.avail_in!==0||S!==4&&S!==2)||(this.options.to==="string"?this.onData(r.buf2binstring(i.shrinkBuf(L.output,L.next_out))):this.onData(i.shrinkBuf(L.output,L.next_out)))}while((0<L.avail_in||L.avail_out===0)&&k!==1);return S===4?(k=n.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===g):S!==2||(this.onEnd(g),!(L.avail_out=0))},d.prototype.onData=function(p){this.chunks.push(p)},d.prototype.onEnd=function(p){p===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},s.Deflate=d,s.deflate=b,s.deflateRaw=function(p,x){return(x=x||{}).raw=!0,b(p,x)},s.gzip=function(p,x){return(x=x||{}).gzip=!0,b(p,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,l,s){var n=t("./zlib/inflate"),i=t("./utils/common"),r=t("./utils/strings"),u=t("./zlib/constants"),f=t("./zlib/messages"),v=t("./zlib/zstream"),g=t("./zlib/gzheader"),y=Object.prototype.toString;function c(d){if(!(this instanceof c))return new c(d);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},d||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||d&&d.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&!(15&b.windowBits)&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var p=n.inflateInit2(this.strm,b.windowBits);if(p!==u.Z_OK)throw new Error(f[p]);this.header=new g,n.inflateGetHeader(this.strm,this.header)}function m(d,b){var p=new c(b);if(p.push(d,!0),p.err)throw p.msg||f[p.err];return p.result}c.prototype.push=function(d,b){var p,x,k,S,L,B,O=this.strm,W=this.options.chunkSize,T=this.options.dictionary,H=!1;if(this.ended)return!1;x=b===~~b?b:b===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof d=="string"?O.input=r.binstring2buf(d):y.call(d)==="[object ArrayBuffer]"?O.input=new Uint8Array(d):O.input=d,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new i.Buf8(W),O.next_out=0,O.avail_out=W),(p=n.inflate(O,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&T&&(B=typeof T=="string"?r.string2buf(T):y.call(T)==="[object ArrayBuffer]"?new Uint8Array(T):T,p=n.inflateSetDictionary(this.strm,B)),p===u.Z_BUF_ERROR&&H===!0&&(p=u.Z_OK,H=!1),p!==u.Z_STREAM_END&&p!==u.Z_OK)return this.onEnd(p),!(this.ended=!0);O.next_out&&(O.avail_out!==0&&p!==u.Z_STREAM_END&&(O.avail_in!==0||x!==u.Z_FINISH&&x!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=r.utf8border(O.output,O.next_out),S=O.next_out-k,L=r.buf2string(O.output,k),O.next_out=S,O.avail_out=W-S,S&&i.arraySet(O.output,O.output,k,S,0),this.onData(L)):this.onData(i.shrinkBuf(O.output,O.next_out)))),O.avail_in===0&&O.avail_out===0&&(H=!0)}while((0<O.avail_in||O.avail_out===0)&&p!==u.Z_STREAM_END);return p===u.Z_STREAM_END&&(x=u.Z_FINISH),x===u.Z_FINISH?(p=n.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===u.Z_OK):x!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(O.avail_out=0))},c.prototype.onData=function(d){this.chunks.push(d)},c.prototype.onEnd=function(d){d===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},s.Inflate=c,s.inflate=m,s.inflateRaw=function(d,b){return(b=b||{}).raw=!0,m(d,b)},s.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,l,s){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(u){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var v=f.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(var g in v)v.hasOwnProperty(g)&&(u[g]=v[g])}}return u},s.shrinkBuf=function(u,f){return u.length===f?u:u.subarray?u.subarray(0,f):(u.length=f,u)};var i={arraySet:function(u,f,v,g,y){if(f.subarray&&u.subarray)u.set(f.subarray(v,v+g),y);else for(var c=0;c<g;c++)u[y+c]=f[v+c]},flattenChunks:function(u){var f,v,g,y,c,m;for(f=g=0,v=u.length;f<v;f++)g+=u[f].length;for(m=new Uint8Array(g),f=y=0,v=u.length;f<v;f++)c=u[f],m.set(c,y),y+=c.length;return m}},r={arraySet:function(u,f,v,g,y){for(var c=0;c<g;c++)u[y+c]=f[v+c]},flattenChunks:function(u){return[].concat.apply([],u)}};s.setTyped=function(u){u?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,i)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,r))},s.setTyped(n)},{}],42:[function(t,l,s){var n=t("./common"),i=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{r=!1}for(var u=new n.Buf8(256),f=0;f<256;f++)u[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function v(g,y){if(y<65537&&(g.subarray&&r||!g.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(g,y));for(var c="",m=0;m<y;m++)c+=String.fromCharCode(g[m]);return c}u[254]=u[254]=1,s.string2buf=function(g){var y,c,m,d,b,p=g.length,x=0;for(d=0;d<p;d++)(64512&(c=g.charCodeAt(d)))==55296&&d+1<p&&(64512&(m=g.charCodeAt(d+1)))==56320&&(c=65536+(c-55296<<10)+(m-56320),d++),x+=c<128?1:c<2048?2:c<65536?3:4;for(y=new n.Buf8(x),d=b=0;b<x;d++)(64512&(c=g.charCodeAt(d)))==55296&&d+1<p&&(64512&(m=g.charCodeAt(d+1)))==56320&&(c=65536+(c-55296<<10)+(m-56320),d++),c<128?y[b++]=c:(c<2048?y[b++]=192|c>>>6:(c<65536?y[b++]=224|c>>>12:(y[b++]=240|c>>>18,y[b++]=128|c>>>12&63),y[b++]=128|c>>>6&63),y[b++]=128|63&c);return y},s.buf2binstring=function(g){return v(g,g.length)},s.binstring2buf=function(g){for(var y=new n.Buf8(g.length),c=0,m=y.length;c<m;c++)y[c]=g.charCodeAt(c);return y},s.buf2string=function(g,y){var c,m,d,b,p=y||g.length,x=new Array(2*p);for(c=m=0;c<p;)if((d=g[c++])<128)x[m++]=d;else if(4<(b=u[d]))x[m++]=65533,c+=b-1;else{for(d&=b===2?31:b===3?15:7;1<b&&c<p;)d=d<<6|63&g[c++],b--;1<b?x[m++]=65533:d<65536?x[m++]=d:(d-=65536,x[m++]=55296|d>>10&1023,x[m++]=56320|1023&d)}return v(x,m)},s.utf8border=function(g,y){var c;for((y=y||g.length)>g.length&&(y=g.length),c=y-1;0<=c&&(192&g[c])==128;)c--;return c<0||c===0?y:c+u[g[c]]>y?c:y}},{"./common":41}],43:[function(t,l,s){l.exports=function(n,i,r,u){for(var f=65535&n|0,v=n>>>16&65535|0,g=0;r!==0;){for(r-=g=2e3<r?2e3:r;v=v+(f=f+i[u++]|0)|0,--g;);f%=65521,v%=65521}return f|v<<16|0}},{}],44:[function(t,l,s){l.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,l,s){var n=function(){for(var i,r=[],u=0;u<256;u++){i=u;for(var f=0;f<8;f++)i=1&i?3988292384^i>>>1:i>>>1;r[u]=i}return r}();l.exports=function(i,r,u,f){var v=n,g=f+u;i^=-1;for(var y=f;y<g;y++)i=i>>>8^v[255&(i^r[y])];return-1^i}},{}],46:[function(t,l,s){var n,i=t("../utils/common"),r=t("./trees"),u=t("./adler32"),f=t("./crc32"),v=t("./messages"),g=0,y=4,c=0,m=-2,d=-1,b=4,p=2,x=8,k=9,S=286,L=30,B=19,O=2*S+1,W=15,T=3,H=258,J=H+T+1,C=42,D=113,h=1,F=2,$=3,U=4;function tt(a,R){return a.msg=v[R],R}function j(a){return(a<<1)-(4<a?9:0)}function q(a){for(var R=a.length;0<=--R;)a[R]=0}function E(a){var R=a.state,z=R.pending;z>a.avail_out&&(z=a.avail_out),z!==0&&(i.arraySet(a.output,R.pending_buf,R.pending_out,z,a.next_out),a.next_out+=z,R.pending_out+=z,a.total_out+=z,a.avail_out-=z,R.pending-=z,R.pending===0&&(R.pending_out=0))}function P(a,R){r._tr_flush_block(a,0<=a.block_start?a.block_start:-1,a.strstart-a.block_start,R),a.block_start=a.strstart,E(a.strm)}function Q(a,R){a.pending_buf[a.pending++]=R}function V(a,R){a.pending_buf[a.pending++]=R>>>8&255,a.pending_buf[a.pending++]=255&R}function K(a,R){var z,w,_=a.max_chain_length,A=a.strstart,N=a.prev_length,M=a.nice_match,I=a.strstart>a.w_size-J?a.strstart-(a.w_size-J):0,Z=a.window,Y=a.w_mask,G=a.prev,X=a.strstart+H,it=Z[A+N-1],nt=Z[A+N];a.prev_length>=a.good_match&&(_>>=2),M>a.lookahead&&(M=a.lookahead);do if(Z[(z=R)+N]===nt&&Z[z+N-1]===it&&Z[z]===Z[A]&&Z[++z]===Z[A+1]){A+=2,z++;do;while(Z[++A]===Z[++z]&&Z[++A]===Z[++z]&&Z[++A]===Z[++z]&&Z[++A]===Z[++z]&&Z[++A]===Z[++z]&&Z[++A]===Z[++z]&&Z[++A]===Z[++z]&&Z[++A]===Z[++z]&&A<X);if(w=H-(X-A),A=X-H,N<w){if(a.match_start=R,M<=(N=w))break;it=Z[A+N-1],nt=Z[A+N]}}while((R=G[R&Y])>I&&--_!=0);return N<=a.lookahead?N:a.lookahead}function ot(a){var R,z,w,_,A,N,M,I,Z,Y,G=a.w_size;do{if(_=a.window_size-a.lookahead-a.strstart,a.strstart>=G+(G-J)){for(i.arraySet(a.window,a.window,G,G,0),a.match_start-=G,a.strstart-=G,a.block_start-=G,R=z=a.hash_size;w=a.head[--R],a.head[R]=G<=w?w-G:0,--z;);for(R=z=G;w=a.prev[--R],a.prev[R]=G<=w?w-G:0,--z;);_+=G}if(a.strm.avail_in===0)break;if(N=a.strm,M=a.window,I=a.strstart+a.lookahead,Z=_,Y=void 0,Y=N.avail_in,Z<Y&&(Y=Z),z=Y===0?0:(N.avail_in-=Y,i.arraySet(M,N.input,N.next_in,Y,I),N.state.wrap===1?N.adler=u(N.adler,M,Y,I):N.state.wrap===2&&(N.adler=f(N.adler,M,Y,I)),N.next_in+=Y,N.total_in+=Y,Y),a.lookahead+=z,a.lookahead+a.insert>=T)for(A=a.strstart-a.insert,a.ins_h=a.window[A],a.ins_h=(a.ins_h<<a.hash_shift^a.window[A+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[A+T-1])&a.hash_mask,a.prev[A&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=A,A++,a.insert--,!(a.lookahead+a.insert<T)););}while(a.lookahead<J&&a.strm.avail_in!==0)}function ht(a,R){for(var z,w;;){if(a.lookahead<J){if(ot(a),a.lookahead<J&&R===g)return h;if(a.lookahead===0)break}if(z=0,a.lookahead>=T&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,z=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),z!==0&&a.strstart-z<=a.w_size-J&&(a.match_length=K(a,z)),a.match_length>=T)if(w=r._tr_tally(a,a.strstart-a.match_start,a.match_length-T),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=T){for(a.match_length--;a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,z=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart,--a.match_length!=0;);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else w=r._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(w&&(P(a,!1),a.strm.avail_out===0))return h}return a.insert=a.strstart<T-1?a.strstart:T-1,R===y?(P(a,!0),a.strm.avail_out===0?$:U):a.last_lit&&(P(a,!1),a.strm.avail_out===0)?h:F}function et(a,R){for(var z,w,_;;){if(a.lookahead<J){if(ot(a),a.lookahead<J&&R===g)return h;if(a.lookahead===0)break}if(z=0,a.lookahead>=T&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,z=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=T-1,z!==0&&a.prev_length<a.max_lazy_match&&a.strstart-z<=a.w_size-J&&(a.match_length=K(a,z),a.match_length<=5&&(a.strategy===1||a.match_length===T&&4096<a.strstart-a.match_start)&&(a.match_length=T-1)),a.prev_length>=T&&a.match_length<=a.prev_length){for(_=a.strstart+a.lookahead-T,w=r._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-T),a.lookahead-=a.prev_length-1,a.prev_length-=2;++a.strstart<=_&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+T-1])&a.hash_mask,z=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),--a.prev_length!=0;);if(a.match_available=0,a.match_length=T-1,a.strstart++,w&&(P(a,!1),a.strm.avail_out===0))return h}else if(a.match_available){if((w=r._tr_tally(a,0,a.window[a.strstart-1]))&&P(a,!1),a.strstart++,a.lookahead--,a.strm.avail_out===0)return h}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(w=r._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<T-1?a.strstart:T-1,R===y?(P(a,!0),a.strm.avail_out===0?$:U):a.last_lit&&(P(a,!1),a.strm.avail_out===0)?h:F}function rt(a,R,z,w,_){this.good_length=a,this.max_lazy=R,this.nice_length=z,this.max_chain=w,this.func=_}function ut(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*O),this.dyn_dtree=new i.Buf16(2*(2*L+1)),this.bl_tree=new i.Buf16(2*(2*B+1)),q(this.dyn_ltree),q(this.dyn_dtree),q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(W+1),this.heap=new i.Buf16(2*S+1),q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*S+1),q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function at(a){var R;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=p,(R=a.state).pending=0,R.pending_out=0,R.wrap<0&&(R.wrap=-R.wrap),R.status=R.wrap?C:D,a.adler=R.wrap===2?0:1,R.last_flush=g,r._tr_init(R),c):tt(a,m)}function ft(a){var R=at(a);return R===c&&function(z){z.window_size=2*z.w_size,q(z.head),z.max_lazy_match=n[z.level].max_lazy,z.good_match=n[z.level].good_length,z.nice_match=n[z.level].nice_length,z.max_chain_length=n[z.level].max_chain,z.strstart=0,z.block_start=0,z.lookahead=0,z.insert=0,z.match_length=z.prev_length=T-1,z.match_available=0,z.ins_h=0}(a.state),R}function dt(a,R,z,w,_,A){if(!a)return m;var N=1;if(R===d&&(R=6),w<0?(N=0,w=-w):15<w&&(N=2,w-=16),_<1||k<_||z!==x||w<8||15<w||R<0||9<R||A<0||b<A)return tt(a,m);w===8&&(w=9);var M=new ut;return(a.state=M).strm=a,M.wrap=N,M.gzhead=null,M.w_bits=w,M.w_size=1<<M.w_bits,M.w_mask=M.w_size-1,M.hash_bits=_+7,M.hash_size=1<<M.hash_bits,M.hash_mask=M.hash_size-1,M.hash_shift=~~((M.hash_bits+T-1)/T),M.window=new i.Buf8(2*M.w_size),M.head=new i.Buf16(M.hash_size),M.prev=new i.Buf16(M.w_size),M.lit_bufsize=1<<_+6,M.pending_buf_size=4*M.lit_bufsize,M.pending_buf=new i.Buf8(M.pending_buf_size),M.d_buf=1*M.lit_bufsize,M.l_buf=3*M.lit_bufsize,M.level=R,M.strategy=A,M.method=z,ft(a)}n=[new rt(0,0,0,0,function(a,R){var z=65535;for(z>a.pending_buf_size-5&&(z=a.pending_buf_size-5);;){if(a.lookahead<=1){if(ot(a),a.lookahead===0&&R===g)return h;if(a.lookahead===0)break}a.strstart+=a.lookahead,a.lookahead=0;var w=a.block_start+z;if((a.strstart===0||a.strstart>=w)&&(a.lookahead=a.strstart-w,a.strstart=w,P(a,!1),a.strm.avail_out===0)||a.strstart-a.block_start>=a.w_size-J&&(P(a,!1),a.strm.avail_out===0))return h}return a.insert=0,R===y?(P(a,!0),a.strm.avail_out===0?$:U):(a.strstart>a.block_start&&(P(a,!1),a.strm.avail_out),h)}),new rt(4,4,8,4,ht),new rt(4,5,16,8,ht),new rt(4,6,32,32,ht),new rt(4,4,16,16,et),new rt(8,16,32,32,et),new rt(8,16,128,128,et),new rt(8,32,128,256,et),new rt(32,128,258,1024,et),new rt(32,258,258,4096,et)],s.deflateInit=function(a,R){return dt(a,R,x,15,8,0)},s.deflateInit2=dt,s.deflateReset=ft,s.deflateResetKeep=at,s.deflateSetHeader=function(a,R){return a&&a.state?a.state.wrap!==2?m:(a.state.gzhead=R,c):m},s.deflate=function(a,R){var z,w,_,A;if(!a||!a.state||5<R||R<0)return a?tt(a,m):m;if(w=a.state,!a.output||!a.input&&a.avail_in!==0||w.status===666&&R!==y)return tt(a,a.avail_out===0?-5:m);if(w.strm=a,z=w.last_flush,w.last_flush=R,w.status===C)if(w.wrap===2)a.adler=0,Q(w,31),Q(w,139),Q(w,8),w.gzhead?(Q(w,(w.gzhead.text?1:0)+(w.gzhead.hcrc?2:0)+(w.gzhead.extra?4:0)+(w.gzhead.name?8:0)+(w.gzhead.comment?16:0)),Q(w,255&w.gzhead.time),Q(w,w.gzhead.time>>8&255),Q(w,w.gzhead.time>>16&255),Q(w,w.gzhead.time>>24&255),Q(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),Q(w,255&w.gzhead.os),w.gzhead.extra&&w.gzhead.extra.length&&(Q(w,255&w.gzhead.extra.length),Q(w,w.gzhead.extra.length>>8&255)),w.gzhead.hcrc&&(a.adler=f(a.adler,w.pending_buf,w.pending,0)),w.gzindex=0,w.status=69):(Q(w,0),Q(w,0),Q(w,0),Q(w,0),Q(w,0),Q(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),Q(w,3),w.status=D);else{var N=x+(w.w_bits-8<<4)<<8;N|=(2<=w.strategy||w.level<2?0:w.level<6?1:w.level===6?2:3)<<6,w.strstart!==0&&(N|=32),N+=31-N%31,w.status=D,V(w,N),w.strstart!==0&&(V(w,a.adler>>>16),V(w,65535&a.adler)),a.adler=1}if(w.status===69)if(w.gzhead.extra){for(_=w.pending;w.gzindex<(65535&w.gzhead.extra.length)&&(w.pending!==w.pending_buf_size||(w.gzhead.hcrc&&w.pending>_&&(a.adler=f(a.adler,w.pending_buf,w.pending-_,_)),E(a),_=w.pending,w.pending!==w.pending_buf_size));)Q(w,255&w.gzhead.extra[w.gzindex]),w.gzindex++;w.gzhead.hcrc&&w.pending>_&&(a.adler=f(a.adler,w.pending_buf,w.pending-_,_)),w.gzindex===w.gzhead.extra.length&&(w.gzindex=0,w.status=73)}else w.status=73;if(w.status===73)if(w.gzhead.name){_=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>_&&(a.adler=f(a.adler,w.pending_buf,w.pending-_,_)),E(a),_=w.pending,w.pending===w.pending_buf_size)){A=1;break}A=w.gzindex<w.gzhead.name.length?255&w.gzhead.name.charCodeAt(w.gzindex++):0,Q(w,A)}while(A!==0);w.gzhead.hcrc&&w.pending>_&&(a.adler=f(a.adler,w.pending_buf,w.pending-_,_)),A===0&&(w.gzindex=0,w.status=91)}else w.status=91;if(w.status===91)if(w.gzhead.comment){_=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>_&&(a.adler=f(a.adler,w.pending_buf,w.pending-_,_)),E(a),_=w.pending,w.pending===w.pending_buf_size)){A=1;break}A=w.gzindex<w.gzhead.comment.length?255&w.gzhead.comment.charCodeAt(w.gzindex++):0,Q(w,A)}while(A!==0);w.gzhead.hcrc&&w.pending>_&&(a.adler=f(a.adler,w.pending_buf,w.pending-_,_)),A===0&&(w.status=103)}else w.status=103;if(w.status===103&&(w.gzhead.hcrc?(w.pending+2>w.pending_buf_size&&E(a),w.pending+2<=w.pending_buf_size&&(Q(w,255&a.adler),Q(w,a.adler>>8&255),a.adler=0,w.status=D)):w.status=D),w.pending!==0){if(E(a),a.avail_out===0)return w.last_flush=-1,c}else if(a.avail_in===0&&j(R)<=j(z)&&R!==y)return tt(a,-5);if(w.status===666&&a.avail_in!==0)return tt(a,-5);if(a.avail_in!==0||w.lookahead!==0||R!==g&&w.status!==666){var M=w.strategy===2?function(I,Z){for(var Y;;){if(I.lookahead===0&&(ot(I),I.lookahead===0)){if(Z===g)return h;break}if(I.match_length=0,Y=r._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++,Y&&(P(I,!1),I.strm.avail_out===0))return h}return I.insert=0,Z===y?(P(I,!0),I.strm.avail_out===0?$:U):I.last_lit&&(P(I,!1),I.strm.avail_out===0)?h:F}(w,R):w.strategy===3?function(I,Z){for(var Y,G,X,it,nt=I.window;;){if(I.lookahead<=H){if(ot(I),I.lookahead<=H&&Z===g)return h;if(I.lookahead===0)break}if(I.match_length=0,I.lookahead>=T&&0<I.strstart&&(G=nt[X=I.strstart-1])===nt[++X]&&G===nt[++X]&&G===nt[++X]){it=I.strstart+H;do;while(G===nt[++X]&&G===nt[++X]&&G===nt[++X]&&G===nt[++X]&&G===nt[++X]&&G===nt[++X]&&G===nt[++X]&&G===nt[++X]&&X<it);I.match_length=H-(it-X),I.match_length>I.lookahead&&(I.match_length=I.lookahead)}if(I.match_length>=T?(Y=r._tr_tally(I,1,I.match_length-T),I.lookahead-=I.match_length,I.strstart+=I.match_length,I.match_length=0):(Y=r._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++),Y&&(P(I,!1),I.strm.avail_out===0))return h}return I.insert=0,Z===y?(P(I,!0),I.strm.avail_out===0?$:U):I.last_lit&&(P(I,!1),I.strm.avail_out===0)?h:F}(w,R):n[w.level].func(w,R);if(M!==$&&M!==U||(w.status=666),M===h||M===$)return a.avail_out===0&&(w.last_flush=-1),c;if(M===F&&(R===1?r._tr_align(w):R!==5&&(r._tr_stored_block(w,0,0,!1),R===3&&(q(w.head),w.lookahead===0&&(w.strstart=0,w.block_start=0,w.insert=0))),E(a),a.avail_out===0))return w.last_flush=-1,c}return R!==y?c:w.wrap<=0?1:(w.wrap===2?(Q(w,255&a.adler),Q(w,a.adler>>8&255),Q(w,a.adler>>16&255),Q(w,a.adler>>24&255),Q(w,255&a.total_in),Q(w,a.total_in>>8&255),Q(w,a.total_in>>16&255),Q(w,a.total_in>>24&255)):(V(w,a.adler>>>16),V(w,65535&a.adler)),E(a),0<w.wrap&&(w.wrap=-w.wrap),w.pending!==0?c:1)},s.deflateEnd=function(a){var R;return a&&a.state?(R=a.state.status)!==C&&R!==69&&R!==73&&R!==91&&R!==103&&R!==D&&R!==666?tt(a,m):(a.state=null,R===D?tt(a,-3):c):m},s.deflateSetDictionary=function(a,R){var z,w,_,A,N,M,I,Z,Y=R.length;if(!a||!a.state||(A=(z=a.state).wrap)===2||A===1&&z.status!==C||z.lookahead)return m;for(A===1&&(a.adler=u(a.adler,R,Y,0)),z.wrap=0,Y>=z.w_size&&(A===0&&(q(z.head),z.strstart=0,z.block_start=0,z.insert=0),Z=new i.Buf8(z.w_size),i.arraySet(Z,R,Y-z.w_size,z.w_size,0),R=Z,Y=z.w_size),N=a.avail_in,M=a.next_in,I=a.input,a.avail_in=Y,a.next_in=0,a.input=R,ot(z);z.lookahead>=T;){for(w=z.strstart,_=z.lookahead-(T-1);z.ins_h=(z.ins_h<<z.hash_shift^z.window[w+T-1])&z.hash_mask,z.prev[w&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=w,w++,--_;);z.strstart=w,z.lookahead=T-1,ot(z)}return z.strstart+=z.lookahead,z.block_start=z.strstart,z.insert=z.lookahead,z.lookahead=0,z.match_length=z.prev_length=T-1,z.match_available=0,a.next_in=M,a.input=I,a.avail_in=N,z.wrap=A,c},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,l,s){l.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,l,s){l.exports=function(n,i){var r,u,f,v,g,y,c,m,d,b,p,x,k,S,L,B,O,W,T,H,J,C,D,h,F;r=n.state,u=n.next_in,h=n.input,f=u+(n.avail_in-5),v=n.next_out,F=n.output,g=v-(i-n.avail_out),y=v+(n.avail_out-257),c=r.dmax,m=r.wsize,d=r.whave,b=r.wnext,p=r.window,x=r.hold,k=r.bits,S=r.lencode,L=r.distcode,B=(1<<r.lenbits)-1,O=(1<<r.distbits)-1;t:do{k<15&&(x+=h[u++]<<k,k+=8,x+=h[u++]<<k,k+=8),W=S[x&B];e:for(;;){if(x>>>=T=W>>>24,k-=T,(T=W>>>16&255)===0)F[v++]=65535&W;else{if(!(16&T)){if(!(64&T)){W=S[(65535&W)+(x&(1<<T)-1)];continue e}if(32&T){r.mode=12;break t}n.msg="invalid literal/length code",r.mode=30;break t}H=65535&W,(T&=15)&&(k<T&&(x+=h[u++]<<k,k+=8),H+=x&(1<<T)-1,x>>>=T,k-=T),k<15&&(x+=h[u++]<<k,k+=8,x+=h[u++]<<k,k+=8),W=L[x&O];n:for(;;){if(x>>>=T=W>>>24,k-=T,!(16&(T=W>>>16&255))){if(!(64&T)){W=L[(65535&W)+(x&(1<<T)-1)];continue n}n.msg="invalid distance code",r.mode=30;break t}if(J=65535&W,k<(T&=15)&&(x+=h[u++]<<k,(k+=8)<T&&(x+=h[u++]<<k,k+=8)),c<(J+=x&(1<<T)-1)){n.msg="invalid distance too far back",r.mode=30;break t}if(x>>>=T,k-=T,(T=v-g)<J){if(d<(T=J-T)&&r.sane){n.msg="invalid distance too far back",r.mode=30;break t}if(D=p,(C=0)===b){if(C+=m-T,T<H){for(H-=T;F[v++]=p[C++],--T;);C=v-J,D=F}}else if(b<T){if(C+=m+b-T,(T-=b)<H){for(H-=T;F[v++]=p[C++],--T;);if(C=0,b<H){for(H-=T=b;F[v++]=p[C++],--T;);C=v-J,D=F}}}else if(C+=b-T,T<H){for(H-=T;F[v++]=p[C++],--T;);C=v-J,D=F}for(;2<H;)F[v++]=D[C++],F[v++]=D[C++],F[v++]=D[C++],H-=3;H&&(F[v++]=D[C++],1<H&&(F[v++]=D[C++]))}else{for(C=v-J;F[v++]=F[C++],F[v++]=F[C++],F[v++]=F[C++],2<(H-=3););H&&(F[v++]=F[C++],1<H&&(F[v++]=F[C++]))}break}}break}}while(u<f&&v<y);u-=H=k>>3,x&=(1<<(k-=H<<3))-1,n.next_in=u,n.next_out=v,n.avail_in=u<f?f-u+5:5-(u-f),n.avail_out=v<y?y-v+257:257-(v-y),r.hold=x,r.bits=k}},{}],49:[function(t,l,s){var n=t("../utils/common"),i=t("./adler32"),r=t("./crc32"),u=t("./inffast"),f=t("./inftrees"),v=1,g=2,y=0,c=-2,m=1,d=852,b=592;function p(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(C){var D;return C&&C.state?(D=C.state,C.total_in=C.total_out=D.total=0,C.msg="",D.wrap&&(C.adler=1&D.wrap),D.mode=m,D.last=0,D.havedict=0,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new n.Buf32(d),D.distcode=D.distdyn=new n.Buf32(b),D.sane=1,D.back=-1,y):c}function S(C){var D;return C&&C.state?((D=C.state).wsize=0,D.whave=0,D.wnext=0,k(C)):c}function L(C,D){var h,F;return C&&C.state?(F=C.state,D<0?(h=0,D=-D):(h=1+(D>>4),D<48&&(D&=15)),D&&(D<8||15<D)?c:(F.window!==null&&F.wbits!==D&&(F.window=null),F.wrap=h,F.wbits=D,S(C))):c}function B(C,D){var h,F;return C?(F=new x,(C.state=F).window=null,(h=L(C,D))!==y&&(C.state=null),h):c}var O,W,T=!0;function H(C){if(T){var D;for(O=new n.Buf32(512),W=new n.Buf32(32),D=0;D<144;)C.lens[D++]=8;for(;D<256;)C.lens[D++]=9;for(;D<280;)C.lens[D++]=7;for(;D<288;)C.lens[D++]=8;for(f(v,C.lens,0,288,O,0,C.work,{bits:9}),D=0;D<32;)C.lens[D++]=5;f(g,C.lens,0,32,W,0,C.work,{bits:5}),T=!1}C.lencode=O,C.lenbits=9,C.distcode=W,C.distbits=5}function J(C,D,h,F){var $,U=C.state;return U.window===null&&(U.wsize=1<<U.wbits,U.wnext=0,U.whave=0,U.window=new n.Buf8(U.wsize)),F>=U.wsize?(n.arraySet(U.window,D,h-U.wsize,U.wsize,0),U.wnext=0,U.whave=U.wsize):(F<($=U.wsize-U.wnext)&&($=F),n.arraySet(U.window,D,h-F,$,U.wnext),(F-=$)?(n.arraySet(U.window,D,h-F,F,0),U.wnext=F,U.whave=U.wsize):(U.wnext+=$,U.wnext===U.wsize&&(U.wnext=0),U.whave<U.wsize&&(U.whave+=$))),0}s.inflateReset=S,s.inflateReset2=L,s.inflateResetKeep=k,s.inflateInit=function(C){return B(C,15)},s.inflateInit2=B,s.inflate=function(C,D){var h,F,$,U,tt,j,q,E,P,Q,V,K,ot,ht,et,rt,ut,at,ft,dt,a,R,z,w,_=0,A=new n.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return c;(h=C.state).mode===12&&(h.mode=13),tt=C.next_out,$=C.output,q=C.avail_out,U=C.next_in,F=C.input,j=C.avail_in,E=h.hold,P=h.bits,Q=j,V=q,R=y;t:for(;;)switch(h.mode){case m:if(h.wrap===0){h.mode=13;break}for(;P<16;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}if(2&h.wrap&&E===35615){A[h.check=0]=255&E,A[1]=E>>>8&255,h.check=r(h.check,A,2,0),P=E=0,h.mode=2;break}if(h.flags=0,h.head&&(h.head.done=!1),!(1&h.wrap)||(((255&E)<<8)+(E>>8))%31){C.msg="incorrect header check",h.mode=30;break}if((15&E)!=8){C.msg="unknown compression method",h.mode=30;break}if(P-=4,a=8+(15&(E>>>=4)),h.wbits===0)h.wbits=a;else if(a>h.wbits){C.msg="invalid window size",h.mode=30;break}h.dmax=1<<a,C.adler=h.check=1,h.mode=512&E?10:12,P=E=0;break;case 2:for(;P<16;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}if(h.flags=E,(255&h.flags)!=8){C.msg="unknown compression method",h.mode=30;break}if(57344&h.flags){C.msg="unknown header flags set",h.mode=30;break}h.head&&(h.head.text=E>>8&1),512&h.flags&&(A[0]=255&E,A[1]=E>>>8&255,h.check=r(h.check,A,2,0)),P=E=0,h.mode=3;case 3:for(;P<32;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}h.head&&(h.head.time=E),512&h.flags&&(A[0]=255&E,A[1]=E>>>8&255,A[2]=E>>>16&255,A[3]=E>>>24&255,h.check=r(h.check,A,4,0)),P=E=0,h.mode=4;case 4:for(;P<16;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}h.head&&(h.head.xflags=255&E,h.head.os=E>>8),512&h.flags&&(A[0]=255&E,A[1]=E>>>8&255,h.check=r(h.check,A,2,0)),P=E=0,h.mode=5;case 5:if(1024&h.flags){for(;P<16;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}h.length=E,h.head&&(h.head.extra_len=E),512&h.flags&&(A[0]=255&E,A[1]=E>>>8&255,h.check=r(h.check,A,2,0)),P=E=0}else h.head&&(h.head.extra=null);h.mode=6;case 6:if(1024&h.flags&&(j<(K=h.length)&&(K=j),K&&(h.head&&(a=h.head.extra_len-h.length,h.head.extra||(h.head.extra=new Array(h.head.extra_len)),n.arraySet(h.head.extra,F,U,K,a)),512&h.flags&&(h.check=r(h.check,F,K,U)),j-=K,U+=K,h.length-=K),h.length))break t;h.length=0,h.mode=7;case 7:if(2048&h.flags){if(j===0)break t;for(K=0;a=F[U+K++],h.head&&a&&h.length<65536&&(h.head.name+=String.fromCharCode(a)),a&&K<j;);if(512&h.flags&&(h.check=r(h.check,F,K,U)),j-=K,U+=K,a)break t}else h.head&&(h.head.name=null);h.length=0,h.mode=8;case 8:if(4096&h.flags){if(j===0)break t;for(K=0;a=F[U+K++],h.head&&a&&h.length<65536&&(h.head.comment+=String.fromCharCode(a)),a&&K<j;);if(512&h.flags&&(h.check=r(h.check,F,K,U)),j-=K,U+=K,a)break t}else h.head&&(h.head.comment=null);h.mode=9;case 9:if(512&h.flags){for(;P<16;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}if(E!==(65535&h.check)){C.msg="header crc mismatch",h.mode=30;break}P=E=0}h.head&&(h.head.hcrc=h.flags>>9&1,h.head.done=!0),C.adler=h.check=0,h.mode=12;break;case 10:for(;P<32;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}C.adler=h.check=p(E),P=E=0,h.mode=11;case 11:if(h.havedict===0)return C.next_out=tt,C.avail_out=q,C.next_in=U,C.avail_in=j,h.hold=E,h.bits=P,2;C.adler=h.check=1,h.mode=12;case 12:if(D===5||D===6)break t;case 13:if(h.last){E>>>=7&P,P-=7&P,h.mode=27;break}for(;P<3;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}switch(h.last=1&E,P-=1,3&(E>>>=1)){case 0:h.mode=14;break;case 1:if(H(h),h.mode=20,D!==6)break;E>>>=2,P-=2;break t;case 2:h.mode=17;break;case 3:C.msg="invalid block type",h.mode=30}E>>>=2,P-=2;break;case 14:for(E>>>=7&P,P-=7&P;P<32;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}if((65535&E)!=(E>>>16^65535)){C.msg="invalid stored block lengths",h.mode=30;break}if(h.length=65535&E,P=E=0,h.mode=15,D===6)break t;case 15:h.mode=16;case 16:if(K=h.length){if(j<K&&(K=j),q<K&&(K=q),K===0)break t;n.arraySet($,F,U,K,tt),j-=K,U+=K,q-=K,tt+=K,h.length-=K;break}h.mode=12;break;case 17:for(;P<14;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}if(h.nlen=257+(31&E),E>>>=5,P-=5,h.ndist=1+(31&E),E>>>=5,P-=5,h.ncode=4+(15&E),E>>>=4,P-=4,286<h.nlen||30<h.ndist){C.msg="too many length or distance symbols",h.mode=30;break}h.have=0,h.mode=18;case 18:for(;h.have<h.ncode;){for(;P<3;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}h.lens[N[h.have++]]=7&E,E>>>=3,P-=3}for(;h.have<19;)h.lens[N[h.have++]]=0;if(h.lencode=h.lendyn,h.lenbits=7,z={bits:h.lenbits},R=f(0,h.lens,0,19,h.lencode,0,h.work,z),h.lenbits=z.bits,R){C.msg="invalid code lengths set",h.mode=30;break}h.have=0,h.mode=19;case 19:for(;h.have<h.nlen+h.ndist;){for(;rt=(_=h.lencode[E&(1<<h.lenbits)-1])>>>16&255,ut=65535&_,!((et=_>>>24)<=P);){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}if(ut<16)E>>>=et,P-=et,h.lens[h.have++]=ut;else{if(ut===16){for(w=et+2;P<w;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}if(E>>>=et,P-=et,h.have===0){C.msg="invalid bit length repeat",h.mode=30;break}a=h.lens[h.have-1],K=3+(3&E),E>>>=2,P-=2}else if(ut===17){for(w=et+3;P<w;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}P-=et,a=0,K=3+(7&(E>>>=et)),E>>>=3,P-=3}else{for(w=et+7;P<w;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}P-=et,a=0,K=11+(127&(E>>>=et)),E>>>=7,P-=7}if(h.have+K>h.nlen+h.ndist){C.msg="invalid bit length repeat",h.mode=30;break}for(;K--;)h.lens[h.have++]=a}}if(h.mode===30)break;if(h.lens[256]===0){C.msg="invalid code -- missing end-of-block",h.mode=30;break}if(h.lenbits=9,z={bits:h.lenbits},R=f(v,h.lens,0,h.nlen,h.lencode,0,h.work,z),h.lenbits=z.bits,R){C.msg="invalid literal/lengths set",h.mode=30;break}if(h.distbits=6,h.distcode=h.distdyn,z={bits:h.distbits},R=f(g,h.lens,h.nlen,h.ndist,h.distcode,0,h.work,z),h.distbits=z.bits,R){C.msg="invalid distances set",h.mode=30;break}if(h.mode=20,D===6)break t;case 20:h.mode=21;case 21:if(6<=j&&258<=q){C.next_out=tt,C.avail_out=q,C.next_in=U,C.avail_in=j,h.hold=E,h.bits=P,u(C,V),tt=C.next_out,$=C.output,q=C.avail_out,U=C.next_in,F=C.input,j=C.avail_in,E=h.hold,P=h.bits,h.mode===12&&(h.back=-1);break}for(h.back=0;rt=(_=h.lencode[E&(1<<h.lenbits)-1])>>>16&255,ut=65535&_,!((et=_>>>24)<=P);){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}if(rt&&!(240&rt)){for(at=et,ft=rt,dt=ut;rt=(_=h.lencode[dt+((E&(1<<at+ft)-1)>>at)])>>>16&255,ut=65535&_,!(at+(et=_>>>24)<=P);){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}E>>>=at,P-=at,h.back+=at}if(E>>>=et,P-=et,h.back+=et,h.length=ut,rt===0){h.mode=26;break}if(32&rt){h.back=-1,h.mode=12;break}if(64&rt){C.msg="invalid literal/length code",h.mode=30;break}h.extra=15&rt,h.mode=22;case 22:if(h.extra){for(w=h.extra;P<w;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}h.length+=E&(1<<h.extra)-1,E>>>=h.extra,P-=h.extra,h.back+=h.extra}h.was=h.length,h.mode=23;case 23:for(;rt=(_=h.distcode[E&(1<<h.distbits)-1])>>>16&255,ut=65535&_,!((et=_>>>24)<=P);){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}if(!(240&rt)){for(at=et,ft=rt,dt=ut;rt=(_=h.distcode[dt+((E&(1<<at+ft)-1)>>at)])>>>16&255,ut=65535&_,!(at+(et=_>>>24)<=P);){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}E>>>=at,P-=at,h.back+=at}if(E>>>=et,P-=et,h.back+=et,64&rt){C.msg="invalid distance code",h.mode=30;break}h.offset=ut,h.extra=15&rt,h.mode=24;case 24:if(h.extra){for(w=h.extra;P<w;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}h.offset+=E&(1<<h.extra)-1,E>>>=h.extra,P-=h.extra,h.back+=h.extra}if(h.offset>h.dmax){C.msg="invalid distance too far back",h.mode=30;break}h.mode=25;case 25:if(q===0)break t;if(K=V-q,h.offset>K){if((K=h.offset-K)>h.whave&&h.sane){C.msg="invalid distance too far back",h.mode=30;break}ot=K>h.wnext?(K-=h.wnext,h.wsize-K):h.wnext-K,K>h.length&&(K=h.length),ht=h.window}else ht=$,ot=tt-h.offset,K=h.length;for(q<K&&(K=q),q-=K,h.length-=K;$[tt++]=ht[ot++],--K;);h.length===0&&(h.mode=21);break;case 26:if(q===0)break t;$[tt++]=h.length,q--,h.mode=21;break;case 27:if(h.wrap){for(;P<32;){if(j===0)break t;j--,E|=F[U++]<<P,P+=8}if(V-=q,C.total_out+=V,h.total+=V,V&&(C.adler=h.check=h.flags?r(h.check,$,V,tt-V):i(h.check,$,V,tt-V)),V=q,(h.flags?E:p(E))!==h.check){C.msg="incorrect data check",h.mode=30;break}P=E=0}h.mode=28;case 28:if(h.wrap&&h.flags){for(;P<32;){if(j===0)break t;j--,E+=F[U++]<<P,P+=8}if(E!==(4294967295&h.total)){C.msg="incorrect length check",h.mode=30;break}P=E=0}h.mode=29;case 29:R=1;break t;case 30:R=-3;break t;case 31:return-4;case 32:default:return c}return C.next_out=tt,C.avail_out=q,C.next_in=U,C.avail_in=j,h.hold=E,h.bits=P,(h.wsize||V!==C.avail_out&&h.mode<30&&(h.mode<27||D!==4))&&J(C,C.output,C.next_out,V-C.avail_out)?(h.mode=31,-4):(Q-=C.avail_in,V-=C.avail_out,C.total_in+=Q,C.total_out+=V,h.total+=V,h.wrap&&V&&(C.adler=h.check=h.flags?r(h.check,$,V,C.next_out-V):i(h.check,$,V,C.next_out-V)),C.data_type=h.bits+(h.last?64:0)+(h.mode===12?128:0)+(h.mode===20||h.mode===15?256:0),(Q==0&&V===0||D===4)&&R===y&&(R=-5),R)},s.inflateEnd=function(C){if(!C||!C.state)return c;var D=C.state;return D.window&&(D.window=null),C.state=null,y},s.inflateGetHeader=function(C,D){var h;return C&&C.state&&2&(h=C.state).wrap?((h.head=D).done=!1,y):c},s.inflateSetDictionary=function(C,D){var h,F=D.length;return C&&C.state?(h=C.state).wrap!==0&&h.mode!==11?c:h.mode===11&&i(1,D,F,0)!==h.check?-3:J(C,D,F,F)?(h.mode=31,-4):(h.havedict=1,y):c},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,l,s){var n=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];l.exports=function(v,g,y,c,m,d,b,p){var x,k,S,L,B,O,W,T,H,J=p.bits,C=0,D=0,h=0,F=0,$=0,U=0,tt=0,j=0,q=0,E=0,P=null,Q=0,V=new n.Buf16(16),K=new n.Buf16(16),ot=null,ht=0;for(C=0;C<=15;C++)V[C]=0;for(D=0;D<c;D++)V[g[y+D]]++;for($=J,F=15;1<=F&&V[F]===0;F--);if(F<$&&($=F),F===0)return m[d++]=20971520,m[d++]=20971520,p.bits=1,0;for(h=1;h<F&&V[h]===0;h++);for($<h&&($=h),C=j=1;C<=15;C++)if(j<<=1,(j-=V[C])<0)return-1;if(0<j&&(v===0||F!==1))return-1;for(K[1]=0,C=1;C<15;C++)K[C+1]=K[C]+V[C];for(D=0;D<c;D++)g[y+D]!==0&&(b[K[g[y+D]]++]=D);if(O=v===0?(P=ot=b,19):v===1?(P=i,Q-=257,ot=r,ht-=257,256):(P=u,ot=f,-1),C=h,B=d,tt=D=E=0,S=-1,L=(q=1<<(U=$))-1,v===1&&852<q||v===2&&592<q)return 1;for(;;){for(W=C-tt,H=b[D]<O?(T=0,b[D]):b[D]>O?(T=ot[ht+b[D]],P[Q+b[D]]):(T=96,0),x=1<<C-tt,h=k=1<<U;m[B+(E>>tt)+(k-=x)]=W<<24|T<<16|H|0,k!==0;);for(x=1<<C-1;E&x;)x>>=1;if(x!==0?(E&=x-1,E+=x):E=0,D++,--V[C]==0){if(C===F)break;C=g[y+b[D]]}if($<C&&(E&L)!==S){for(tt===0&&(tt=$),B+=h,j=1<<(U=C-tt);U+tt<F&&!((j-=V[U+tt])<=0);)U++,j<<=1;if(q+=1<<U,v===1&&852<q||v===2&&592<q)return 1;m[S=E&L]=$<<24|U<<16|B-d|0}}return E!==0&&(m[B+E]=C-tt<<24|64<<16|0),p.bits=$,0}},{"../utils/common":41}],51:[function(t,l,s){l.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,l,s){var n=t("../utils/common"),i=0,r=1;function u(_){for(var A=_.length;0<=--A;)_[A]=0}var f=0,v=29,g=256,y=g+1+v,c=30,m=19,d=2*y+1,b=15,p=16,x=7,k=256,S=16,L=17,B=18,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],W=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=new Array(2*(y+2));u(J);var C=new Array(2*c);u(C);var D=new Array(512);u(D);var h=new Array(256);u(h);var F=new Array(v);u(F);var $,U,tt,j=new Array(c);function q(_,A,N,M,I){this.static_tree=_,this.extra_bits=A,this.extra_base=N,this.elems=M,this.max_length=I,this.has_stree=_&&_.length}function E(_,A){this.dyn_tree=_,this.max_code=0,this.stat_desc=A}function P(_){return _<256?D[_]:D[256+(_>>>7)]}function Q(_,A){_.pending_buf[_.pending++]=255&A,_.pending_buf[_.pending++]=A>>>8&255}function V(_,A,N){_.bi_valid>p-N?(_.bi_buf|=A<<_.bi_valid&65535,Q(_,_.bi_buf),_.bi_buf=A>>p-_.bi_valid,_.bi_valid+=N-p):(_.bi_buf|=A<<_.bi_valid&65535,_.bi_valid+=N)}function K(_,A,N){V(_,N[2*A],N[2*A+1])}function ot(_,A){for(var N=0;N|=1&_,_>>>=1,N<<=1,0<--A;);return N>>>1}function ht(_,A,N){var M,I,Z=new Array(b+1),Y=0;for(M=1;M<=b;M++)Z[M]=Y=Y+N[M-1]<<1;for(I=0;I<=A;I++){var G=_[2*I+1];G!==0&&(_[2*I]=ot(Z[G]++,G))}}function et(_){var A;for(A=0;A<y;A++)_.dyn_ltree[2*A]=0;for(A=0;A<c;A++)_.dyn_dtree[2*A]=0;for(A=0;A<m;A++)_.bl_tree[2*A]=0;_.dyn_ltree[2*k]=1,_.opt_len=_.static_len=0,_.last_lit=_.matches=0}function rt(_){8<_.bi_valid?Q(_,_.bi_buf):0<_.bi_valid&&(_.pending_buf[_.pending++]=_.bi_buf),_.bi_buf=0,_.bi_valid=0}function ut(_,A,N,M){var I=2*A,Z=2*N;return _[I]<_[Z]||_[I]===_[Z]&&M[A]<=M[N]}function at(_,A,N){for(var M=_.heap[N],I=N<<1;I<=_.heap_len&&(I<_.heap_len&&ut(A,_.heap[I+1],_.heap[I],_.depth)&&I++,!ut(A,M,_.heap[I],_.depth));)_.heap[N]=_.heap[I],N=I,I<<=1;_.heap[N]=M}function ft(_,A,N){var M,I,Z,Y,G=0;if(_.last_lit!==0)for(;M=_.pending_buf[_.d_buf+2*G]<<8|_.pending_buf[_.d_buf+2*G+1],I=_.pending_buf[_.l_buf+G],G++,M===0?K(_,I,A):(K(_,(Z=h[I])+g+1,A),(Y=O[Z])!==0&&V(_,I-=F[Z],Y),K(_,Z=P(--M),N),(Y=W[Z])!==0&&V(_,M-=j[Z],Y)),G<_.last_lit;);K(_,k,A)}function dt(_,A){var N,M,I,Z=A.dyn_tree,Y=A.stat_desc.static_tree,G=A.stat_desc.has_stree,X=A.stat_desc.elems,it=-1;for(_.heap_len=0,_.heap_max=d,N=0;N<X;N++)Z[2*N]!==0?(_.heap[++_.heap_len]=it=N,_.depth[N]=0):Z[2*N+1]=0;for(;_.heap_len<2;)Z[2*(I=_.heap[++_.heap_len]=it<2?++it:0)]=1,_.depth[I]=0,_.opt_len--,G&&(_.static_len-=Y[2*I+1]);for(A.max_code=it,N=_.heap_len>>1;1<=N;N--)at(_,Z,N);for(I=X;N=_.heap[1],_.heap[1]=_.heap[_.heap_len--],at(_,Z,1),M=_.heap[1],_.heap[--_.heap_max]=N,_.heap[--_.heap_max]=M,Z[2*I]=Z[2*N]+Z[2*M],_.depth[I]=(_.depth[N]>=_.depth[M]?_.depth[N]:_.depth[M])+1,Z[2*N+1]=Z[2*M+1]=I,_.heap[1]=I++,at(_,Z,1),2<=_.heap_len;);_.heap[--_.heap_max]=_.heap[1],function(nt,ct){var xt,pt,kt,lt,Dt,ee,gt=ct.dyn_tree,me=ct.max_code,en=ct.stat_desc.static_tree,nn=ct.stat_desc.has_stree,rn=ct.stat_desc.extra_bits,ye=ct.stat_desc.extra_base,Ct=ct.stat_desc.max_length,Rt=0;for(lt=0;lt<=b;lt++)nt.bl_count[lt]=0;for(gt[2*nt.heap[nt.heap_max]+1]=0,xt=nt.heap_max+1;xt<d;xt++)Ct<(lt=gt[2*gt[2*(pt=nt.heap[xt])+1]+1]+1)&&(lt=Ct,Rt++),gt[2*pt+1]=lt,me<pt||(nt.bl_count[lt]++,Dt=0,ye<=pt&&(Dt=rn[pt-ye]),ee=gt[2*pt],nt.opt_len+=ee*(lt+Dt),nn&&(nt.static_len+=ee*(en[2*pt+1]+Dt)));if(Rt!==0){do{for(lt=Ct-1;nt.bl_count[lt]===0;)lt--;nt.bl_count[lt]--,nt.bl_count[lt+1]+=2,nt.bl_count[Ct]--,Rt-=2}while(0<Rt);for(lt=Ct;lt!==0;lt--)for(pt=nt.bl_count[lt];pt!==0;)me<(kt=nt.heap[--xt])||(gt[2*kt+1]!==lt&&(nt.opt_len+=(lt-gt[2*kt+1])*gt[2*kt],gt[2*kt+1]=lt),pt--)}}(_,A),ht(Z,it,_.bl_count)}function a(_,A,N){var M,I,Z=-1,Y=A[1],G=0,X=7,it=4;for(Y===0&&(X=138,it=3),A[2*(N+1)+1]=65535,M=0;M<=N;M++)I=Y,Y=A[2*(M+1)+1],++G<X&&I===Y||(G<it?_.bl_tree[2*I]+=G:I!==0?(I!==Z&&_.bl_tree[2*I]++,_.bl_tree[2*S]++):G<=10?_.bl_tree[2*L]++:_.bl_tree[2*B]++,Z=I,it=(G=0)===Y?(X=138,3):I===Y?(X=6,3):(X=7,4))}function R(_,A,N){var M,I,Z=-1,Y=A[1],G=0,X=7,it=4;for(Y===0&&(X=138,it=3),M=0;M<=N;M++)if(I=Y,Y=A[2*(M+1)+1],!(++G<X&&I===Y)){if(G<it)for(;K(_,I,_.bl_tree),--G!=0;);else I!==0?(I!==Z&&(K(_,I,_.bl_tree),G--),K(_,S,_.bl_tree),V(_,G-3,2)):G<=10?(K(_,L,_.bl_tree),V(_,G-3,3)):(K(_,B,_.bl_tree),V(_,G-11,7));Z=I,it=(G=0)===Y?(X=138,3):I===Y?(X=6,3):(X=7,4)}}u(j);var z=!1;function w(_,A,N,M){V(_,(f<<1)+(M?1:0),3),function(I,Z,Y,G){rt(I),G&&(Q(I,Y),Q(I,~Y)),n.arraySet(I.pending_buf,I.window,Z,Y,I.pending),I.pending+=Y}(_,A,N,!0)}s._tr_init=function(_){z||(function(){var A,N,M,I,Z,Y=new Array(b+1);for(I=M=0;I<v-1;I++)for(F[I]=M,A=0;A<1<<O[I];A++)h[M++]=I;for(h[M-1]=I,I=Z=0;I<16;I++)for(j[I]=Z,A=0;A<1<<W[I];A++)D[Z++]=I;for(Z>>=7;I<c;I++)for(j[I]=Z<<7,A=0;A<1<<W[I]-7;A++)D[256+Z++]=I;for(N=0;N<=b;N++)Y[N]=0;for(A=0;A<=143;)J[2*A+1]=8,A++,Y[8]++;for(;A<=255;)J[2*A+1]=9,A++,Y[9]++;for(;A<=279;)J[2*A+1]=7,A++,Y[7]++;for(;A<=287;)J[2*A+1]=8,A++,Y[8]++;for(ht(J,y+1,Y),A=0;A<c;A++)C[2*A+1]=5,C[2*A]=ot(A,5);$=new q(J,O,g+1,y,b),U=new q(C,W,0,c,b),tt=new q(new Array(0),T,0,m,x)}(),z=!0),_.l_desc=new E(_.dyn_ltree,$),_.d_desc=new E(_.dyn_dtree,U),_.bl_desc=new E(_.bl_tree,tt),_.bi_buf=0,_.bi_valid=0,et(_)},s._tr_stored_block=w,s._tr_flush_block=function(_,A,N,M){var I,Z,Y=0;0<_.level?(_.strm.data_type===2&&(_.strm.data_type=function(G){var X,it=4093624447;for(X=0;X<=31;X++,it>>>=1)if(1&it&&G.dyn_ltree[2*X]!==0)return i;if(G.dyn_ltree[18]!==0||G.dyn_ltree[20]!==0||G.dyn_ltree[26]!==0)return r;for(X=32;X<g;X++)if(G.dyn_ltree[2*X]!==0)return r;return i}(_)),dt(_,_.l_desc),dt(_,_.d_desc),Y=function(G){var X;for(a(G,G.dyn_ltree,G.l_desc.max_code),a(G,G.dyn_dtree,G.d_desc.max_code),dt(G,G.bl_desc),X=m-1;3<=X&&G.bl_tree[2*H[X]+1]===0;X--);return G.opt_len+=3*(X+1)+5+5+4,X}(_),I=_.opt_len+3+7>>>3,(Z=_.static_len+3+7>>>3)<=I&&(I=Z)):I=Z=N+5,N+4<=I&&A!==-1?w(_,A,N,M):_.strategy===4||Z===I?(V(_,2+(M?1:0),3),ft(_,J,C)):(V(_,4+(M?1:0),3),function(G,X,it,nt){var ct;for(V(G,X-257,5),V(G,it-1,5),V(G,nt-4,4),ct=0;ct<nt;ct++)V(G,G.bl_tree[2*H[ct]+1],3);R(G,G.dyn_ltree,X-1),R(G,G.dyn_dtree,it-1)}(_,_.l_desc.max_code+1,_.d_desc.max_code+1,Y+1),ft(_,_.dyn_ltree,_.dyn_dtree)),et(_),M&&rt(_)},s._tr_tally=function(_,A,N){return _.pending_buf[_.d_buf+2*_.last_lit]=A>>>8&255,_.pending_buf[_.d_buf+2*_.last_lit+1]=255&A,_.pending_buf[_.l_buf+_.last_lit]=255&N,_.last_lit++,A===0?_.dyn_ltree[2*N]++:(_.matches++,A--,_.dyn_ltree[2*(h[N]+g+1)]++,_.dyn_dtree[2*P(A)]++),_.last_lit===_.lit_bufsize-1},s._tr_align=function(_){V(_,2,3),K(_,k,J),function(A){A.bi_valid===16?(Q(A,A.bi_buf),A.bi_buf=0,A.bi_valid=0):8<=A.bi_valid&&(A.pending_buf[A.pending++]=255&A.bi_buf,A.bi_buf>>=8,A.bi_valid-=8)}(_)}},{"../utils/common":41}],53:[function(t,l,s){l.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,l,s){(function(n){(function(i,r){if(!i.setImmediate){var u,f,v,g,y=1,c={},m=!1,d=i.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(i);b=b&&b.setTimeout?b:i,u={}.toString.call(i.process)==="[object process]"?function(S){process.nextTick(function(){x(S)})}:function(){if(i.postMessage&&!i.importScripts){var S=!0,L=i.onmessage;return i.onmessage=function(){S=!1},i.postMessage("","*"),i.onmessage=L,S}}()?(g="setImmediate$"+Math.random()+"$",i.addEventListener?i.addEventListener("message",k,!1):i.attachEvent("onmessage",k),function(S){i.postMessage(g+S,"*")}):i.MessageChannel?((v=new MessageChannel).port1.onmessage=function(S){x(S.data)},function(S){v.port2.postMessage(S)}):d&&"onreadystatechange"in d.createElement("script")?(f=d.documentElement,function(S){var L=d.createElement("script");L.onreadystatechange=function(){x(S),L.onreadystatechange=null,f.removeChild(L),L=null},f.appendChild(L)}):function(S){setTimeout(x,0,S)},b.setImmediate=function(S){typeof S!="function"&&(S=new Function(""+S));for(var L=new Array(arguments.length-1),B=0;B<L.length;B++)L[B]=arguments[B+1];var O={callback:S,args:L};return c[y]=O,u(y),y++},b.clearImmediate=p}function p(S){delete c[S]}function x(S){if(m)setTimeout(x,0,S);else{var L=c[S];if(L){m=!0;try{(function(B){var O=B.callback,W=B.args;switch(W.length){case 0:O();break;case 1:O(W[0]);break;case 2:O(W[0],W[1]);break;case 3:O(W[0],W[1],W[2]);break;default:O.apply(r,W)}})(L)}finally{p(S),m=!1}}}}function k(S){S.source===i&&typeof S.data=="string"&&S.data.indexOf(g)===0&&x(+S.data.slice(g.length))}})(typeof self>"u"?n===void 0?this:n:self)}).call(this,typeof Ft<"u"?Ft:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})($e);var Fr=$e.exports,Br=qe,oe=te,Nr=Qe,Mr=Fr,tn=function(o,e){var t=new Mr,l=t.folder(e&&e.folder?e.folder:"layers");[oe.point(o),oe.line(o),oe.polygon(o)].forEach(function(n){n.geometries.length&&n.geometries[0].length&&Br(n.properties,n.type,n.geometries,function(i,r){var u=e&&e.types[n.type.toLowerCase()]?e.types[n.type.toLowerCase()]:n.type;l.file(u+".shp",r.shp.buffer,{binary:!0}),l.file(u+".shx",r.shx.buffer,{binary:!0}),l.file(u+".dbf",r.dbf.buffer,{binary:!0}),l.file(u+".prj",Nr)})});var s={type:"base64"};return t.generateAsync(s)},Ur=tn,Wr=async function(o,e){var t=await Ur(o,e);location.href="data:application/zip;base64,"+t};Qt.download=Wr;Qt.write=qe;Qt.zip=tn;const jr={layers:[],mapStyle:Lt.getters.mapStyle,controller:!0,screenshotFilename:"",useDevicePixels:!1,getCursor:({isDragging:o,isHovering:e})=>o?"grabbing":e?"pointer":""},De={position:"absolute",left:0,top:0,width:"100%",height:"100%"};Lt.state.colorScheme,ln.DarkMode;function Zr(o){let{container:e=document.body}=o;if(typeof e=="string"&&(e=document.querySelector(e)),!e)throw new Error("[DeckMap] container not found");window.getComputedStyle(e).position==="static"&&(e.style.position="relative");const l=document.createElement("div");e.appendChild(l),Object.assign(l.style,De);const s=document.createElement("canvas");return s.width=window.innerWidth,s.height=window.innerHeight,s.oncontextmenu=()=>!1,e.appendChild(s),Object.assign(s.style,De),{container:e,mapboxCanvas:l,deckCanvas:s}}class Gr extends vn{constructor(e={}){e={...jr,onResize:()=>{this._map&&this._map.resize()},onAfterRender:()=>{this.props.screenshotFilename&&(this.savePNGcallback(),this.props.screenshotFilename="")},...e};const{mapboxCanvas:t,deckCanvas:l}=Zr(e),s=e.viewState,n=e.basemap;super({canvas:l,...e}),n?this._map=n:this._map=new un.Map({container:t,style:e.mapStyle,interactive:!1,center:[s.longitude,s.latitude],zoom:s.zoom,bearing:s.bearing||0,pitch:s.pitch||0}),this._onBeforeRender=i=>{if(this.onBeforeRender(i),this._map){const r=this.getViewports()[0];this._map.jumpTo({center:[r.longitude,r.latitude],zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),this.redrawMapbox()}}}redrawMapbox(){const e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}setMapStyle(e){this._map&&this._map.setStyle(e)}getMapboxMap(){return this._map}finalize(){this._map&&this._map.remove(),this._map=null,super.finalize()}setProps(e){"onBeforeRender"in e&&this._onBeforeRender&&e.onBeforeRender!==this._onBeforeRender&&(this.onBeforeRender=e.onBeforeRender,e.onBeforeRender=this._onBeforeRender),super.setProps(e)}takeScreenshot(){this.props.useDevicePixels=!0,this.props.screenshotFilename="screenshot1.png",this.redraw()}savePNGcallback(){const e=this._map._canvas.toDataURL("image/png"),t=this.canvas.toDataURL("image/png"),l=this.mergeImageURIs({width:this.canvas.width,height:this.canvas.height,imageDataURLs:[e,t]});this.props.useDevicePixels=!1,l.then(s=>{var n=document.createElement("a");n.setAttribute("href",s),n.setAttribute("download","screenshot.png"),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)})}mergeImageURIs(e){return new Promise((t,l)=>{var s=document.createElement("canvas");s.width=e.width,s.height=e.height,Promise.all(e.imageDataURLs.map(n=>this.add2canvas(s,n))).then(()=>{const n=s.getContext("2d"),i=s.width-152,r=s.height-8;n.beginPath(),n.rect(i-4,r-14,158,22),n.fillStyle="#ffffff44",n.fill(),n.font="11px Arial",n.fillStyle="#888",n.fillText(" Mapbox   OpenStreetMap",i,r),t(s.toDataURL("image/png"))})})}add2canvas(e,t){return new Promise((l,s)=>{e||s(),t||s();var n=new Image;n.onload=function(){e.getContext("2d").drawImage(this,0,0),l(!0)},n.src=t})}}class Hr{constructor(){ne(this,"layers");ne(this,"deckInstance");this.layers={},this.deckInstance=null}init(e){if(this.deckInstance=new Gr({...e,map:hn}),e.mapStyle!==null){const t=Lt.getters.mapStyle;this.deckInstance.setMapStyle(t)}}destroy(){this.deckInstance&&(this.deckInstance.finalize(),delete this.deckInstance)}hasLayer(e){return!!this.layers[e]}getLayers(){return this.layers}isVisible(e){return this.layers[e]&&this.layers[e].props.visible!==!1}updateDeckInstance(){if(!this.deckInstance)return;const e=[...Object.values(this.layers)];this.deckInstance.setProps({layers:e})}updateStyle(){if(!this.deckInstance)return;const e=Lt.getters.mapStyle;this.deckInstance.setMapStyle(e)}addLayer(e){if(!e.id)throw new Error(`[layerManager.addLayer] layer id must defined. Received "${e.id}" instead`);this.layers[e.id]=e,this.updateDeckInstance()}updateLayer(e,t){if(!this.layers[e])return;const l=this.layers[e];this.layers[e]=l.clone(t),this.updateDeckInstance()}removeLayer(e){this.hasLayer(e)&&(delete this.layers[e],this.updateDeckInstance())}hideLayer(e){this.hasLayer(e)&&this.updateLayer(e,{visible:!1})}showLayer(e){this.hasLayer(e)&&this.updateLayer(e,{visible:!0})}takeScreenshot(){this.deckInstance.takeScreenshot()}}const Kr={messages:{en:{title:"Draw Shapes",hint:"Click on map to draw shapes.",clear:"Clear",shapefile:"Export","close-shape":"Add more points to close shape.","more-shapes":"Export now or start new shape."},de:{}}},Vr=cn({name:"DrawingTool",i18n:Kr,data:()=>{const o=[];return{canExport:!1,hint:"",isDark:Lt.state.isDarkMode,points:o,showShapeDrawer:!1,layerManager:new Hr,mapID:`map-id-${Math.floor(1e12*Math.random())}`,polygons:[{type:"Feature",geometry:{type:"Polygon",coordinates:[o]},finished:!1}]}},mounted(){console.log("DRATWOOL"),this.hint=this.$t("hint"),this.setupLayerManager(),this.updateLayers()},beforeDestroy(){this.showShapeDrawer=!1,this.layerManager.destroy()},watch:{viewState(){this.layerManager.deckInstance.setProps({viewState:this.viewState})},"globalStore.state.isDarkMode"(){this.isDark=this.$store.state.isDarkMode,this.layerManager.updateStyle()}},computed:{viewState(){return this.$store.state.viewState}},methods:{toggleShapeDrawer(){this.clearShapes(),this.updateLayers(),this.showShapeDrawer=!this.showShapeDrawer},clearShapes(){this.canExport=!1,this.points=[],this.polygons=[{type:"Feature",geometry:{type:"Polygon",coordinates:[this.points]},finished:!1}]},setupLayerManager(){this.layerManager.init({container:`#${this.mapID}`,viewState:this.$store.state.viewState,pickingRadius:3,mapStyle:null,getCursor:({isDragging:o,isHovering:e})=>o?"grabbing":e?"pointer":"crosshair",onViewStateChange:({viewState:o})=>{this.$store.commit("setMapCamera",o)},onClick:this.handleMapClick})},exportIt(){this.polygons=this.polygons.filter(e=>e.finished),this.points=[],this.updateLayers();const o={type:"FeatureCollection",features:this.polygons};Qt.download(o,{folder:"shapefile-wgs84",types:{point:"points",polygon:"polygons",line:"lines"}}),this.startNewPolygon()},cancel(){this.hint=this.$t("hint"),this.clearShapes(),this.updateLayers(),this.showShapeDrawer=!1},handleMapClick(o,e){o.coordinate&&(e.rightButton?this.points.pop():(this.points.push(o.coordinate),this.hint=this.$t("close-shape")),this.updateLayers())},startNewPolygon(){this.points=[],this.polygons.push({type:"Feature",geometry:{type:"Polygon",coordinates:[this.points]},finished:!1})},handlePointClick(o){return o.index===0&&(this.points.push(this.points[0]),this.polygons[this.polygons.length-1].finished=!0,this.startNewPolygon(),this.canExport=!0,this.hint=this.$t("more-shapes"),this.updateLayers()),!0},handleViewState(o){this.$store.commit("setMapCamera",o)},updateLayers(){const o=this.polygons.slice(0),e=this.points.slice(0);this.layerManager.removeLayer("draw-polygon-layer"),this.layerManager.addLayer(new fe({id:"draw-polygon-layer",data:o,pickable:!1,stroked:!0,filled:!0,extruded:!1,lineWidthMinPixels:4,getFillColor:[175,160,255,80],getLineColor:[255,0,200],getLineWidth:10,parameters:{depthTest:!1}})),this.layerManager.removeLayer("draw-scatterplot-layer"),this.layerManager.addLayer(new Fe({id:"draw-scatterplot-layer",data:e,getPosition:t=>t,pickable:!0,stroked:!0,filled:!0,radiusMinPixels:6,radiusMaxPixels:6,lineWidthMinPixels:2,getFillColor:[255,0,200],getLineColor:[255,255,255],opacity:1,onClick:this.handlePointClick}))}}}),Re="/assets/draw-icon-dm-04d4af86.png",Yr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHQAAACACAYAAADamU0oAAAACXBIWXMAAAUjAAAFIwGBB/sRAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAD4ZJREFUeJztnX10HNV5xp/37qykgOzjgtP4IyanxJHsxDYklG/sGAKmAVx/4EF7Z2UjwIg6TVrOaUtPQtKz/YhDykkD+SipkhCBunN3GTA2JnUdIBgKIUBTDNZxLQFNDMQmQEOQbSxpd+btH1r52GZ3Je3Ovaul8/sP3bvv85pnZ3bm3vfeS3gfYNt2LB6PL2HmFQDOYOYZRDQbwDCAfUS0j5kfD4JgSzabfb7G6WqFap1ANXR0dDQNDg5+nohuAvDBcX5sDzN/JZPJ3AeANaZXE+rWUMdxLgNwBzOfUmGIpwF0KKX2hJhWzRG1TqASHMf5c2Z+oAozAeBsAM9IKZeHlddkoO4MdRznVma+DUAshHBTANyfSCTWhBBrUlBXt1wp5dUAujWEPhwEwaez2eyzGmIbpW4MlVIuAvAsgAYd8YnolVgs9vGenp5DOuKbop5uuV+HJjMBgJlPyefzN+qKb4q6uEITicRSInrUgNQAgI8qpd4yoKWFurhCiWi9IampAK4ypKWFigzt7OyMSymnL1261Ao7oWJaAC7TrTMKEa0wpaWDcd1yHcc5PQiCFUR0GYCPAPhQoSkA8AaAl4joQWbeEvaLuuM4S5j5sTBjjsGwZVkn1evDUdkrLJFInAfgH5n5fKKi3gsAMwDMYOYLANwipXwKwE1KqSdCyvHUkOKMl4ZcLtcC4DnDuqFQ1FDbtk+yLKsbQCWjKOcCeFxK2XPw4MENW7dufbfS5GzbPiUIgitLfJl0MgvvF0Mdx/kYMz8AYF4VcQnAuubm5tMcx1nhuu7e8X6wra1tvhBiNRGtZuZPVZFDxQghTqiFbhgcY2hbW1sLMz8F4KSQ4p/GzP9h2/ZZnue9XqqT4zhnBEGwmohWo/BFYq7dREgQBBXfVWrNEUOTyeTUIAg2ITwzR5ljWdaDtm0v9jzvMACkUimxZ8+e84UQq5h5NTN/pAa31ZIQ0au1zqFSjhjKzF0APqFJ5wzLsjZKKe8jIruvr28NEc2q5VVYhsF8Pv9irZOoFAKAtra2M4UQT6NORo40s1Up9ce1TqJSBADEYrGvITITAEBEW2qdQzUI27ZnM/NFtU6kBLuJ6G8BtMFQuYjv+wtM6OjCisfjq5h5slydPjP/XAjh5XK5ez3P+/Vog5TSBqB9IloIcaOUsqG1tfULqVQq0K0XNhYzL6txDoPM/DARbYrH4w/cfffd/1usExF9iZk/C+BEAzl9rr+/f1pnZ2dHV1dXzoBeaJCUcieA0wzrHmbmR4QQHhFtTqfTA+P5UCKRWEVE98LQLBERPZLL5VZ6nnfQhF4YkJTyTQDTDWr+xrKsj1Y6+C2l/CKAjSHnVI5n4vH4ZaXuHJMNgZFCKZP41cxkKKW+xsxJAIMh5PIWEY1VR3RWLpf7qW3bM0LQ047AyPSXSaq+fWUyGRfARQB2VRHmx0KIT+ZyuQsA3DNG30WxWOxn7e3tc6vQM4IAsN+w5ithBFFKPdXa2no6EV0DYLwjOwzgCWa+UCl1RTqdfs3zvOF8Pu8URspKQkR/4Pv+48lkcmHVyWuEpJR3AVhnUPNWpdRNYQdNJpMLfd9fIYQ4j5lPBTANgA/gt8zcT0SPCCEeSKfTr5UIQVLKrwL44hhSbwO4XCn1VIjphwYlEok1ROSZEhRCXJBOp580pTdRpJRfAHAbyjxJE9G7vu+vyWaz28xlNj6E7/v/jnAeMMbDG8PDwz83pFURSqlvA7gaQL5UH2Y+QQix2XGchLnMxofwPO8gM//IhBgRfcfzPN+EVjUopf4VwGoAh8t0a2BmV0o5qWp5BQDE4/EUgAOatd5oamq6TbNGaCiltgL4LEZqdUtBAL6ZSCRuMZPV2MQA4IUXXji0cOFCH8AluoSYeUNPT09drR3p7e3du2jRoocArEKZIUciumDBggXT16xZs33Hjh01neQ9elCepJRpAFKDzu1KqUl1a5oIUsp5RLR9HMsX01OmTLmmluO/Rz/J8cGDB9czc9hPoFv379//lyHHNIpSak8QBOdi7IGM5MDAwCbbtj9gIq9iHLPGsr+/Pzdnzpx0Y2Pjh4no9GqDM3PX66+/fvWOHTtKPjHWC729vQfmz5+fJaJPE9GHS/UjohYhxOL58+ffv3v37iGTOQJlqhQcx+lk5r8H8PsVxN1LRH/luq6x91tTrF279kTf9zeNY9qxl5kvzWQy+4wkVqDsxPa11147ZXBw8C+Y+ToAJb+VR/EygDsaGxu/293dberd1ji2bTdYlpXG2BPu/xMEwbJsNvuyibyA8dcRUSKROIOIfoziV+zLQohV6XS6msHyusK27ZhlWXcAuH6MrvuFEJea+n8zodITKeUuAMVqbn6qlPpMOCnVFSSlvAXAWGPTxsZ/tS8HfJ/DSqm/dhxnHzN/E6UvkN8D8JDjOFe6rru9WIfCEpC5RDSTmU8ioneCIPg1Ef1KKbUL4yySi67QkHAcZx0z/xDlL5JhAGuVUvcAR0xcD2Alyq+ye5WZtwC4M5PJlF1EFRkaIo7jrGDmDICmMt18AF8CMBfANZjYXTIgokwsFvtyT0/PL4t1qIsl+fWC67pbCouiy42LxzCyAcj1mPhPnmBmJ5/P73IcZ3XRDhMMGDEGrus+Wihc17nxxonMfG+hYO4YIkM1kMlk/jMIgiUAdK5iIwAbpZQ3HP3HyFBNZLPZ/yaixQD6NUt9K5FILB79j8hQjRRWri8BoHMDjgYi+kFht5jIUN0w81LoX77RMjAwcB0QGaodIrrZkM6XU6mUiAzVSKEw21Qd7+y+vr6zI0M14vt+0XdFXTDzishQvZxpUoyIFkeGaoSZZxqWnBsZqhEiMm3otMhQvZgu6QwiQ/VitJ4IwNuRoRohItOGvhgZqpEgCH5mUo+IHo0M1Yjv+5th8Hc0CIItkaEa8TzvFYwcTWKClzOZzM7IUM0UdkIzQQoAR4ZqxnXdfyOiRzTLPN/a2uoC0WyLKTYA+K2m2IeIqGN0G7vIUAO4rvsiEbWhzDL/CmFmvs513Z2jf4gMNYTrug8TkUNEYW1/nmPmGzKZTPboP0aGGqSwGm8JgFJb64yXN4no4kwm8/3jGyJDDeO67i8OHTr0cSKqpMwzx8xdlmUtcF338WIdorUtNaC5uflsZh73hplE9F8ANgdB0JPJZH5Vrm9kaA1g5j8p09YjhHgCwLDv+/uIqFcpNe4x4chQwxR29Sx6SAERvdvY2Phn3d3dv6s0fvQbaph4PH49gHixNmZOV2MmEBlqlFQqJQrbGxSFiP6lWo3olmuQvr6+yzFyXOd7YOZnlVK/qFYjukLNckOpBiFE1VcnEBlqDNu2TwHwRyWa34nFYpkwdCJDDRGLxW7AcRt9jUJEd4V1onBkqAE6OzvjRNRRqt33/fcM4VVKZKgBDhw4sAojpwYX4/FsNtsbllZkqBlKPgwxcygPQ6NEhmqmsALtwhLNbzU1NW0KUy8yVDO+729A6e2D7gx7T8TIUI0U9s29ukQzE9EPwtaMDNWIZVlXATi5RPNPXNcN/WjoyFC9GHsYGiUyVBNSykUAzi3RvH/q1KkP6tCNDNVEuUlsIurSddBAZKgGbNtuJqJkiWYfgLaDj6LpMw1YlpUEMLVYGzM/qJTaq0s7ukI1QESdZdq+p1M7MjRkksnkOcz8qWJtzPzL1tbWn+jUjwwNGd/3S76qEFHX6BoUXUSGhkhHR8c0IcRVJZqHofFhaJTooShEhoaGOgCcUKJ5k1LqN7pziK7QcFlfpk3rw9AokaEhkUgklgL4RInmPUqpomtRwiYyNCSEEOVGhr4HQ5tnTMhQIio6r8fMU2zbbggnpfrDtu0PMvPKEs2Hc7lcj6lcxjy3ZenSpdbMmTNtAFdi5KTbUl+CASLaFgTBvfPmzduk+/HcJFLKDwFYDuAijBzqNwNAMxHtD4JgHxE1A1ha4uM/UkpdaybTMQx1HOdiZv4nTHwT391ElKr34yYdxzmLmf8BwGdQ4c8TM5+TyWSeDjez0hQ1tKOjo2loaOj7ANqrjJ9ubGxcX29HT0oppwP4Z4wcJzmh06eO43mlVNUH606E93zr2tvbZw4NDT2B6s0EgOTQ0NBD69atKzVrP+loa2trAfAkABvVmQkierXaGBPlmEruQg3MdiL6wxA1TvF9//w5c+akX3rpJT/EuKHT1tZ2phDiSZSuoZ0oLQsWLDi5t7d3W0jxxuToK5Qsy7qLiELfVpuIzp82bdp3wo4bJu3t7TOFEJsATAkzLhF9Xkr5uTBjluOIoVJKGyO3GV2sl1JeojF+xaRSKZHP5zdhfMdSV8LtiUTibE2xj0EAI68mAEzsSXdrKpWadIMZ/f39kojO0ShhEdHtMPB7KgBg1qxZDoB5usUAnNbX11d0f4FaYdt2AzP/nQGpsx3H0f5vFwDAzGOd9h4mVxrUGpOGhoZlKH+6bmiUKxwLC7F8+fITiMjk6bxXTKZhwiAIVhiUuzCZTBatNQoLMXXq1E8yc6k5PB1ME0IUO/a5VlxuUKvR9/1lOgUs3/dnlhhz14YQ4lLHccyKFiGfzzcBMH22yiIA9+oKbgkhZjObPl4EG5l5o2nR44nFiq6Q1woRzdYZXwRBYNzN/88QkdazRIUQYr9OgYhjYeaw9sstimDmyFCzaD2cR1iW9RyAupreqmeYeZfO+KKnp+cQMz+sUyTiCDkhhNbKeQsAhBD3MfMVOoVGKRRMPWdCa5yczswbDGk95rru2zoFLABobm5ODwwM3ExEc3WKAXihpaXlTydTvVGhOmM59M20HIGIfqhbQwBAV1dXTgjxFd1iRHTTZDITALq7uweJKGVAamdLS8s9ukWOTGW5rpsFcL8uIWbudl13u6741ZDL5boB7ByrXxUEAG408WU+em6S8/l8EkDVe7YW4al33nlH+0xDpXie5zPzKgBvapK4WSn1mKbYx3DMZLPneYeFECsBPB+ixtOWZa3ctm3bUIgxQ6dw2oKNkF/hiKhHKfX1MGOW4z3VA+l0+jXLss5n5jC2LMvk8/kLe3p63gghlnaUUo8x83kAXg0jHhF9q6WlpQMGzxAtO+MhpVwO4BsAPjbBuHuI6G/qtdDatu3Z8Xj8TmaudKrrdWa+8fhjrEww5hRWZ2dn/MCBAw5GKg0uBvCBEl0PMfN2APf5vp/1PG9Sl2yOBynlJcz81QlUQv6OmW/zff8bnucd1JpcCSY0J7l27doTc7ncmQBOJaLpGLmVvEVEL+dyuWc9zzusJcsa097ePjefz68komUA5hHRyczcCOBtAHuZ+Rlm3hwEwQ7P84Zrmev/Aal8fmNSBxWtAAAAAElFTkSuQmCC";var Xr=function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"draw-thing"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showShapeDrawer,expression:"showShapeDrawer"}],staticClass:"map",attrs:{id:e.mapID},on:{click:e.handleMapClick}}),t("div",{staticClass:"map-actions"},[e.isDark&&e.showShapeDrawer?t("button",{staticClass:"button draw-button is-tiny",class:{"is-drawing":e.showShapeDrawer},style:{border:"1px solid rgb(119,119,119)"},attrs:{title:"Draw"},on:{click:e.toggleShapeDrawer}},[t("img",{attrs:{src:Re,width:"16"}})]):e.isDark&&!e.showShapeDrawer?t("button",{staticClass:"button draw-button is-tiny",class:{"is-drawing":e.showShapeDrawer},style:{background:"rgb(43,60,78)",border:"1px solid rgb(119,119,119)"},attrs:{title:"Draw"},on:{click:e.toggleShapeDrawer}},[t("img",{attrs:{src:Re,width:"16"}})]):t("button",{staticClass:"button draw-button is-tiny",class:{"is-drawing":e.showShapeDrawer},style:{border:"1px solid rgb(224,224,224)"},attrs:{title:"Draw"},on:{click:e.toggleShapeDrawer}},[t("img",{attrs:{src:Yr,width:"16"}})])]),e.showShapeDrawer?t("div",{staticClass:"control-panel"},[t("h3",[e._v(e._s(e.$t("title")))]),t("p",[e._v(e._s(e.hint))]),t("div",{staticClass:"buttons"},[t("button",{staticClass:"button is-small export-button",style:{"is-outlined":!e.canExport},attrs:{disabled:!e.canExport},on:{click:e.exportIt}},[e._v(e._s(e.$t("shapefile")))]),t("button",{staticClass:"button is-small is-outlined",on:{click:e.cancel}},[e._v(e._s(e.$t("clear")))])])]):e._e()])},Qr=[];var Jr=dn(Vr,Xr,Qr,!1,null,"ef05087b",null,null);const ii=Jr.exports;export{ii as D,fe as G,We as W,zn as g,je as m,ri as p};
//# sourceMappingURL=DrawingTool-1c8c329c.js.map
