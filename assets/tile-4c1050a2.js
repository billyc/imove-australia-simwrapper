import{d as n,F as l,g as r,S as o,n as c}from"./index-2c5e1d98.js";import{r as d}from"./index-9e6f44a3.js";import{P as m}from"./papaparse.min-2428ac40.js";import{H as u}from"./HTTPFileSystem-f986ffa8.js";import{a as g}from"./util-ddcf947a.js";import"./fxp-26b9b10f.js";const f=n({name:"Tile",components:{FontAwesomeIcon:l},props:{fileSystemConfig:{type:Object,required:!0},subfolder:{type:String,required:!0},files:{type:Array,required:!0},config:{type:Object,required:!0},cardTitle:{type:String,required:!1},cardId:String,datamanager:{type:Object,required:!0}},data:()=>({globalState:r.state,id:"tiles-"+Math.floor(1e12*Math.random()),dataSet:{},YAMLrequirementsOverview:{dataset:""},colors:["#F08080","#FFB6C1","#FFDAB9","#FFECB3","#B0E0E6","#98FB98","#FFD700","#FFA07A","#E0FFFF","#FFDAB9","#FFC0CB","#FFA500","#FF8C00","#FF7F50","#FFE4B5","#ADD8E6","#90EE90","#FFD700","#FFC0CB","#FFA500"],colorsD3:["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],localTileIcons:["departure_board","directions_car","emoji_transportation","local_taxi","subway","directions_bike","directions_subway","ev_station","local_gas_station","motorcycle","train","directions_boat","electric_car","group","local_parking","person","transportation","directions_bus","electric_rickshaw","groups","local_shipping","route","two_wheeler"],testImage:"",base64Images:[],imagesAreLoaded:!1,tileNameIndex:0,tileValueIndex:1,tileImageIndex:2,urlIndex:3}),computed:{fileApi(){return new u(this.fileSystemConfig,r)}},async mounted(){this.dataSet=await this.loadFile(),this.validateDataSet(),await this.loadImages(),this.$emit("isLoaded"),console.log(this.dataSet),console.log(r)},methods:{forceRerender(){this.imagesAreLoaded=!1,this.$nextTick(()=>{this.imagesAreLoaded=!0})},async loadImages(){this.imagesAreLoaded=!1;for(let t=0;t<this.dataSet.data.length;t++){const e=this.dataSet.data[t];if(this.checkIfItIsACustomIcon(e[this.tileImageIndex]))try{const s=await this.fileApi.getFileBlob(this.subfolder+"/"+this.config.dataset+"/../"+e[this.tileImageIndex].trim()),i=await d.arraybuffer(s),a=g(i);a&&(this.base64Images[t]=`center / cover no-repeat url(data:image/png;base64,${a})`)}catch(s){s instanceof Response&&this.$emit("error",{type:o.WARNING,msg:s.statusText,desc:`The file ${e[this.tileImageIndex]} was not found in this path ${this.subfolder+"/"+this.config.dataset+"/../"+e[this.tileImageIndex]}.`})}this.forceRerender()}this.imagesAreLoaded=!0},async loadFile(){const t=await this.fileApi.getFileText(this.subfolder+"/"+this.config.dataset);return m.parse(t,{comments:"#",delimitersToGuess:[";","	",","," "],dynamicTyping:!0,header:!1,skipEmptyLines:!0})},validateYAML(){for(const t in this.YAMLrequirementsOverview)t in this.config||this.$emit("error",{type:o.ERROR,msg:`YAML file missing required key: ${t}`,desc:"Check this.YAMLrequirementsXY for required keys"})},validateDataSet(){},checkIfIconIsInAssetsFolder(t){return this.localTileIcons.includes(t.trim())},checkIfItIsACustomIcon(t){if(t!=null)return!!(t.includes(".png")||t.includes(".jpg")||t.includes(".svg")||t.includes(".jpeg"))}}});var I=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"content"},[e.imagesAreLoaded?s("div",{staticClass:"tiles-container"},e._l(this.dataSet.data,function(i,a){return s("div",{staticClass:"tile",style:{"background-color":e.colors[a%e.colors.length]},on:{click:function(p){}}},[s("a",{class:{"is-not-clickable":!i[e.urlIndex]},attrs:{href:i[e.urlIndex],target:"_blank"}},[s("p",{staticClass:"tile-title"},[e._v(e._s(i[e.tileNameIndex]))]),s("p",{staticClass:"tile-value"},[e._v(e._s(i[e.tileValueIndex]))]),i[e.tileImageIndex]!=null&&e.checkIfItIsACustomIcon(i[e.tileImageIndex])?s("div",{staticClass:"tile-image",style:{background:e.base64Images[a],"background-size":"contain"}}):i[e.tileImageIndex]!=null&&e.checkIfIconIsInAssetsFolder(i[e.tileImageIndex])?s("img",{staticClass:"tile-image",style:{background:""},attrs:{src:"/src/assets/tile-icons/"+i[e.tileImageIndex].trim()+".svg"}}):i[e.tileImageIndex]!=null?s("font-awesome-icon",{staticClass:"tile-image",style:{background:"",color:"black"},attrs:{icon:i[e.tileImageIndex].trim(),size:"2xl"}}):e._e()],1)])}),0):e._e()])},h=[];var F=c(f,I,h,!1,null,"0b4b0004",null,null);const k=F.exports;export{k as default};
//# sourceMappingURL=tile-4c1050a2.js.map
