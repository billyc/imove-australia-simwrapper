import{d as r,g as l,n as a}from"./index-0a2cd937.js";const n=r({name:"VideoPlayerPlugin",props:{root:{type:String,required:!0},subfolder:{type:String,required:!0},yamlConfig:String,config:Object,thumbnail:Boolean},data:()=>({movieSource:"",title:"",myState:{},fileApi:null,playerOptions:{muted:!1,language:"en",playbackRates:[.5,1,1.5,2,5],preload:"metadata",responsive:!0,fluid:!1,playsInline:!0,controls:!0,sources:[]}}),beforeDestroy(){this.thumbnail||l.commit("setFullScreen",!1)},mounted(){this.fileApi=this.getFileSystem(this.root),this.myState={subfolder:this.subfolder,yamlConfig:this.yamlConfig,thumbnail:this.thumbnail,imageData:""},this.playerOptions.fluid=!!this.thumbnail,this.thumbnail||l.commit("setFullScreen",!0),this.yamlConfig?(this.myState.subfolder=this.subfolder,this.myState.yamlConfig=this.yamlConfig,this.buildMovieSource()):this.buildRouteFromUrl(),this.getVizDetails()},watch:{yamlConfig(){this.myState.yamlConfig=this.yamlConfig,this.getVizDetails()},subfolder(){this.myState.subfolder=this.subfolder,this.getVizDetails()}},methods:{buildMovieSource(){var e;this.movieSource=`${(e=this.fileApi)==null?void 0:e.baseURL}/${this.myState.subfolder}/${this.myState.yamlConfig}`,this.playerOptions.sources.push({type:"video/mp4",src:this.movieSource})},getFileSystem(e){const t=this.$store.state.svnProjects.filter(s=>s.slug===e);if(t.length===0)throw console.log("no such project"),Error;return t[0]},async buildRouteFromUrl(){const e=this.$route.params;if(!e.project||!e.pathMatch){console.log("I CANT EVEN: NO PROJECT/PARHMATCH");return}this.fileApi=this.getFileSystem(e.project);const t=1+e.pathMatch.lastIndexOf("/"),s=e.pathMatch.substring(0,t),i=e.pathMatch.substring(t);this.myState.subfolder=s,this.myState.yamlConfig=i,this.buildMovieSource()},async generateBreadcrumbs(){const e=this.getFileSystem(this.$route.params.project);if(!e)return[];const t=[{label:e.name,url:"/"+e.slug}],s=this.myState.subfolder.split("/");let i="/";for(const o of s)o&&(i+=o+"/",t.push({label:o,url:"/"+e.slug+i}));return l.commit("setBreadCrumbs",t),t},async getVizDetails(){this.title=this.myState.yamlConfig.replace(/_/g," "),this.title=this.title.substring(0,this.title.lastIndexOf(".")),this.title&&this.$emit("title",this.title)}}});var u=function(){var t=this,s=t._self._c;return t._self._setupProxy,s("div",{staticClass:"video-plugin-container",class:{thumbnail:t.thumbnail}},[t.thumbnail?t._e():s("h3",[t._v(t._s(t.title))]),s("div",{staticClass:"vid-container"},[s("video",{attrs:{controls:t.controls,loop:t.loop,allowfullscreen:t.allowfullscreen,autoplay:t.autoplay},domProps:{muted:t.muted}},[t._l(t.sources,function(i,o){return s("source",{key:o,attrs:{src:i,type:o}})}),t._l(t.sources,function(i,o){return s("p",{key:o},[t._v("Video tag not supported. Download the videoÂ "),s("a",{attrs:{href:i,target:"_blank"}},[t._v("here")])])})],2)])])},h=[];var m=a(n,u,h,!1,null,"0ea1fa22",null,null);const f=m.exports;export{f as default};
//# sourceMappingURL=VideoPlayer-5c8303cb.js.map
